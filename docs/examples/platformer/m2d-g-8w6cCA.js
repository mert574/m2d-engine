(function(){const S=document.createElement("link").relList;if(S&&S.supports&&S.supports("modulepreload"))return;for(const A of document.querySelectorAll('link[rel="modulepreload"]'))M(A);new MutationObserver(A=>{for(const t of A)if(t.type==="childList")for(const f of t.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&M(f)}).observe(document,{childList:!0,subtree:!0});function d(A){const t={};return A.integrity&&(t.integrity=A.integrity),A.referrerPolicy&&(t.referrerPolicy=A.referrerPolicy),A.crossOrigin==="use-credentials"?t.credentials="include":A.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function M(A){if(A.ep)return;A.ep=!0;const t=d(A);fetch(A.href,t)}})();var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ne(L){return L&&L.__esModule&&Object.prototype.hasOwnProperty.call(L,"default")?L.default:L}function X(L){throw new Error('Could not dynamically require "'+L+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var j={exports:{}};(function(L,S){(function(d){L.exports=d()})(function(){return function(){function d(M,A,t){function f(v,r){if(!A[v]){if(!M[v]){var a=typeof X=="function"&&X;if(!r&&a)return a(v,!0);if(o)return o(v,!0);var s=new Error("Cannot find module '"+v+"'");throw s.code="MODULE_NOT_FOUND",s}var e=A[v]={exports:{}};M[v][0].call(e.exports,function(n){var c=M[v][1][n];return f(c||n)},e,e.exports,d,M,A,t)}return A[v].exports}for(var o=typeof X=="function"&&X,i=0;i<t.length;i++)f(t[i]);return f}return d}()({1:[function(d,M,A){var t={};M.exports=t;var f=d("../geometry/Vertices"),o=d("../geometry/Vector"),i=d("../core/Sleeping");d("../render/Render");var v=d("../core/Common"),r=d("../geometry/Bounds"),a=d("../geometry/Axes");(function(){t._inertiaScale=4,t._nextCollidingGroupId=1,t._nextNonCollidingGroupId=-1,t._nextCategory=1,t.create=function(e){var n={id:v.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:f.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},c=v.extend(n,e);return s(c,e),c},t.nextGroup=function(e){return e?t._nextNonCollidingGroupId--:t._nextCollidingGroupId++},t.nextCategory=function(){return t._nextCategory=t._nextCategory<<1,t._nextCategory};var s=function(e,n){n=n||{},t.set(e,{bounds:e.bounds||r.create(e.vertices),positionPrev:e.positionPrev||o.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),f.rotate(e.vertices,e.angle,e.position),a.rotate(e.axes,e.angle),r.update(e.bounds,e.vertices,e.velocity),t.set(e,{axes:n.axes||e.axes,area:n.area||e.area,mass:n.mass||e.mass,inertia:n.inertia||e.inertia});var c=e.isStatic?"#2e2b44":v.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]),l="#000";e.render.fillStyle=e.render.fillStyle||c,e.render.strokeStyle=e.render.strokeStyle||l,e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};t.set=function(e,n,c){var l;typeof n=="string"&&(l=n,n={},n[l]=c);for(l in n)if(c=n[l],!!n.hasOwnProperty(l))switch(l){case"isStatic":t.setStatic(e,c);break;case"isSleeping":i.set(e,c);break;case"mass":t.setMass(e,c);break;case"density":t.setDensity(e,c);break;case"inertia":t.setInertia(e,c);break;case"vertices":t.setVertices(e,c);break;case"position":t.setPosition(e,c);break;case"angle":t.setAngle(e,c);break;case"velocity":t.setVelocity(e,c);break;case"angularVelocity":t.setAngularVelocity(e,c);break;case"parts":t.setParts(e,c);break;default:e[l]=c}},t.setStatic=function(e,n){for(var c=0;c<e.parts.length;c++){var l=e.parts[c];l.isStatic=n,n?(l._original={restitution:l.restitution,friction:l.friction,mass:l.mass,inertia:l.inertia,density:l.density,inverseMass:l.inverseMass,inverseInertia:l.inverseInertia},l.restitution=0,l.friction=1,l.mass=l.inertia=l.density=1/0,l.inverseMass=l.inverseInertia=0,l.positionPrev.x=l.position.x,l.positionPrev.y=l.position.y,l.anglePrev=l.angle,l.angularVelocity=0,l.speed=0,l.angularSpeed=0,l.motion=0):l._original&&(l.restitution=l._original.restitution,l.friction=l._original.friction,l.mass=l._original.mass,l.inertia=l._original.inertia,l.density=l._original.density,l.inverseMass=l._original.inverseMass,l.inverseInertia=l._original.inverseInertia,delete l._original)}},t.setMass=function(e,n){var c=e.inertia/(e.mass/6);e.inertia=c*(n/6),e.inverseInertia=1/e.inertia,e.mass=n,e.inverseMass=1/e.mass,e.density=e.mass/e.area},t.setDensity=function(e,n){t.setMass(e,n*e.area),e.density=n},t.setInertia=function(e,n){e.inertia=n,e.inverseInertia=1/e.inertia},t.setVertices=function(e,n){n[0].body===e?e.vertices=n:e.vertices=f.create(n,e),e.axes=a.fromVertices(e.vertices),e.area=f.area(e.vertices),t.setMass(e,e.density*e.area);var c=f.centre(e.vertices);f.translate(e.vertices,c,-1),t.setInertia(e,t._inertiaScale*f.inertia(e.vertices,e.mass)),f.translate(e.vertices,e.position),r.update(e.bounds,e.vertices,e.velocity)},t.setParts=function(e,n,c){var l;for(n=n.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,l=0;l<n.length;l++){var m=n[l];m!==e&&(m.parent=e,e.parts.push(m))}if(e.parts.length!==1){if(c=typeof c<"u"?c:!0,c){var x=[];for(l=0;l<n.length;l++)x=x.concat(n[l].vertices);f.clockwiseSort(x);var h=f.hull(x),u=f.centre(h);t.setVertices(e,h),f.translate(e.vertices,u)}var p=t._totalProperties(e);e.area=p.area,e.parent=e,e.position.x=p.centre.x,e.position.y=p.centre.y,e.positionPrev.x=p.centre.x,e.positionPrev.y=p.centre.y,t.setMass(e,p.mass),t.setInertia(e,p.inertia),t.setPosition(e,p.centre)}},t.setPosition=function(e,n){var c=o.sub(n,e.position);e.positionPrev.x+=c.x,e.positionPrev.y+=c.y;for(var l=0;l<e.parts.length;l++){var m=e.parts[l];m.position.x+=c.x,m.position.y+=c.y,f.translate(m.vertices,c),r.update(m.bounds,m.vertices,e.velocity)}},t.setAngle=function(e,n){var c=n-e.angle;e.anglePrev+=c;for(var l=0;l<e.parts.length;l++){var m=e.parts[l];m.angle+=c,f.rotate(m.vertices,c,e.position),a.rotate(m.axes,c),r.update(m.bounds,m.vertices,e.velocity),l>0&&o.rotateAbout(m.position,c,e.position,m.position)}},t.setVelocity=function(e,n){e.positionPrev.x=e.position.x-n.x,e.positionPrev.y=e.position.y-n.y,e.velocity.x=n.x,e.velocity.y=n.y,e.speed=o.magnitude(e.velocity)},t.setAngularVelocity=function(e,n){e.anglePrev=e.angle-n,e.angularVelocity=n,e.angularSpeed=Math.abs(e.angularVelocity)},t.translate=function(e,n){t.setPosition(e,o.add(e.position,n))},t.rotate=function(e,n,c){if(!c)t.setAngle(e,e.angle+n);else{var l=Math.cos(n),m=Math.sin(n),x=e.position.x-c.x,h=e.position.y-c.y;t.setPosition(e,{x:c.x+(x*l-h*m),y:c.y+(x*m+h*l)}),t.setAngle(e,e.angle+n)}},t.scale=function(e,n,c,l){var m=0,x=0;l=l||e.position;for(var h=0;h<e.parts.length;h++){var u=e.parts[h];f.scale(u.vertices,n,c,l),u.axes=a.fromVertices(u.vertices),u.area=f.area(u.vertices),t.setMass(u,e.density*u.area),f.translate(u.vertices,{x:-u.position.x,y:-u.position.y}),t.setInertia(u,t._inertiaScale*f.inertia(u.vertices,u.mass)),f.translate(u.vertices,{x:u.position.x,y:u.position.y}),h>0&&(m+=u.area,x+=u.inertia),u.position.x=l.x+(u.position.x-l.x)*n,u.position.y=l.y+(u.position.y-l.y)*c,r.update(u.bounds,u.vertices,e.velocity)}e.parts.length>1&&(e.area=m,e.isStatic||(t.setMass(e,e.density*m),t.setInertia(e,x))),e.circleRadius&&(n===c?e.circleRadius*=n:e.circleRadius=null)},t.update=function(e,n,c,l){var m=Math.pow(n*c*e.timeScale,2),x=1-e.frictionAir*c*e.timeScale,h=e.position.x-e.positionPrev.x,u=e.position.y-e.positionPrev.y;e.velocity.x=h*x*l+e.force.x/e.mass*m,e.velocity.y=u*x*l+e.force.y/e.mass*m,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.angularVelocity=(e.angle-e.anglePrev)*x*l+e.torque/e.inertia*m,e.anglePrev=e.angle,e.angle+=e.angularVelocity,e.speed=o.magnitude(e.velocity),e.angularSpeed=Math.abs(e.angularVelocity);for(var p=0;p<e.parts.length;p++){var g=e.parts[p];f.translate(g.vertices,e.velocity),p>0&&(g.position.x+=e.velocity.x,g.position.y+=e.velocity.y),e.angularVelocity!==0&&(f.rotate(g.vertices,e.angularVelocity,e.position),a.rotate(g.axes,e.angularVelocity),p>0&&o.rotateAbout(g.position,e.angularVelocity,e.position,g.position)),r.update(g.bounds,g.vertices,e.velocity)}},t.applyForce=function(e,n,c){e.force.x+=c.x,e.force.y+=c.y;var l={x:n.x-e.position.x,y:n.y-e.position.y};e.torque+=l.x*c.y-l.y*c.x},t._totalProperties=function(e){for(var n={mass:0,area:0,inertia:0,centre:{x:0,y:0}},c=e.parts.length===1?0:1;c<e.parts.length;c++){var l=e.parts[c],m=l.mass!==1/0?l.mass:1;n.mass+=m,n.area+=l.area,n.inertia+=l.inertia,n.centre=o.add(n.centre,o.mult(l.position,m))}return n.centre=o.div(n.centre,n.mass),n}})()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(d,M,A){var t={};M.exports=t;var f=d("../core/Events"),o=d("../core/Common"),i=d("../geometry/Bounds"),v=d("./Body");(function(){t.create=function(r){return o.extend({id:o.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},r)},t.setModified=function(r,a,s,e){if(r.isModified=a,s&&r.parent&&t.setModified(r.parent,a,s,e),e)for(var n=0;n<r.composites.length;n++){var c=r.composites[n];t.setModified(c,a,s,e)}},t.add=function(r,a){var s=[].concat(a);f.trigger(r,"beforeAdd",{object:a});for(var e=0;e<s.length;e++){var n=s[e];switch(n.type){case"body":if(n.parent!==n){o.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}t.addBody(r,n);break;case"constraint":t.addConstraint(r,n);break;case"composite":t.addComposite(r,n);break;case"mouseConstraint":t.addConstraint(r,n.constraint);break}}return f.trigger(r,"afterAdd",{object:a}),r},t.remove=function(r,a,s){var e=[].concat(a);f.trigger(r,"beforeRemove",{object:a});for(var n=0;n<e.length;n++){var c=e[n];switch(c.type){case"body":t.removeBody(r,c,s);break;case"constraint":t.removeConstraint(r,c,s);break;case"composite":t.removeComposite(r,c,s);break;case"mouseConstraint":t.removeConstraint(r,c.constraint);break}}return f.trigger(r,"afterRemove",{object:a}),r},t.addComposite=function(r,a){return r.composites.push(a),a.parent=r,t.setModified(r,!0,!0,!1),r},t.removeComposite=function(r,a,s){var e=o.indexOf(r.composites,a);if(e!==-1&&(t.removeCompositeAt(r,e),t.setModified(r,!0,!0,!1)),s)for(var n=0;n<r.composites.length;n++)t.removeComposite(r.composites[n],a,!0);return r},t.removeCompositeAt=function(r,a){return r.composites.splice(a,1),t.setModified(r,!0,!0,!1),r},t.addBody=function(r,a){return r.bodies.push(a),t.setModified(r,!0,!0,!1),r},t.removeBody=function(r,a,s){var e=o.indexOf(r.bodies,a);if(e!==-1&&(t.removeBodyAt(r,e),t.setModified(r,!0,!0,!1)),s)for(var n=0;n<r.composites.length;n++)t.removeBody(r.composites[n],a,!0);return r},t.removeBodyAt=function(r,a){return r.bodies.splice(a,1),t.setModified(r,!0,!0,!1),r},t.addConstraint=function(r,a){return r.constraints.push(a),t.setModified(r,!0,!0,!1),r},t.removeConstraint=function(r,a,s){var e=o.indexOf(r.constraints,a);if(e!==-1&&t.removeConstraintAt(r,e),s)for(var n=0;n<r.composites.length;n++)t.removeConstraint(r.composites[n],a,!0);return r},t.removeConstraintAt=function(r,a){return r.constraints.splice(a,1),t.setModified(r,!0,!0,!1),r},t.clear=function(r,a,s){if(s)for(var e=0;e<r.composites.length;e++)t.clear(r.composites[e],a,!0);return a?r.bodies=r.bodies.filter(function(n){return n.isStatic}):r.bodies.length=0,r.constraints.length=0,r.composites.length=0,t.setModified(r,!0,!0,!1),r},t.allBodies=function(r){for(var a=[].concat(r.bodies),s=0;s<r.composites.length;s++)a=a.concat(t.allBodies(r.composites[s]));return a},t.allConstraints=function(r){for(var a=[].concat(r.constraints),s=0;s<r.composites.length;s++)a=a.concat(t.allConstraints(r.composites[s]));return a},t.allComposites=function(r){for(var a=[].concat(r.composites),s=0;s<r.composites.length;s++)a=a.concat(t.allComposites(r.composites[s]));return a},t.get=function(r,a,s){var e,n;switch(s){case"body":e=t.allBodies(r);break;case"constraint":e=t.allConstraints(r);break;case"composite":e=t.allComposites(r).concat(r);break}return e?(n=e.filter(function(c){return c.id.toString()===a.toString()}),n.length===0?null:n[0]):null},t.move=function(r,a,s){return t.remove(r,a),t.add(s,a),r},t.rebase=function(r){for(var a=t.allBodies(r).concat(t.allConstraints(r)).concat(t.allComposites(r)),s=0;s<a.length;s++)a[s].id=o.nextId();return t.setModified(r,!0,!0,!1),r},t.translate=function(r,a,s){for(var e=s?t.allBodies(r):r.bodies,n=0;n<e.length;n++)v.translate(e[n],a);return t.setModified(r,!0,!0,!1),r},t.rotate=function(r,a,s,e){for(var n=Math.cos(a),c=Math.sin(a),l=e?t.allBodies(r):r.bodies,m=0;m<l.length;m++){var x=l[m],h=x.position.x-s.x,u=x.position.y-s.y;v.setPosition(x,{x:s.x+(h*n-u*c),y:s.y+(h*c+u*n)}),v.rotate(x,a)}return t.setModified(r,!0,!0,!1),r},t.scale=function(r,a,s,e,n){for(var c=n?t.allBodies(r):r.bodies,l=0;l<c.length;l++){var m=c[l],x=m.position.x-e.x,h=m.position.y-e.y;v.setPosition(m,{x:e.x+x*a,y:e.y+h*s}),v.scale(m,a,s)}return t.setModified(r,!0,!0,!1),r},t.bounds=function(r){for(var a=t.allBodies(r),s=[],e=0;e<a.length;e+=1){var n=a[e];s.push(n.bounds.min,n.bounds.max)}return i.create(s)}})()},{"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"./Body":1}],3:[function(d,M,A){var t={};M.exports=t;var f=d("./Composite");d("../constraint/Constraint");var o=d("../core/Common");(function(){t.create=function(i){var v=f.create(),r={label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-1/0,y:-1/0},max:{x:1/0,y:1/0}}};return o.extend(v,r,i)}})()},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(d,M,A){var t={};M.exports=t,function(){t.create=function(f){return{id:t.id(f),vertex:f,normalImpulse:0,tangentImpulse:0}},t.id=function(f){return f.body.id+"_"+f.index}}()},{}],5:[function(d,M,A){var t={};M.exports=t;var f=d("./SAT"),o=d("./Pair"),i=d("../geometry/Bounds");(function(){t.collisions=function(v,r){for(var a=[],s=r.pairs.table,e=0;e<v.length;e++){var n=v[e][0],c=v[e][1];if(!((n.isStatic||n.isSleeping)&&(c.isStatic||c.isSleeping))&&t.canCollide(n.collisionFilter,c.collisionFilter)&&i.overlaps(n.bounds,c.bounds))for(var l=n.parts.length>1?1:0;l<n.parts.length;l++)for(var m=n.parts[l],x=c.parts.length>1?1:0;x<c.parts.length;x++){var h=c.parts[x];if(m===n&&h===c||i.overlaps(m.bounds,h.bounds)){var u=o.id(m,h),p=s[u],g;p&&p.isActive?g=p.collision:g=null;var w=f.collides(m,h,g);w.collided&&a.push(w)}}}return a},t.canCollide=function(v,r){return v.group===r.group&&v.group!==0?v.group>0:(v.mask&r.category)!==0&&(r.mask&v.category)!==0}})()},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(d,M,A){var t={};M.exports=t;var f=d("./Pair"),o=d("./Detector"),i=d("../core/Common");(function(){t.create=function(v){var r={controller:t,detector:o.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return i.extend(r,v)},t.update=function(v,r,a,s){var e,n,c,l=a.world,m=v.buckets,x,h,u=!1;for(e=0;e<r.length;e++){var p=r[e];if(!(p.isSleeping&&!s)&&!(p.bounds.max.x<l.bounds.min.x||p.bounds.min.x>l.bounds.max.x||p.bounds.max.y<l.bounds.min.y||p.bounds.min.y>l.bounds.max.y)){var g=t._getRegion(v,p);if(!p.region||g.id!==p.region.id||s){(!p.region||s)&&(p.region=g);var w=t._regionUnion(g,p.region);for(n=w.startCol;n<=w.endCol;n++)for(c=w.startRow;c<=w.endRow;c++){h=t._getBucketId(n,c),x=m[h];var y=n>=g.startCol&&n<=g.endCol&&c>=g.startRow&&c<=g.endRow,C=n>=p.region.startCol&&n<=p.region.endCol&&c>=p.region.startRow&&c<=p.region.endRow;!y&&C&&C&&x&&t._bucketRemoveBody(v,x,p),(p.region===g||y&&!C||s)&&(x||(x=t._createBucket(m,h)),t._bucketAddBody(v,x,p))}p.region=g,u=!0}}}u&&(v.pairsList=t._createActivePairsList(v))},t.clear=function(v){v.buckets={},v.pairs={},v.pairsList=[]},t._regionUnion=function(v,r){var a=Math.min(v.startCol,r.startCol),s=Math.max(v.endCol,r.endCol),e=Math.min(v.startRow,r.startRow),n=Math.max(v.endRow,r.endRow);return t._createRegion(a,s,e,n)},t._getRegion=function(v,r){var a=r.bounds,s=Math.floor(a.min.x/v.bucketWidth),e=Math.floor(a.max.x/v.bucketWidth),n=Math.floor(a.min.y/v.bucketHeight),c=Math.floor(a.max.y/v.bucketHeight);return t._createRegion(s,e,n,c)},t._createRegion=function(v,r,a,s){return{id:v+","+r+","+a+","+s,startCol:v,endCol:r,startRow:a,endRow:s}},t._getBucketId=function(v,r){return"C"+v+"R"+r},t._createBucket=function(v,r){var a=v[r]=[];return a},t._bucketAddBody=function(v,r,a){for(var s=0;s<r.length;s++){var e=r[s];if(!(a.id===e.id||a.isStatic&&e.isStatic)){var n=f.id(a,e),c=v.pairs[n];c?c[2]+=1:v.pairs[n]=[a,e,1]}}r.push(a)},t._bucketRemoveBody=function(v,r,a){r.splice(i.indexOf(r,a),1);for(var s=0;s<r.length;s++){var e=r[s],n=f.id(a,e),c=v.pairs[n];c&&(c[2]-=1)}},t._createActivePairsList=function(v){var r,a,s=[];r=i.keys(v.pairs);for(var e=0;e<r.length;e++)a=v.pairs[r[e]],a[2]>0?s.push(a):delete v.pairs[r[e]];return s}})()},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(d,M,A){var t={};M.exports=t;var f=d("./Contact");(function(){t.create=function(o,i){var v=o.bodyA,r=o.bodyB,a=o.parentA,s=o.parentB,e={id:t.id(v,r),bodyA:v,bodyB:r,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:v.isSensor||r.isSensor,timeCreated:i,timeUpdated:i,inverseMass:a.inverseMass+s.inverseMass,friction:Math.min(a.friction,s.friction),frictionStatic:Math.max(a.frictionStatic,s.frictionStatic),restitution:Math.max(a.restitution,s.restitution),slop:Math.max(a.slop,s.slop)};return t.update(e,o,i),e},t.update=function(o,i,v){var r=o.contacts,a=i.supports,s=o.activeContacts,e=i.parentA,n=i.parentB;if(o.collision=i,o.inverseMass=e.inverseMass+n.inverseMass,o.friction=Math.min(e.friction,n.friction),o.frictionStatic=Math.max(e.frictionStatic,n.frictionStatic),o.restitution=Math.max(e.restitution,n.restitution),o.slop=Math.max(e.slop,n.slop),s.length=0,i.collided){for(var c=0;c<a.length;c++){var l=a[c],m=f.id(l),x=r[m];x?s.push(x):s.push(r[m]=f.create(l))}o.separation=i.depth,t.setActive(o,!0,v)}else o.isActive===!0&&t.setActive(o,!1,v)},t.setActive=function(o,i,v){i?(o.isActive=!0,o.timeUpdated=v):(o.isActive=!1,o.activeContacts.length=0)},t.id=function(o,i){return o.id<i.id?"A"+o.id+"B"+i.id:"A"+i.id+"B"+o.id}})()},{"./Contact":4}],8:[function(d,M,A){var t={};M.exports=t;var f=d("./Pair"),o=d("../core/Common");(function(){t._pairMaxIdleLife=1e3,t.create=function(i){return o.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},i)},t.update=function(i,v,r){var a=i.list,s=i.table,e=i.collisionStart,n=i.collisionEnd,c=i.collisionActive,l=[],m,x,h,u;for(e.length=0,n.length=0,c.length=0,u=0;u<v.length;u++)m=v[u],m.collided&&(x=f.id(m.bodyA,m.bodyB),l.push(x),h=s[x],h?(h.isActive?c.push(h):e.push(h),f.update(h,m,r)):(h=f.create(m,r),s[x]=h,e.push(h),a.push(h)));for(u=0;u<a.length;u++)h=a[u],h.isActive&&o.indexOf(l,h.id)===-1&&(f.setActive(h,!1,r),n.push(h))},t.removeOld=function(i,v){var r=i.list,a=i.table,s=[],e,n,c,l;for(l=0;l<r.length;l++){if(e=r[l],n=e.collision,n.bodyA.isSleeping||n.bodyB.isSleeping){e.timeUpdated=v;continue}v-e.timeUpdated>t._pairMaxIdleLife&&s.push(l)}for(l=0;l<s.length;l++)c=s[l]-l,e=r[c],delete a[e.id],r.splice(c,1)},t.clear=function(i){return i.table={},i.list.length=0,i.collisionStart.length=0,i.collisionActive.length=0,i.collisionEnd.length=0,i}})()},{"../core/Common":14,"./Pair":7}],9:[function(d,M,A){var t={};M.exports=t;var f=d("../geometry/Vector"),o=d("./SAT"),i=d("../geometry/Bounds"),v=d("../factory/Bodies"),r=d("../geometry/Vertices");(function(){t.collides=function(a,s){for(var e=[],n=0;n<s.length;n++){var c=s[n];if(i.overlaps(c.bounds,a.bounds))for(var l=c.parts.length===1?0:1;l<c.parts.length;l++){var m=c.parts[l];if(i.overlaps(m.bounds,a.bounds)){var x=o.collides(m,a);if(x.collided){e.push(x);break}}}}return e},t.ray=function(a,s,e,n){n=n||1e-100;for(var c=f.angle(s,e),l=f.magnitude(f.sub(s,e)),m=(e.x+s.x)*.5,x=(e.y+s.y)*.5,h=v.rectangle(m,x,l,n,{angle:c}),u=t.collides(h,a),p=0;p<u.length;p+=1){var g=u[p];g.body=g.bodyB=g.bodyA}return u},t.region=function(a,s,e){for(var n=[],c=0;c<a.length;c++){var l=a[c],m=i.overlaps(l.bounds,s);(m&&!e||!m&&e)&&n.push(l)}return n},t.point=function(a,s){for(var e=[],n=0;n<a.length;n++){var c=a[n];if(i.contains(c.bounds,s))for(var l=c.parts.length===1?0:1;l<c.parts.length;l++){var m=c.parts[l];if(i.contains(m.bounds,s)&&r.contains(m.vertices,s)){e.push(c);break}}}return e}})()},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(d,M,A){var t={};M.exports=t;var f=d("../geometry/Vertices"),o=d("../geometry/Vector"),i=d("../core/Common"),v=d("../geometry/Bounds");(function(){t._restingThresh=4,t._restingThreshTangent=6,t._positionDampen=.9,t._positionWarming=.8,t._frictionNormalMultiplier=5,t.preSolvePosition=function(r){var a,s,e;for(a=0;a<r.length;a++)s=r[a],s.isActive&&(e=s.activeContacts.length,s.collision.parentA.totalContacts+=e,s.collision.parentB.totalContacts+=e)},t.solvePosition=function(r,a){var s,e,n,c,l,m,x,h,u,p=o._temp[0],g=o._temp[1],w=o._temp[2],y=o._temp[3];for(s=0;s<r.length;s++)e=r[s],!(!e.isActive||e.isSensor)&&(n=e.collision,c=n.parentA,l=n.parentB,m=n.normal,x=o.sub(o.add(l.positionImpulse,l.position,p),o.add(c.positionImpulse,o.sub(l.position,n.penetration,g),w),y),e.separation=o.dot(m,x));for(s=0;s<r.length;s++)e=r[s],!(!e.isActive||e.isSensor)&&(n=e.collision,c=n.parentA,l=n.parentB,m=n.normal,u=(e.separation-e.slop)*a,(c.isStatic||l.isStatic)&&(u*=2),c.isStatic||c.isSleeping||(h=t._positionDampen/c.totalContacts,c.positionImpulse.x+=m.x*u*h,c.positionImpulse.y+=m.y*u*h),l.isStatic||l.isSleeping||(h=t._positionDampen/l.totalContacts,l.positionImpulse.x-=m.x*u*h,l.positionImpulse.y-=m.y*u*h))},t.postSolvePosition=function(r){for(var a=0;a<r.length;a++){var s=r[a];if(s.totalContacts=0,s.positionImpulse.x!==0||s.positionImpulse.y!==0){for(var e=0;e<s.parts.length;e++){var n=s.parts[e];f.translate(n.vertices,s.positionImpulse),v.update(n.bounds,n.vertices,s.velocity),n.position.x+=s.positionImpulse.x,n.position.y+=s.positionImpulse.y}s.positionPrev.x+=s.positionImpulse.x,s.positionPrev.y+=s.positionImpulse.y,o.dot(s.positionImpulse,s.velocity)<0?(s.positionImpulse.x=0,s.positionImpulse.y=0):(s.positionImpulse.x*=t._positionWarming,s.positionImpulse.y*=t._positionWarming)}}},t.preSolveVelocity=function(r){var a,s,e,n,c,l,m,x,h,u,p,g,w,y,C=o._temp[0],P=o._temp[1];for(a=0;a<r.length;a++)if(e=r[a],!(!e.isActive||e.isSensor))for(n=e.activeContacts,c=e.collision,l=c.parentA,m=c.parentB,x=c.normal,h=c.tangent,s=0;s<n.length;s++)u=n[s],p=u.vertex,g=u.normalImpulse,w=u.tangentImpulse,(g!==0||w!==0)&&(C.x=x.x*g+h.x*w,C.y=x.y*g+h.y*w,l.isStatic||l.isSleeping||(y=o.sub(p,l.position,P),l.positionPrev.x+=C.x*l.inverseMass,l.positionPrev.y+=C.y*l.inverseMass,l.anglePrev+=o.cross(y,C)*l.inverseInertia),m.isStatic||m.isSleeping||(y=o.sub(p,m.position,P),m.positionPrev.x-=C.x*m.inverseMass,m.positionPrev.y-=C.y*m.inverseMass,m.anglePrev-=o.cross(y,C)*m.inverseInertia))},t.solveVelocity=function(r,a){for(var s=a*a,e=o._temp[0],n=o._temp[1],c=o._temp[2],l=o._temp[3],m=o._temp[4],x=o._temp[5],h=0;h<r.length;h++){var u=r[h];if(!(!u.isActive||u.isSensor)){var p=u.collision,g=p.parentA,w=p.parentB,y=p.normal,C=p.tangent,P=u.activeContacts,I=1/P.length;g.velocity.x=g.position.x-g.positionPrev.x,g.velocity.y=g.position.y-g.positionPrev.y,w.velocity.x=w.position.x-w.positionPrev.x,w.velocity.y=w.position.y-w.positionPrev.y,g.angularVelocity=g.angle-g.anglePrev,w.angularVelocity=w.angle-w.anglePrev;for(var B=0;B<P.length;B++){var k=P[B],T=k.vertex,E=o.sub(T,g.position,n),b=o.sub(T,w.position,c),R=o.add(g.velocity,o.mult(o.perp(E),g.angularVelocity),l),F=o.add(w.velocity,o.mult(o.perp(b),w.angularVelocity),m),V=o.sub(R,F,x),D=o.dot(y,V),W=o.dot(C,V),U=Math.abs(W),H=i.sign(W),N=(1+u.restitution)*D,ee=i.clamp(u.separation+D,0,1)*t._frictionNormalMultiplier,G=W,z=1/0;U>u.friction*u.frictionStatic*ee*s&&(z=U,G=i.clamp(u.friction*H*s,-z,z));var Y=o.cross(E,y),$=o.cross(b,y),Q=I/(g.inverseMass+w.inverseMass+g.inverseInertia*Y*Y+w.inverseInertia*$*$);if(N*=Q,G*=Q,D<0&&D*D>t._restingThresh*s)k.normalImpulse=0;else{var te=k.normalImpulse;k.normalImpulse=Math.min(k.normalImpulse+N,0),N=k.normalImpulse-te}if(W*W>t._restingThreshTangent*s)k.tangentImpulse=0;else{var ie=k.tangentImpulse;k.tangentImpulse=i.clamp(k.tangentImpulse+G,-z,z),G=k.tangentImpulse-ie}e.x=y.x*N+C.x*G,e.y=y.y*N+C.y*G,g.isStatic||g.isSleeping||(g.positionPrev.x+=e.x*g.inverseMass,g.positionPrev.y+=e.y*g.inverseMass,g.anglePrev+=o.cross(E,e)*g.inverseInertia),w.isStatic||w.isSleeping||(w.positionPrev.x-=e.x*w.inverseMass,w.positionPrev.y-=e.y*w.inverseMass,w.anglePrev-=o.cross(b,e)*w.inverseInertia)}}}}})()},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(d,M,A){var t={};M.exports=t;var f=d("../geometry/Vertices"),o=d("../geometry/Vector");(function(){t.collides=function(i,v,r){var a,s,e,n,c=!1;if(r){var l=i.parent,m=v.parent,x=l.speed*l.speed+l.angularSpeed*l.angularSpeed+m.speed*m.speed+m.angularSpeed*m.angularSpeed;c=r&&r.collided&&x<.2,n=r}else n={collided:!1,bodyA:i,bodyB:v};if(r&&c){var h=n.axisBody,u=h===i?v:i,p=[h.axes[r.axisNumber]];if(e=t._overlapAxes(h.vertices,u.vertices,p),n.reused=!0,e.overlap<=0)return n.collided=!1,n}else{if(a=t._overlapAxes(i.vertices,v.vertices,i.axes),a.overlap<=0||(s=t._overlapAxes(v.vertices,i.vertices,v.axes),s.overlap<=0))return n.collided=!1,n;a.overlap<s.overlap?(e=a,n.axisBody=i):(e=s,n.axisBody=v),n.axisNumber=e.axisNumber}n.bodyA=i.id<v.id?i:v,n.bodyB=i.id<v.id?v:i,n.collided=!0,n.depth=e.overlap,n.parentA=n.bodyA.parent,n.parentB=n.bodyB.parent,i=n.bodyA,v=n.bodyB,o.dot(e.axis,o.sub(v.position,i.position))<0?n.normal={x:e.axis.x,y:e.axis.y}:n.normal={x:-e.axis.x,y:-e.axis.y},n.tangent=o.perp(n.normal),n.penetration=n.penetration||{},n.penetration.x=n.normal.x*n.depth,n.penetration.y=n.normal.y*n.depth;var g=t._findSupports(i,v,n.normal),w=[];if(f.contains(i.vertices,g[0])&&w.push(g[0]),f.contains(i.vertices,g[1])&&w.push(g[1]),w.length<2){var y=t._findSupports(v,i,o.neg(n.normal));f.contains(v.vertices,y[0])&&w.push(y[0]),w.length<2&&f.contains(v.vertices,y[1])&&w.push(y[1])}return w.length<1&&(w=[g[0]]),n.supports=w,n},t._overlapAxes=function(i,v,r){for(var a=o._temp[0],s=o._temp[1],e={overlap:Number.MAX_VALUE},n,c,l=0;l<r.length;l++){if(c=r[l],t._projectToAxis(a,i,c),t._projectToAxis(s,v,c),n=Math.min(a.max-s.min,s.max-a.min),n<=0)return e.overlap=n,e;n<e.overlap&&(e.overlap=n,e.axis=c,e.axisNumber=l)}return e},t._projectToAxis=function(i,v,r){for(var a=o.dot(v[0],r),s=a,e=1;e<v.length;e+=1){var n=o.dot(v[e],r);n>s?s=n:n<a&&(a=n)}i.min=a,i.max=s},t._findSupports=function(i,v,r){for(var a=Number.MAX_VALUE,s=o._temp[0],e=v.vertices,n=i.position,c,l,m,x,h=0;h<e.length;h++)l=e[h],s.x=l.x-n.x,s.y=l.y-n.y,c=-o.dot(r,s),c<a&&(a=c,m=l);var u=m.index-1>=0?m.index-1:e.length-1;l=e[u],s.x=l.x-n.x,s.y=l.y-n.y,a=-o.dot(r,s),x=l;var p=(m.index+1)%e.length;return l=e[p],s.x=l.x-n.x,s.y=l.y-n.y,c=-o.dot(r,s),c<a&&(x=l),[m,x]}})()},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(d,M,A){var t={};M.exports=t;var f=d("../geometry/Vertices"),o=d("../geometry/Vector"),i=d("../core/Sleeping"),v=d("../geometry/Bounds"),r=d("../geometry/Axes"),a=d("../core/Common");(function(){t._warming=.4,t._torqueDampen=1,t._minLength=1e-6,t.create=function(s){var e=s;e.bodyA&&!e.pointA&&(e.pointA={x:0,y:0}),e.bodyB&&!e.pointB&&(e.pointB={x:0,y:0});var n=e.bodyA?o.add(e.bodyA.position,e.pointA):e.pointA,c=e.bodyB?o.add(e.bodyB.position,e.pointB):e.pointB,l=o.magnitude(o.sub(n,c));e.length=typeof e.length<"u"?e.length:l,e.id=e.id||a.nextId(),e.label=e.label||"Constraint",e.type="constraint",e.stiffness=e.stiffness||(e.length>0?1:.7),e.damping=e.damping||0,e.angularStiffness=e.angularStiffness||0,e.angleA=e.bodyA?e.bodyA.angle:e.angleA,e.angleB=e.bodyB?e.bodyB.angle:e.angleB,e.plugin={};var m={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return e.length===0&&e.stiffness>.1?(m.type="pin",m.anchors=!1):e.stiffness<.9&&(m.type="spring"),e.render=a.extend(m,e.render),e},t.preSolveAll=function(s){for(var e=0;e<s.length;e+=1){var n=s[e],c=n.constraintImpulse;n.isStatic||c.x===0&&c.y===0&&c.angle===0||(n.position.x+=c.x,n.position.y+=c.y,n.angle+=c.angle)}},t.solveAll=function(s,e){for(var n=0;n<s.length;n+=1){var c=s[n],l=!c.bodyA||c.bodyA&&c.bodyA.isStatic,m=!c.bodyB||c.bodyB&&c.bodyB.isStatic;(l||m)&&t.solve(s[n],e)}for(n=0;n<s.length;n+=1)c=s[n],l=!c.bodyA||c.bodyA&&c.bodyA.isStatic,m=!c.bodyB||c.bodyB&&c.bodyB.isStatic,!l&&!m&&t.solve(s[n],e)},t.solve=function(s,e){var n=s.bodyA,c=s.bodyB,l=s.pointA,m=s.pointB;if(!(!n&&!c)){n&&!n.isStatic&&(o.rotate(l,n.angle-s.angleA,l),s.angleA=n.angle),c&&!c.isStatic&&(o.rotate(m,c.angle-s.angleB,m),s.angleB=c.angle);var x=l,h=m;if(n&&(x=o.add(n.position,l)),c&&(h=o.add(c.position,m)),!(!x||!h)){var u=o.sub(x,h),p=o.magnitude(u);p<t._minLength&&(p=t._minLength);var g=(p-s.length)/p,w=s.stiffness<1?s.stiffness*e:s.stiffness,y=o.mult(u,g*w),C=(n?n.inverseMass:0)+(c?c.inverseMass:0),P=(n?n.inverseInertia:0)+(c?c.inverseInertia:0),I=C+P,B,k,T,E,b;if(s.damping){var R=o.create();T=o.div(u,p),b=o.sub(c&&o.sub(c.position,c.positionPrev)||R,n&&o.sub(n.position,n.positionPrev)||R),E=o.dot(T,b)}n&&!n.isStatic&&(k=n.inverseMass/C,n.constraintImpulse.x-=y.x*k,n.constraintImpulse.y-=y.y*k,n.position.x-=y.x*k,n.position.y-=y.y*k,s.damping&&(n.positionPrev.x-=s.damping*T.x*E*k,n.positionPrev.y-=s.damping*T.y*E*k),B=o.cross(l,y)/I*t._torqueDampen*n.inverseInertia*(1-s.angularStiffness),n.constraintImpulse.angle-=B,n.angle-=B),c&&!c.isStatic&&(k=c.inverseMass/C,c.constraintImpulse.x+=y.x*k,c.constraintImpulse.y+=y.y*k,c.position.x+=y.x*k,c.position.y+=y.y*k,s.damping&&(c.positionPrev.x+=s.damping*T.x*E*k,c.positionPrev.y+=s.damping*T.y*E*k),B=o.cross(m,y)/I*t._torqueDampen*c.inverseInertia*(1-s.angularStiffness),c.constraintImpulse.angle+=B,c.angle+=B)}}},t.postSolveAll=function(s){for(var e=0;e<s.length;e++){var n=s[e],c=n.constraintImpulse;if(!(n.isStatic||c.x===0&&c.y===0&&c.angle===0)){i.set(n,!1);for(var l=0;l<n.parts.length;l++){var m=n.parts[l];f.translate(m.vertices,c),l>0&&(m.position.x+=c.x,m.position.y+=c.y),c.angle!==0&&(f.rotate(m.vertices,c.angle,n.position),r.rotate(m.axes,c.angle),l>0&&o.rotateAbout(m.position,c.angle,n.position,m.position)),v.update(m.bounds,m.vertices,n.velocity)}c.angle*=t._warming,c.x*=t._warming,c.y*=t._warming}}}})()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(d,M,A){var t={};M.exports=t;var f=d("../geometry/Vertices"),o=d("../core/Sleeping"),i=d("../core/Mouse"),v=d("../core/Events"),r=d("../collision/Detector"),a=d("./Constraint"),s=d("../body/Composite"),e=d("../core/Common"),n=d("../geometry/Bounds");(function(){t.create=function(c,l){var m=(c?c.mouse:null)||(l?l.mouse:null);m||(c&&c.render&&c.render.canvas?m=i.create(c.render.canvas):l&&l.element?m=i.create(l.element):(m=i.create(),e.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var x=a.create({label:"Mouse Constraint",pointA:m.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),h={type:"mouseConstraint",mouse:m,element:null,body:null,constraint:x,collisionFilter:{category:1,mask:4294967295,group:0}},u=e.extend(h,l);return v.on(c,"beforeUpdate",function(){var p=s.allBodies(c.world);t.update(u,p),t._triggerEvents(u)}),u},t.update=function(c,l){var m=c.mouse,x=c.constraint,h=c.body;if(m.button===0){if(x.bodyB)o.set(x.bodyB,!1),x.pointA=m.position;else for(var u=0;u<l.length;u++)if(h=l[u],n.contains(h.bounds,m.position)&&r.canCollide(h.collisionFilter,c.collisionFilter))for(var p=h.parts.length>1?1:0;p<h.parts.length;p++){var g=h.parts[p];if(f.contains(g.vertices,m.position)){x.pointA=m.position,x.bodyB=c.body=h,x.pointB={x:m.position.x-h.position.x,y:m.position.y-h.position.y},x.angleB=h.angle,o.set(h,!1),v.trigger(c,"startdrag",{mouse:m,body:h});break}}}else x.bodyB=c.body=null,x.pointB=null,h&&v.trigger(c,"enddrag",{mouse:m,body:h})},t._triggerEvents=function(c){var l=c.mouse,m=l.sourceEvents;m.mousemove&&v.trigger(c,"mousemove",{mouse:l}),m.mousedown&&v.trigger(c,"mousedown",{mouse:l}),m.mouseup&&v.trigger(c,"mouseup",{mouse:l}),i.clearSourceEvents(l)}})()},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(d,M,A){(function(t){var f={};M.exports=f,function(){f._nextId=0,f._seed=0,f._nowStartTime=+new Date,f.extend=function(i,v){var r,a;typeof v=="boolean"?(r=2,a=v):(r=1,a=!0);for(var s=r;s<arguments.length;s++){var e=arguments[s];if(e)for(var n in e)a&&e[n]&&e[n].constructor===Object&&(!i[n]||i[n].constructor===Object)?(i[n]=i[n]||{},f.extend(i[n],a,e[n])):i[n]=e[n]}return i},f.clone=function(i,v){return f.extend({},v,i)},f.keys=function(i){if(Object.keys)return Object.keys(i);var v=[];for(var r in i)v.push(r);return v},f.values=function(i){var v=[];if(Object.keys){for(var r=Object.keys(i),a=0;a<r.length;a++)v.push(i[r[a]]);return v}for(var s in i)v.push(i[s]);return v},f.get=function(i,v,r,a){v=v.split(".").slice(r,a);for(var s=0;s<v.length;s+=1)i=i[v[s]];return i},f.set=function(i,v,r,a,s){var e=v.split(".").slice(a,s);return f.get(i,v,0,-1)[e[e.length-1]]=r,r},f.shuffle=function(i){for(var v=i.length-1;v>0;v--){var r=Math.floor(f.random()*(v+1)),a=i[v];i[v]=i[r],i[r]=a}return i},f.choose=function(i){return i[Math.floor(f.random()*i.length)]},f.isElement=function(i){return typeof HTMLElement<"u"?i instanceof HTMLElement:!!(i&&i.nodeType&&i.nodeName)},f.isArray=function(i){return Object.prototype.toString.call(i)==="[object Array]"},f.isFunction=function(i){return typeof i=="function"},f.isPlainObject=function(i){return typeof i=="object"&&i.constructor===Object},f.isString=function(i){return toString.call(i)==="[object String]"},f.clamp=function(i,v,r){return i<v?v:i>r?r:i},f.sign=function(i){return i<0?-1:1},f.now=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-f._nowStartTime},f.random=function(i,v){return i=typeof i<"u"?i:0,v=typeof v<"u"?v:1,i+o()*(v-i)};var o=function(){return f._seed=(f._seed*9301+49297)%233280,f._seed/233280};f.colorToNumber=function(i){return i=i.replace("#",""),i.length==3&&(i=i.charAt(0)+i.charAt(0)+i.charAt(1)+i.charAt(1)+i.charAt(2)+i.charAt(2)),parseInt(i,16)},f.logLevel=1,f.log=function(){console&&f.logLevel>0&&f.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},f.info=function(){console&&f.logLevel>0&&f.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},f.warn=function(){console&&f.logLevel>0&&f.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},f.nextId=function(){return f._nextId++},f.indexOf=function(i,v){if(i.indexOf)return i.indexOf(v);for(var r=0;r<i.length;r++)if(i[r]===v)return r;return-1},f.map=function(i,v){if(i.map)return i.map(v);for(var r=[],a=0;a<i.length;a+=1)r.push(v(i[a]));return r},f.topologicalSort=function(i){var v=[],r=[],a=[];for(var s in i)!r[s]&&!a[s]&&f._topologicalSort(s,r,a,i,v);return v},f._topologicalSort=function(i,v,r,a,s){var e=a[i]||[];r[i]=!0;for(var n=0;n<e.length;n+=1){var c=e[n];r[c]||v[c]||f._topologicalSort(c,v,r,a,s)}r[i]=!1,v[i]=!0,s.push(i)},f.chain=function(){for(var i=[],v=0;v<arguments.length;v+=1){var r=arguments[v];r._chained?i.push.apply(i,r._chained):i.push(r)}var a=function(){for(var s,e=new Array(arguments.length),n=0,c=arguments.length;n<c;n++)e[n]=arguments[n];for(n=0;n<i.length;n+=1){var l=i[n].apply(s,e);typeof l<"u"&&(s=l)}return s};return a._chained=i,a},f.chainPathBefore=function(i,v,r){return f.set(i,v,f.chain(r,f.get(i,v)))},f.chainPathAfter=function(i,v,r){return f.set(i,v,f.chain(f.get(i,v),r))},f._requireGlobal=function(i,v){var r=typeof window<"u"?window[i]:typeof t<"u"?t[i]:null;return r||d(v)}}()}).call(this,typeof Z<"u"?Z:typeof self<"u"?self:typeof window<"u"?window:{})},{}],15:[function(d,M,A){var t={};M.exports=t;var f=d("../body/World"),o=d("./Sleeping"),i=d("../collision/Resolver"),v=d("../render/Render"),r=d("../collision/Pairs");d("./Metrics");var a=d("../collision/Grid"),s=d("./Events"),e=d("../body/Composite"),n=d("../constraint/Constraint"),c=d("./Common"),l=d("../body/Body");(function(){t.create=function(m,x){x=c.isElement(m)?x:m,m=c.isElement(m)?m:null,x=x||{},(m||x.render)&&c.warn("Engine.create: engine.render is deprecated (see docs)");var h={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:a}},u=c.extend(h,x);if(m||u.render){var p={element:m,controller:v};u.render=c.extend(p,u.render)}return u.render&&u.render.controller&&(u.render=u.render.controller.create(u.render)),u.render&&(u.render.engine=u),u.world=x.world||f.create(u.world),u.pairs=r.create(),u.broadphase=u.broadphase.controller.create(u.broadphase),u.metrics=u.metrics||{extended:!1},u},t.update=function(m,x,h){x=x||1e3/60,h=h||1;var u=m.world,p=m.timing,g=m.broadphase,w=[],y;p.timestamp+=x*p.timeScale;var C={timestamp:p.timestamp};s.trigger(m,"beforeUpdate",C);var P=e.allBodies(u),I=e.allConstraints(u);for(m.enableSleeping&&o.update(P,p.timeScale),t._bodiesApplyGravity(P,u.gravity),t._bodiesUpdate(P,x,p.timeScale,h,u.bounds),n.preSolveAll(P),y=0;y<m.constraintIterations;y++)n.solveAll(I,p.timeScale);n.postSolveAll(P),g.controller?(u.isModified&&g.controller.clear(g),g.controller.update(g,P,m,u.isModified),w=g.pairsList):w=P,u.isModified&&e.setModified(u,!1,!1,!0);var B=g.detector(w,m),k=m.pairs,T=p.timestamp;for(r.update(k,B,T),r.removeOld(k,T),m.enableSleeping&&o.afterCollisions(k.list,p.timeScale),k.collisionStart.length>0&&s.trigger(m,"collisionStart",{pairs:k.collisionStart}),i.preSolvePosition(k.list),y=0;y<m.positionIterations;y++)i.solvePosition(k.list,p.timeScale);for(i.postSolvePosition(P),n.preSolveAll(P),y=0;y<m.constraintIterations;y++)n.solveAll(I,p.timeScale);for(n.postSolveAll(P),i.preSolveVelocity(k.list),y=0;y<m.velocityIterations;y++)i.solveVelocity(k.list,p.timeScale);return k.collisionActive.length>0&&s.trigger(m,"collisionActive",{pairs:k.collisionActive}),k.collisionEnd.length>0&&s.trigger(m,"collisionEnd",{pairs:k.collisionEnd}),t._bodiesClearForces(P),s.trigger(m,"afterUpdate",C),m},t.merge=function(m,x){if(c.extend(m,x),x.world){m.world=x.world,t.clear(m);for(var h=e.allBodies(m.world),u=0;u<h.length;u++){var p=h[u];o.set(p,!1),p.id=c.nextId()}}},t.clear=function(m){var x=m.world;r.clear(m.pairs);var h=m.broadphase;if(h.controller){var u=e.allBodies(x);h.controller.clear(h),h.controller.update(h,u,m,!0)}},t._bodiesClearForces=function(m){for(var x=0;x<m.length;x++){var h=m[x];h.force.x=0,h.force.y=0,h.torque=0}},t._bodiesApplyGravity=function(m,x){var h=typeof x.scale<"u"?x.scale:.001;if(!(x.x===0&&x.y===0||h===0))for(var u=0;u<m.length;u++){var p=m[u];p.isStatic||p.isSleeping||(p.force.y+=p.mass*x.y*h,p.force.x+=p.mass*x.x*h)}},t._bodiesUpdate=function(m,x,h,u,p){for(var g=0;g<m.length;g++){var w=m[g];w.isStatic||w.isSleeping||l.update(w,x,h,u)}}})()},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(d,M,A){var t={};M.exports=t;var f=d("./Common");(function(){t.on=function(o,i,v){for(var r=i.split(" "),a,s=0;s<r.length;s++)a=r[s],o.events=o.events||{},o.events[a]=o.events[a]||[],o.events[a].push(v);return v},t.off=function(o,i,v){if(!i){o.events={};return}typeof i=="function"&&(v=i,i=f.keys(o.events).join(" "));for(var r=i.split(" "),a=0;a<r.length;a++){var s=o.events[r[a]],e=[];if(v&&s)for(var n=0;n<s.length;n++)s[n]!==v&&e.push(s[n]);o.events[r[a]]=e}},t.trigger=function(o,i,v){var r,a,s,e;if(o.events){v||(v={}),r=i.split(" ");for(var n=0;n<r.length;n++)if(a=r[n],s=o.events[a],s){e=f.clone(v,!1),e.name=a,e.source=o;for(var c=0;c<s.length;c++)s[c].apply(o,[e])}}}})()},{"./Common":14}],17:[function(d,M,A){var t={};M.exports=t;var f=d("./Plugin"),o=d("./Common");(function(){t.name="matter-js",t.version="0.14.2",t.uses=[],t.used=[],t.use=function(){f.use(t,Array.prototype.slice.call(arguments))},t.before=function(i,v){return i=i.replace(/^Matter./,""),o.chainPathBefore(t,i,v)},t.after=function(i,v){return i=i.replace(/^Matter./,""),o.chainPathAfter(t,i,v)}})()},{"./Common":14,"./Plugin":20}],18:[function(d,M,A){},{"../body/Composite":2,"./Common":14}],19:[function(d,M,A){var t={};M.exports=t;var f=d("../core/Common");(function(){t.create=function(o){var i={};return o||f.log("Mouse.create: element was undefined, defaulting to document.body","warn"),i.element=o||document.body,i.absolute={x:0,y:0},i.position={x:0,y:0},i.mousedownPosition={x:0,y:0},i.mouseupPosition={x:0,y:0},i.offset={x:0,y:0},i.scale={x:1,y:1},i.wheelDelta=0,i.button=-1,i.pixelRatio=i.element.getAttribute("data-pixel-ratio")||1,i.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},i.mousemove=function(v){var r=t._getRelativeMousePosition(v,i.element,i.pixelRatio),a=v.changedTouches;a&&(i.button=0,v.preventDefault()),i.absolute.x=r.x,i.absolute.y=r.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y,i.sourceEvents.mousemove=v},i.mousedown=function(v){var r=t._getRelativeMousePosition(v,i.element,i.pixelRatio),a=v.changedTouches;a?(i.button=0,v.preventDefault()):i.button=v.button,i.absolute.x=r.x,i.absolute.y=r.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y,i.mousedownPosition.x=i.position.x,i.mousedownPosition.y=i.position.y,i.sourceEvents.mousedown=v},i.mouseup=function(v){var r=t._getRelativeMousePosition(v,i.element,i.pixelRatio),a=v.changedTouches;a&&v.preventDefault(),i.button=-1,i.absolute.x=r.x,i.absolute.y=r.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y,i.mouseupPosition.x=i.position.x,i.mouseupPosition.y=i.position.y,i.sourceEvents.mouseup=v},i.mousewheel=function(v){i.wheelDelta=Math.max(-1,Math.min(1,v.wheelDelta||-v.detail)),v.preventDefault()},t.setElement(i,i.element),i},t.setElement=function(o,i){o.element=i,i.addEventListener("mousemove",o.mousemove),i.addEventListener("mousedown",o.mousedown),i.addEventListener("mouseup",o.mouseup),i.addEventListener("mousewheel",o.mousewheel),i.addEventListener("DOMMouseScroll",o.mousewheel),i.addEventListener("touchmove",o.mousemove),i.addEventListener("touchstart",o.mousedown),i.addEventListener("touchend",o.mouseup)},t.clearSourceEvents=function(o){o.sourceEvents.mousemove=null,o.sourceEvents.mousedown=null,o.sourceEvents.mouseup=null,o.sourceEvents.mousewheel=null,o.wheelDelta=0},t.setOffset=function(o,i){o.offset.x=i.x,o.offset.y=i.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y},t.setScale=function(o,i){o.scale.x=i.x,o.scale.y=i.y,o.position.x=o.absolute.x*o.scale.x+o.offset.x,o.position.y=o.absolute.y*o.scale.y+o.offset.y},t._getRelativeMousePosition=function(o,i,v){var r=i.getBoundingClientRect(),a=document.documentElement||document.body.parentNode||document.body,s=window.pageXOffset!==void 0?window.pageXOffset:a.scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:a.scrollTop,n=o.changedTouches,c,l;return n?(c=n[0].pageX-r.left-s,l=n[0].pageY-r.top-e):(c=o.pageX-r.left-s,l=o.pageY-r.top-e),{x:c/(i.clientWidth/(i.width||i.clientWidth)*v),y:l/(i.clientHeight/(i.height||i.clientHeight)*v)}}})()},{"../core/Common":14}],20:[function(d,M,A){var t={};M.exports=t;var f=d("./Common");(function(){t._registry={},t.register=function(o){if(t.isPlugin(o)||f.warn("Plugin.register:",t.toString(o),"does not implement all required fields."),o.name in t._registry){var i=t._registry[o.name],v=t.versionParse(o.version).number,r=t.versionParse(i.version).number;v>r?(f.warn("Plugin.register:",t.toString(i),"was upgraded to",t.toString(o)),t._registry[o.name]=o):v<r?f.warn("Plugin.register:",t.toString(i),"can not be downgraded to",t.toString(o)):o!==i&&f.warn("Plugin.register:",t.toString(o),"is already registered to different plugin object")}else t._registry[o.name]=o;return o},t.resolve=function(o){return t._registry[t.dependencyParse(o).name]},t.toString=function(o){return typeof o=="string"?o:(o.name||"anonymous")+"@"+(o.version||o.range||"0.0.0")},t.isPlugin=function(o){return o&&o.name&&o.version&&o.install},t.isUsed=function(o,i){return o.used.indexOf(i)>-1},t.isFor=function(o,i){var v=o.for&&t.dependencyParse(o.for);return!o.for||i.name===v.name&&t.versionSatisfies(i.version,v.range)},t.use=function(o,i){if(o.uses=(o.uses||[]).concat(i||[]),o.uses.length===0){f.warn("Plugin.use:",t.toString(o),"does not specify any dependencies to install.");return}for(var v=t.dependencies(o),r=f.topologicalSort(v),a=[],s=0;s<r.length;s+=1)if(r[s]!==o.name){var e=t.resolve(r[s]);if(!e){a.push("❌ "+r[s]);continue}t.isUsed(o,e.name)||(t.isFor(e,o)||(f.warn("Plugin.use:",t.toString(e),"is for",e.for,"but installed on",t.toString(o)+"."),e._warned=!0),e.install?e.install(o):(f.warn("Plugin.use:",t.toString(e),"does not specify an install function."),e._warned=!0),e._warned?(a.push("🔶 "+t.toString(e)),delete e._warned):a.push("✅ "+t.toString(e)),o.used.push(e.name))}a.length>0&&f.info(a.join("  "))},t.dependencies=function(o,i){var v=t.dependencyParse(o),r=v.name;if(i=i||{},!(r in i)){o=t.resolve(o)||o,i[r]=f.map(o.uses||[],function(s){t.isPlugin(s)&&t.register(s);var e=t.dependencyParse(s),n=t.resolve(s);return n&&!t.versionSatisfies(n.version,e.range)?(f.warn("Plugin.dependencies:",t.toString(n),"does not satisfy",t.toString(e),"used by",t.toString(v)+"."),n._warned=!0,o._warned=!0):n||(f.warn("Plugin.dependencies:",t.toString(s),"used by",t.toString(v),"could not be resolved."),o._warned=!0),e.name});for(var a=0;a<i[r].length;a+=1)t.dependencies(i[r][a],i);return i}},t.dependencyParse=function(o){if(f.isString(o)){var i=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/;return i.test(o)||f.warn("Plugin.dependencyParse:",o,"is not a valid dependency string."),{name:o.split("@")[0],range:o.split("@")[1]||"*"}}return{name:o.name,range:o.range||o.version}},t.versionParse=function(o){var i=/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/;i.test(o)||f.warn("Plugin.versionParse:",o,"is not a valid version or range.");var v=o.split("-");o=v[0];var r=isNaN(Number(o[0])),a=r?o.substr(1):o,s=f.map(a.split("."),function(e){return Number(e)});return{isRange:r,version:a,range:o,operator:r?o[0]:"",parts:s,prerelease:v[1],number:s[0]*1e8+s[1]*1e4+s[2]}},t.versionSatisfies=function(o,i){i=i||"*";var v=t.versionParse(i),r=v.parts,a=t.versionParse(o),s=a.parts;if(v.isRange){if(v.operator==="*"||o==="*")return!0;if(v.operator==="~")return s[0]===r[0]&&s[1]===r[1]&&s[2]>=r[2];if(v.operator==="^")return r[0]>0?s[0]===r[0]&&a.number>=v.number:r[1]>0?s[1]===r[1]&&s[2]>=r[2]:s[2]===r[2]}return o===i||o==="*"}})()},{"./Common":14}],21:[function(d,M,A){var t={};M.exports=t;var f=d("./Events"),o=d("./Engine"),i=d("./Common");(function(){var v,r;if(typeof window<"u"&&(v=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,r=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!v){var a;v=function(s){a=setTimeout(function(){s(i.now())},1e3/60)},r=function(){clearTimeout(a)}}t.create=function(s){var e={fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},n=i.extend(e,s);return n.delta=n.delta||1e3/n.fps,n.deltaMin=n.deltaMin||1e3/n.fps,n.deltaMax=n.deltaMax||1e3/(n.fps*.5),n.fps=1e3/n.delta,n},t.run=function(s,e){return typeof s.positionIterations<"u"&&(e=s,s=t.create()),function n(c){s.frameRequestId=v(n),c&&s.enabled&&t.tick(s,e,c)}(),s},t.tick=function(s,e,n){var c=e.timing,l=1,m,x={timestamp:c.timestamp};f.trigger(s,"beforeTick",x),f.trigger(e,"beforeTick",x),s.isFixed?m=s.delta:(m=n-s.timePrev||s.delta,s.timePrev=n,s.deltaHistory.push(m),s.deltaHistory=s.deltaHistory.slice(-s.deltaSampleSize),m=Math.min.apply(null,s.deltaHistory),m=m<s.deltaMin?s.deltaMin:m,m=m>s.deltaMax?s.deltaMax:m,l=m/s.delta,s.delta=m),s.timeScalePrev!==0&&(l*=c.timeScale/s.timeScalePrev),c.timeScale===0&&(l=0),s.timeScalePrev=c.timeScale,s.correction=l,s.frameCounter+=1,n-s.counterTimestamp>=1e3&&(s.fps=s.frameCounter*((n-s.counterTimestamp)/1e3),s.counterTimestamp=n,s.frameCounter=0),f.trigger(s,"tick",x),f.trigger(e,"tick",x),e.world.isModified&&e.render&&e.render.controller&&e.render.controller.clear&&e.render.controller.clear(e.render),f.trigger(s,"beforeUpdate",x),o.update(e,m,l),f.trigger(s,"afterUpdate",x),e.render&&e.render.controller&&(f.trigger(s,"beforeRender",x),f.trigger(e,"beforeRender",x),e.render.controller.world(e.render),f.trigger(s,"afterRender",x),f.trigger(e,"afterRender",x)),f.trigger(s,"afterTick",x),f.trigger(e,"afterTick",x)},t.stop=function(s){r(s.frameRequestId)},t.start=function(s,e){t.run(s,e)}})()},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(d,M,A){var t={};M.exports=t;var f=d("./Events");(function(){t._motionWakeThreshold=.18,t._motionSleepThreshold=.08,t._minBias=.9,t.update=function(o,i){for(var v=i*i*i,r=0;r<o.length;r++){var a=o[r],s=a.speed*a.speed+a.angularSpeed*a.angularSpeed;if(a.force.x!==0||a.force.y!==0){t.set(a,!1);continue}var e=Math.min(a.motion,s),n=Math.max(a.motion,s);a.motion=t._minBias*e+(1-t._minBias)*n,a.sleepThreshold>0&&a.motion<t._motionSleepThreshold*v?(a.sleepCounter+=1,a.sleepCounter>=a.sleepThreshold&&t.set(a,!0)):a.sleepCounter>0&&(a.sleepCounter-=1)}},t.afterCollisions=function(o,i){for(var v=i*i*i,r=0;r<o.length;r++){var a=o[r];if(a.isActive){var s=a.collision,e=s.bodyA.parent,n=s.bodyB.parent;if(!(e.isSleeping&&n.isSleeping||e.isStatic||n.isStatic)&&(e.isSleeping||n.isSleeping)){var c=e.isSleeping&&!e.isStatic?e:n,l=c===e?n:e;!c.isStatic&&l.motion>t._motionWakeThreshold*v&&t.set(c,!1)}}}},t.set=function(o,i){var v=o.isSleeping;i?(o.isSleeping=!0,o.sleepCounter=o.sleepThreshold,o.positionImpulse.x=0,o.positionImpulse.y=0,o.positionPrev.x=o.position.x,o.positionPrev.y=o.position.y,o.anglePrev=o.angle,o.speed=0,o.angularSpeed=0,o.motion=0,v||f.trigger(o,"sleepStart")):(o.isSleeping=!1,o.sleepCounter=0,v&&f.trigger(o,"sleepEnd"))}})()},{"./Events":16}],23:[function(d,M,A){var t={};M.exports=t;var f=d("../geometry/Vertices"),o=d("../core/Common"),i=d("../body/Body"),v=d("../geometry/Bounds"),r=d("../geometry/Vector"),a;(function(){t.rectangle=function(s,e,n,c,l){l=l||{};var m={label:"Rectangle Body",position:{x:s,y:e},vertices:f.fromPath("L 0 0 L "+n+" 0 L "+n+" "+c+" L 0 "+c)};if(l.chamfer){var x=l.chamfer;m.vertices=f.chamfer(m.vertices,x.radius,x.quality,x.qualityMin,x.qualityMax),delete l.chamfer}return i.create(o.extend({},m,l))},t.trapezoid=function(s,e,n,c,l,m){m=m||{},l*=.5;var x=(1-l*2)*n,h=n*l,u=h+x,p=u+h,g;l<.5?g="L 0 0 L "+h+" "+-c+" L "+u+" "+-c+" L "+p+" 0":g="L 0 0 L "+u+" "+-c+" L "+p+" 0";var w={label:"Trapezoid Body",position:{x:s,y:e},vertices:f.fromPath(g)};if(m.chamfer){var y=m.chamfer;w.vertices=f.chamfer(w.vertices,y.radius,y.quality,y.qualityMin,y.qualityMax),delete m.chamfer}return i.create(o.extend({},w,m))},t.circle=function(s,e,n,c,l){c=c||{};var m={label:"Circle Body",circleRadius:n};l=l||25;var x=Math.ceil(Math.max(10,Math.min(l,n)));return x%2===1&&(x+=1),t.polygon(s,e,x,n,o.extend({},m,c))},t.polygon=function(s,e,n,c,l){if(l=l||{},n<3)return t.circle(s,e,c,l);for(var m=2*Math.PI/n,x="",h=m*.5,u=0;u<n;u+=1){var p=h+u*m,g=Math.cos(p)*c,w=Math.sin(p)*c;x+="L "+g.toFixed(3)+" "+w.toFixed(3)+" "}var y={label:"Polygon Body",position:{x:s,y:e},vertices:f.fromPath(x)};if(l.chamfer){var C=l.chamfer;y.vertices=f.chamfer(y.vertices,C.radius,C.quality,C.qualityMin,C.qualityMax),delete l.chamfer}return i.create(o.extend({},y,l))},t.fromVertices=function(s,e,n,c,l,m,x){a||(a=o._requireGlobal("decomp","poly-decomp"));var h,u,p,g,w,y,C,P,I;for(c=c||{},u=[],l=typeof l<"u"?l:!1,m=typeof m<"u"?m:.01,x=typeof x<"u"?x:10,a||o.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),o.isArray(n[0])||(n=[n]),P=0;P<n.length;P+=1)if(g=n[P],p=f.isConvex(g),p||!a)p?g=f.clockwiseSort(g):g=f.hull(g),u.push({position:{x:s,y:e},vertices:g});else{var B=g.map(function(H){return[H.x,H.y]});a.makeCCW(B),m!==!1&&a.removeCollinearPoints(B,m);var k=a.quickDecomp(B);for(w=0;w<k.length;w++){var T=k[w],E=T.map(function(H){return{x:H[0],y:H[1]}});x>0&&f.area(E)<x||u.push({position:f.centre(E),vertices:E})}}for(w=0;w<u.length;w++)u[w]=i.create(o.extend(u[w],c));if(l){var b=5;for(w=0;w<u.length;w++){var R=u[w];for(y=w+1;y<u.length;y++){var F=u[y];if(v.overlaps(R.bounds,F.bounds)){var V=R.vertices,D=F.vertices;for(C=0;C<R.vertices.length;C++)for(I=0;I<F.vertices.length;I++){var W=r.magnitudeSquared(r.sub(V[(C+1)%V.length],D[I])),U=r.magnitudeSquared(r.sub(V[C],D[(I+1)%D.length]));W<b&&U<b&&(V[C].isInternal=!0,D[I].isInternal=!0)}}}}}return u.length>1?(h=i.create(o.extend({parts:u.slice(0)},c)),i.setPosition(h,{x:s,y:e}),h):u[0]}})()},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(d,M,A){var t={};M.exports=t;var f=d("../body/Composite"),o=d("../constraint/Constraint"),i=d("../core/Common"),v=d("../body/Body"),r=d("./Bodies");(function(){t.stack=function(a,s,e,n,c,l,m){for(var x=f.create({label:"Stack"}),h=a,u=s,p,g=0,w=0;w<n;w++){for(var y=0,C=0;C<e;C++){var P=m(h,u,C,w,p,g);if(P){var I=P.bounds.max.y-P.bounds.min.y,B=P.bounds.max.x-P.bounds.min.x;I>y&&(y=I),v.translate(P,{x:B*.5,y:I*.5}),h=P.bounds.max.x+c,f.addBody(x,P),p=P,g+=1}else h+=c}u+=y+l,h=a}return x},t.chain=function(a,s,e,n,c,l){for(var m=a.bodies,x=1;x<m.length;x++){var h=m[x-1],u=m[x],p=h.bounds.max.y-h.bounds.min.y,g=h.bounds.max.x-h.bounds.min.x,w=u.bounds.max.y-u.bounds.min.y,y=u.bounds.max.x-u.bounds.min.x,C={bodyA:h,pointA:{x:g*s,y:p*e},bodyB:u,pointB:{x:y*n,y:w*c}},P=i.extend(C,l);f.addConstraint(a,o.create(P))}return a.label+=" Chain",a},t.mesh=function(a,s,e,n,c){var l=a.bodies,m,x,h,u,p;for(m=0;m<e;m++){for(x=1;x<s;x++)h=l[x-1+m*s],u=l[x+m*s],f.addConstraint(a,o.create(i.extend({bodyA:h,bodyB:u},c)));if(m>0)for(x=0;x<s;x++)h=l[x+(m-1)*s],u=l[x+m*s],f.addConstraint(a,o.create(i.extend({bodyA:h,bodyB:u},c))),n&&x>0&&(p=l[x-1+(m-1)*s],f.addConstraint(a,o.create(i.extend({bodyA:p,bodyB:u},c)))),n&&x<s-1&&(p=l[x+1+(m-1)*s],f.addConstraint(a,o.create(i.extend({bodyA:p,bodyB:u},c))))}return a.label+=" Mesh",a},t.pyramid=function(a,s,e,n,c,l,m){return t.stack(a,s,e,n,c,l,function(x,h,u,p,g,w){var y=Math.min(n,Math.ceil(e/2)),C=g?g.bounds.max.x-g.bounds.min.x:0;if(!(p>y)){p=y-p;var P=p,I=e-1-p;if(!(u<P||u>I)){w===1&&v.translate(g,{x:(u+(e%2===1?1:-1))*C,y:0});var B=g?u*C:0;return m(a+B+u*c,h,u,p,g,w)}}})},t.newtonsCradle=function(a,s,e,n,c){for(var l=f.create({label:"Newtons Cradle"}),m=0;m<e;m++){var x=1.9,h=r.circle(a+m*(n*x),s+c,n,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),u=o.create({pointA:{x:a+m*(n*x),y:s},bodyB:h});f.addBody(l,h),f.addConstraint(l,u)}return l},t.car=function(a,s,e,n,c){var l=v.nextGroup(!0),m=20,x=-e*.5+m,h=e*.5-m,u=0,p=f.create({label:"Car"}),g=r.rectangle(a,s,e,n,{collisionFilter:{group:l},chamfer:{radius:n*.5},density:2e-4}),w=r.circle(a+x,s+u,c,{collisionFilter:{group:l},friction:.8}),y=r.circle(a+h,s+u,c,{collisionFilter:{group:l},friction:.8}),C=o.create({bodyB:g,pointB:{x,y:u},bodyA:w,stiffness:1,length:0}),P=o.create({bodyB:g,pointB:{x:h,y:u},bodyA:y,stiffness:1,length:0});return f.addBody(p,g),f.addBody(p,w),f.addBody(p,y),f.addConstraint(p,C),f.addConstraint(p,P),p},t.softBody=function(a,s,e,n,c,l,m,x,h,u){h=i.extend({inertia:1/0},h),u=i.extend({stiffness:.2,render:{type:"line",anchors:!1}},u);var p=t.stack(a,s,e,n,c,l,function(g,w){return r.circle(g,w,x,h)});return t.mesh(p,e,n,m,u),p.label="Soft Body",p}})()},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(d,M,A){var t={};M.exports=t;var f=d("../geometry/Vector"),o=d("../core/Common");(function(){t.fromVertices=function(i){for(var v={},r=0;r<i.length;r++){var a=(r+1)%i.length,s=f.normalise({x:i[a].y-i[r].y,y:i[r].x-i[a].x}),e=s.y===0?1/0:s.x/s.y;e=e.toFixed(3).toString(),v[e]=s}return o.values(v)},t.rotate=function(i,v){if(v!==0)for(var r=Math.cos(v),a=Math.sin(v),s=0;s<i.length;s++){var e=i[s],n;n=e.x*r-e.y*a,e.y=e.x*a+e.y*r,e.x=n}}})()},{"../core/Common":14,"../geometry/Vector":28}],26:[function(d,M,A){var t={};M.exports=t,function(){t.create=function(f){var o={min:{x:0,y:0},max:{x:0,y:0}};return f&&t.update(o,f),o},t.update=function(f,o,i){f.min.x=1/0,f.max.x=-1/0,f.min.y=1/0,f.max.y=-1/0;for(var v=0;v<o.length;v++){var r=o[v];r.x>f.max.x&&(f.max.x=r.x),r.x<f.min.x&&(f.min.x=r.x),r.y>f.max.y&&(f.max.y=r.y),r.y<f.min.y&&(f.min.y=r.y)}i&&(i.x>0?f.max.x+=i.x:f.min.x+=i.x,i.y>0?f.max.y+=i.y:f.min.y+=i.y)},t.contains=function(f,o){return o.x>=f.min.x&&o.x<=f.max.x&&o.y>=f.min.y&&o.y<=f.max.y},t.overlaps=function(f,o){return f.min.x<=o.max.x&&f.max.x>=o.min.x&&f.max.y>=o.min.y&&f.min.y<=o.max.y},t.translate=function(f,o){f.min.x+=o.x,f.max.x+=o.x,f.min.y+=o.y,f.max.y+=o.y},t.shift=function(f,o){var i=f.max.x-f.min.x,v=f.max.y-f.min.y;f.min.x=o.x,f.max.x=o.x+i,f.min.y=o.y,f.max.y=o.y+v}}()},{}],27:[function(d,M,A){var t={};M.exports=t,d("../geometry/Bounds");var f=d("../core/Common");(function(){t.pathToVertices=function(o,i){typeof window<"u"&&!("SVGPathSeg"in window)&&f.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var v,r,a,s,e,n,c,l,m,x,h=[],u,p,g=0,w=0,y=0;i=i||15;var C=function(I,B,k){var T=k%2===1&&k>1;if(!m||I!=m.x||B!=m.y){m&&T?(u=m.x,p=m.y):(u=0,p=0);var E={x:u+I,y:p+B};(T||!m)&&(m=E),h.push(E),w=u+I,y=p+B}},P=function(I){var B=I.pathSegTypeAsLetter.toUpperCase();if(B!=="Z"){switch(B){case"M":case"L":case"T":case"C":case"S":case"Q":w=I.x,y=I.y;break;case"H":w=I.x;break;case"V":y=I.y;break}C(w,y,I.pathSegType)}};for(t._svgPathToAbsolute(o),a=o.getTotalLength(),n=[],v=0;v<o.pathSegList.numberOfItems;v+=1)n.push(o.pathSegList.getItem(v));for(c=n.concat();g<a;){if(x=o.getPathSegAtLength(g),e=n[x],e!=l){for(;c.length&&c[0]!=e;)P(c.shift());l=e}switch(e.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":s=o.getPointAtLength(g),C(s.x,s.y,0);break}g+=i}for(v=0,r=c.length;v<r;++v)P(c[v]);return h},t._svgPathToAbsolute=function(o){for(var i,v,r,a,s,e,n=o.pathSegList,c=0,l=0,m=n.numberOfItems,x=0;x<m;++x){var h=n.getItem(x),u=h.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(u))"x"in h&&(c=h.x),"y"in h&&(l=h.y);else switch("x1"in h&&(r=c+h.x1),"x2"in h&&(s=c+h.x2),"y1"in h&&(a=l+h.y1),"y2"in h&&(e=l+h.y2),"x"in h&&(c+=h.x),"y"in h&&(l+=h.y),u){case"m":n.replaceItem(o.createSVGPathSegMovetoAbs(c,l),x);break;case"l":n.replaceItem(o.createSVGPathSegLinetoAbs(c,l),x);break;case"h":n.replaceItem(o.createSVGPathSegLinetoHorizontalAbs(c),x);break;case"v":n.replaceItem(o.createSVGPathSegLinetoVerticalAbs(l),x);break;case"c":n.replaceItem(o.createSVGPathSegCurvetoCubicAbs(c,l,r,a,s,e),x);break;case"s":n.replaceItem(o.createSVGPathSegCurvetoCubicSmoothAbs(c,l,s,e),x);break;case"q":n.replaceItem(o.createSVGPathSegCurvetoQuadraticAbs(c,l,r,a),x);break;case"t":n.replaceItem(o.createSVGPathSegCurvetoQuadraticSmoothAbs(c,l),x);break;case"a":n.replaceItem(o.createSVGPathSegArcAbs(c,l,h.r1,h.r2,h.angle,h.largeArcFlag,h.sweepFlag),x);break;case"z":case"Z":c=i,l=v;break}(u=="M"||u=="m")&&(i=c,v=l)}}})()},{"../core/Common":14,"../geometry/Bounds":26}],28:[function(d,M,A){var t={};M.exports=t,function(){t.create=function(f,o){return{x:f||0,y:o||0}},t.clone=function(f){return{x:f.x,y:f.y}},t.magnitude=function(f){return Math.sqrt(f.x*f.x+f.y*f.y)},t.magnitudeSquared=function(f){return f.x*f.x+f.y*f.y},t.rotate=function(f,o,i){var v=Math.cos(o),r=Math.sin(o);i||(i={});var a=f.x*v-f.y*r;return i.y=f.x*r+f.y*v,i.x=a,i},t.rotateAbout=function(f,o,i,v){var r=Math.cos(o),a=Math.sin(o);v||(v={});var s=i.x+((f.x-i.x)*r-(f.y-i.y)*a);return v.y=i.y+((f.x-i.x)*a+(f.y-i.y)*r),v.x=s,v},t.normalise=function(f){var o=t.magnitude(f);return o===0?{x:0,y:0}:{x:f.x/o,y:f.y/o}},t.dot=function(f,o){return f.x*o.x+f.y*o.y},t.cross=function(f,o){return f.x*o.y-f.y*o.x},t.cross3=function(f,o,i){return(o.x-f.x)*(i.y-f.y)-(o.y-f.y)*(i.x-f.x)},t.add=function(f,o,i){return i||(i={}),i.x=f.x+o.x,i.y=f.y+o.y,i},t.sub=function(f,o,i){return i||(i={}),i.x=f.x-o.x,i.y=f.y-o.y,i},t.mult=function(f,o){return{x:f.x*o,y:f.y*o}},t.div=function(f,o){return{x:f.x/o,y:f.y/o}},t.perp=function(f,o){return o=o===!0?-1:1,{x:o*-f.y,y:o*f.x}},t.neg=function(f){return{x:-f.x,y:-f.y}},t.angle=function(f,o){return Math.atan2(o.y-f.y,o.x-f.x)},t._temp=[t.create(),t.create(),t.create(),t.create(),t.create(),t.create()]}()},{}],29:[function(d,M,A){var t={};M.exports=t;var f=d("../geometry/Vector"),o=d("../core/Common");(function(){t.create=function(i,v){for(var r=[],a=0;a<i.length;a++){var s=i[a],e={x:s.x,y:s.y,index:a,body:v,isInternal:!1};r.push(e)}return r},t.fromPath=function(i,v){var r=/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/ig,a=[];return i.replace(r,function(s,e,n){a.push({x:parseFloat(e),y:parseFloat(n)})}),t.create(a,v)},t.centre=function(i){for(var v=t.area(i,!0),r={x:0,y:0},a,s,e,n=0;n<i.length;n++)e=(n+1)%i.length,a=f.cross(i[n],i[e]),s=f.mult(f.add(i[n],i[e]),a),r=f.add(r,s);return f.div(r,6*v)},t.mean=function(i){for(var v={x:0,y:0},r=0;r<i.length;r++)v.x+=i[r].x,v.y+=i[r].y;return f.div(v,i.length)},t.area=function(i,v){for(var r=0,a=i.length-1,s=0;s<i.length;s++)r+=(i[a].x-i[s].x)*(i[a].y+i[s].y),a=s;return v?r/2:Math.abs(r)/2},t.inertia=function(i,v){for(var r=0,a=0,s=i,e,n,c=0;c<s.length;c++)n=(c+1)%s.length,e=Math.abs(f.cross(s[n],s[c])),r+=e*(f.dot(s[n],s[n])+f.dot(s[n],s[c])+f.dot(s[c],s[c])),a+=e;return v/6*(r/a)},t.translate=function(i,v,r){var a;if(r)for(a=0;a<i.length;a++)i[a].x+=v.x*r,i[a].y+=v.y*r;else for(a=0;a<i.length;a++)i[a].x+=v.x,i[a].y+=v.y;return i},t.rotate=function(i,v,r){if(v!==0){for(var a=Math.cos(v),s=Math.sin(v),e=0;e<i.length;e++){var n=i[e],c=n.x-r.x,l=n.y-r.y;n.x=r.x+(c*a-l*s),n.y=r.y+(c*s+l*a)}return i}},t.contains=function(i,v){for(var r=0;r<i.length;r++){var a=i[r],s=i[(r+1)%i.length];if((v.x-a.x)*(s.y-a.y)+(v.y-a.y)*(a.x-s.x)>0)return!1}return!0},t.scale=function(i,v,r,a){if(v===1&&r===1)return i;a=a||t.centre(i);for(var s,e,n=0;n<i.length;n++)s=i[n],e=f.sub(s,a),i[n].x=a.x+e.x*v,i[n].y=a.y+e.y*r;return i},t.chamfer=function(i,v,r,a,s){typeof v=="number"?v=[v]:v=v||[8],r=typeof r<"u"?r:-1,a=a||2,s=s||14;for(var e=[],n=0;n<i.length;n++){var c=i[n-1>=0?n-1:i.length-1],l=i[n],m=i[(n+1)%i.length],x=v[n<v.length?n:v.length-1];if(x===0){e.push(l);continue}var h=f.normalise({x:l.y-c.y,y:c.x-l.x}),u=f.normalise({x:m.y-l.y,y:l.x-m.x}),p=Math.sqrt(2*Math.pow(x,2)),g=f.mult(o.clone(h),x),w=f.normalise(f.mult(f.add(h,u),.5)),y=f.sub(l,f.mult(w,p)),C=r;r===-1&&(C=Math.pow(x,.32)*1.75),C=o.clamp(C,a,s),C%2===1&&(C+=1);for(var P=Math.acos(f.dot(h,u)),I=P/C,B=0;B<C;B++)e.push(f.add(f.rotate(g,I*B),y))}return e},t.clockwiseSort=function(i){var v=t.mean(i);return i.sort(function(r,a){return f.angle(v,r)-f.angle(v,a)}),i},t.isConvex=function(i){var v=0,r=i.length,a,s,e,n;if(r<3)return null;for(a=0;a<r;a++)if(s=(a+1)%r,e=(a+2)%r,n=(i[s].x-i[a].x)*(i[e].y-i[s].y),n-=(i[s].y-i[a].y)*(i[e].x-i[s].x),n<0?v|=1:n>0&&(v|=2),v===3)return!1;return v!==0?!0:null},t.hull=function(i){var v=[],r=[],a,s;for(i=i.slice(0),i.sort(function(e,n){var c=e.x-n.x;return c!==0?c:e.y-n.y}),s=0;s<i.length;s+=1){for(a=i[s];r.length>=2&&f.cross3(r[r.length-2],r[r.length-1],a)<=0;)r.pop();r.push(a)}for(s=i.length-1;s>=0;s-=1){for(a=i[s];v.length>=2&&f.cross3(v[v.length-2],v[v.length-1],a)<=0;)v.pop();v.push(a)}return v.pop(),r.pop(),v.concat(r)}})()},{"../core/Common":14,"../geometry/Vector":28}],30:[function(d,M,A){var t=M.exports=d("../core/Matter");t.Body=d("../body/Body"),t.Composite=d("../body/Composite"),t.World=d("../body/World"),t.Contact=d("../collision/Contact"),t.Detector=d("../collision/Detector"),t.Grid=d("../collision/Grid"),t.Pairs=d("../collision/Pairs"),t.Pair=d("../collision/Pair"),t.Query=d("../collision/Query"),t.Resolver=d("../collision/Resolver"),t.SAT=d("../collision/SAT"),t.Constraint=d("../constraint/Constraint"),t.MouseConstraint=d("../constraint/MouseConstraint"),t.Common=d("../core/Common"),t.Engine=d("../core/Engine"),t.Events=d("../core/Events"),t.Mouse=d("../core/Mouse"),t.Runner=d("../core/Runner"),t.Sleeping=d("../core/Sleeping"),t.Plugin=d("../core/Plugin"),t.Bodies=d("../factory/Bodies"),t.Composites=d("../factory/Composites"),t.Axes=d("../geometry/Axes"),t.Bounds=d("../geometry/Bounds"),t.Svg=d("../geometry/Svg"),t.Vector=d("../geometry/Vector"),t.Vertices=d("../geometry/Vertices"),t.Render=d("../render/Render"),t.RenderPixi=d("../render/RenderPixi"),t.World.add=t.Composite.add,t.World.remove=t.Composite.remove,t.World.addComposite=t.Composite.addComposite,t.World.addBody=t.Composite.addBody,t.World.addConstraint=t.Composite.addConstraint,t.World.clear=t.Composite.clear,t.Engine.run=t.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(d,M,A){var t={};M.exports=t;var f=d("../core/Common"),o=d("../body/Composite"),i=d("../geometry/Bounds"),v=d("../core/Events"),r=d("../collision/Grid"),a=d("../geometry/Vector"),s=d("../core/Mouse");(function(){var e,n;typeof window<"u"&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(h){window.setTimeout(function(){h(f.now())},1e3/60)},n=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),t.create=function(h){var u={controller:t,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!h.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},p=f.extend(u,h);return p.canvas&&(p.canvas.width=p.options.width||p.canvas.width,p.canvas.height=p.options.height||p.canvas.height),p.mouse=h.mouse,p.engine=h.engine,p.canvas=p.canvas||c(p.options.width,p.options.height),p.context=p.canvas.getContext("2d"),p.textures={},p.bounds=p.bounds||{min:{x:0,y:0},max:{x:p.canvas.width,y:p.canvas.height}},p.options.pixelRatio!==1&&t.setPixelRatio(p,p.options.pixelRatio),f.isElement(p.element)?p.element.appendChild(p.canvas):p.canvas.parentNode||f.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),p},t.run=function(h){(function u(p){h.frameRequestId=e(u),t.world(h)})()},t.stop=function(h){n(h.frameRequestId)},t.setPixelRatio=function(h,u){var p=h.options,g=h.canvas;u==="auto"&&(u=l(g)),p.pixelRatio=u,g.setAttribute("data-pixel-ratio",u),g.width=p.width*u,g.height=p.height*u,g.style.width=p.width+"px",g.style.height=p.height+"px",h.context.scale(u,u)},t.lookAt=function(h,u,p,g){g=typeof g<"u"?g:!0,u=f.isArray(u)?u:[u],p=p||{x:0,y:0};for(var w={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},y=0;y<u.length;y+=1){var C=u[y],P=C.bounds?C.bounds.min:C.min||C.position||C,I=C.bounds?C.bounds.max:C.max||C.position||C;P&&I&&(P.x<w.min.x&&(w.min.x=P.x),I.x>w.max.x&&(w.max.x=I.x),P.y<w.min.y&&(w.min.y=P.y),I.y>w.max.y&&(w.max.y=I.y))}var B=w.max.x-w.min.x+2*p.x,k=w.max.y-w.min.y+2*p.y,T=h.canvas.height,E=h.canvas.width,b=E/T,R=B/k,F=1,V=1;R>b?V=R/b:F=b/R,h.options.hasBounds=!0,h.bounds.min.x=w.min.x,h.bounds.max.x=w.min.x+B*F,h.bounds.min.y=w.min.y,h.bounds.max.y=w.min.y+k*V,g&&(h.bounds.min.x+=B*.5-B*F*.5,h.bounds.max.x+=B*.5-B*F*.5,h.bounds.min.y+=k*.5-k*V*.5,h.bounds.max.y+=k*.5-k*V*.5),h.bounds.min.x-=p.x,h.bounds.max.x-=p.x,h.bounds.min.y-=p.y,h.bounds.max.y-=p.y,h.mouse&&(s.setScale(h.mouse,{x:(h.bounds.max.x-h.bounds.min.x)/h.canvas.width,y:(h.bounds.max.y-h.bounds.min.y)/h.canvas.height}),s.setOffset(h.mouse,h.bounds.min))},t.startViewTransform=function(h){var u=h.bounds.max.x-h.bounds.min.x,p=h.bounds.max.y-h.bounds.min.y,g=u/h.options.width,w=p/h.options.height;h.context.scale(1/g,1/w),h.context.translate(-h.bounds.min.x,-h.bounds.min.y)},t.endViewTransform=function(h){h.context.setTransform(h.options.pixelRatio,0,0,h.options.pixelRatio,0,0)},t.world=function(h){var u=h.engine,p=u.world,g=h.canvas,w=h.context,y=h.options,C=o.allBodies(p),P=o.allConstraints(p),I=y.wireframes?y.wireframeBackground:y.background,B=[],k=[],T,E={timestamp:u.timing.timestamp};if(v.trigger(h,"beforeRender",E),h.currentBackground!==I&&x(h,I),w.globalCompositeOperation="source-in",w.fillStyle="transparent",w.fillRect(0,0,g.width,g.height),w.globalCompositeOperation="source-over",y.hasBounds){for(T=0;T<C.length;T++){var b=C[T];i.overlaps(b.bounds,h.bounds)&&B.push(b)}for(T=0;T<P.length;T++){var R=P[T],F=R.bodyA,V=R.bodyB,D=R.pointA,W=R.pointB;F&&(D=a.add(F.position,R.pointA)),V&&(W=a.add(V.position,R.pointB)),!(!D||!W)&&(i.contains(h.bounds,D)||i.contains(h.bounds,W))&&k.push(R)}t.startViewTransform(h),h.mouse&&(s.setScale(h.mouse,{x:(h.bounds.max.x-h.bounds.min.x)/h.canvas.width,y:(h.bounds.max.y-h.bounds.min.y)/h.canvas.height}),s.setOffset(h.mouse,h.bounds.min))}else k=P,B=C;!y.wireframes||u.enableSleeping&&y.showSleeping?t.bodies(h,B,w):(y.showConvexHulls&&t.bodyConvexHulls(h,B,w),t.bodyWireframes(h,B,w)),y.showBounds&&t.bodyBounds(h,B,w),(y.showAxes||y.showAngleIndicator)&&t.bodyAxes(h,B,w),y.showPositions&&t.bodyPositions(h,B,w),y.showVelocity&&t.bodyVelocity(h,B,w),y.showIds&&t.bodyIds(h,B,w),y.showSeparations&&t.separations(h,u.pairs.list,w),y.showCollisions&&t.collisions(h,u.pairs.list,w),y.showVertexNumbers&&t.vertexNumbers(h,B,w),y.showMousePosition&&t.mousePosition(h,h.mouse,w),t.constraints(k,w),y.showBroadphase&&u.broadphase.controller===r&&t.grid(h,u.broadphase,w),y.showDebug&&t.debug(h,w),y.hasBounds&&t.endViewTransform(h),v.trigger(h,"afterRender",E)},t.debug=function(h,u){var p=u,g=h.engine,w=g.world,y=g.metrics,C=h.options;o.allBodies(w);var P="    ";if(g.timing.timestamp-(h.debugTimestamp||0)>=500){var I="";y.timing&&(I+="fps: "+Math.round(y.timing.fps)+P),h.debugString=I,h.debugTimestamp=g.timing.timestamp}if(h.debugString){p.font="12px Arial",C.wireframes?p.fillStyle="rgba(255,255,255,0.5)":p.fillStyle="rgba(0,0,0,0.5)";for(var B=h.debugString.split(`
`),k=0;k<B.length;k++)p.fillText(B[k],50,50+k*18)}},t.constraints=function(h,u){for(var p=u,g=0;g<h.length;g++){var w=h[g];if(!(!w.render.visible||!w.pointA||!w.pointB)){var y=w.bodyA,C=w.bodyB,P,I;if(y?P=a.add(y.position,w.pointA):P=w.pointA,w.render.type==="pin")p.beginPath(),p.arc(P.x,P.y,3,0,2*Math.PI),p.closePath();else{if(C?I=a.add(C.position,w.pointB):I=w.pointB,p.beginPath(),p.moveTo(P.x,P.y),w.render.type==="spring")for(var B=a.sub(I,P),k=a.perp(a.normalise(B)),T=Math.ceil(f.clamp(w.length/5,12,20)),E,b=1;b<T;b+=1)E=b%2===0?1:-1,p.lineTo(P.x+B.x*(b/T)+k.x*E*4,P.y+B.y*(b/T)+k.y*E*4);p.lineTo(I.x,I.y)}w.render.lineWidth&&(p.lineWidth=w.render.lineWidth,p.strokeStyle=w.render.strokeStyle,p.stroke()),w.render.anchors&&(p.fillStyle=w.render.strokeStyle,p.beginPath(),p.arc(P.x,P.y,3,0,2*Math.PI),p.arc(I.x,I.y,3,0,2*Math.PI),p.closePath(),p.fill())}}},t.bodyShadows=function(h,u,p){var g=p;h.engine;for(var w=0;w<u.length;w++){var y=u[w];if(y.render.visible){if(y.circleRadius)g.beginPath(),g.arc(y.position.x,y.position.y,y.circleRadius,0,2*Math.PI),g.closePath();else{g.beginPath(),g.moveTo(y.vertices[0].x,y.vertices[0].y);for(var C=1;C<y.vertices.length;C++)g.lineTo(y.vertices[C].x,y.vertices[C].y);g.closePath()}var P=y.position.x-h.options.width*.5,I=y.position.y-h.options.height*.2,B=Math.abs(P)+Math.abs(I);g.shadowColor="rgba(0,0,0,0.15)",g.shadowOffsetX=.05*P,g.shadowOffsetY=.05*I,g.shadowBlur=1+12*Math.min(1,B/1e3),g.fill(),g.shadowColor=null,g.shadowOffsetX=null,g.shadowOffsetY=null,g.shadowBlur=null}}},t.bodies=function(h,u,p){var g=p;h.engine;var w=h.options,y=w.showInternalEdges||!w.wireframes,C,P,I,B;for(I=0;I<u.length;I++)if(C=u[I],!!C.render.visible){for(B=C.parts.length>1?1:0;B<C.parts.length;B++)if(P=C.parts[B],!!P.render.visible){if(w.showSleeping&&C.isSleeping?g.globalAlpha=.5*P.render.opacity:P.render.opacity!==1&&(g.globalAlpha=P.render.opacity),P.render.sprite&&P.render.sprite.texture&&!w.wireframes){var k=P.render.sprite,T=m(h,k.texture);g.translate(P.position.x,P.position.y),g.rotate(P.angle),g.drawImage(T,T.width*-k.xOffset*k.xScale,T.height*-k.yOffset*k.yScale,T.width*k.xScale,T.height*k.yScale),g.rotate(-P.angle),g.translate(-P.position.x,-P.position.y)}else{if(P.circleRadius)g.beginPath(),g.arc(P.position.x,P.position.y,P.circleRadius,0,2*Math.PI);else{g.beginPath(),g.moveTo(P.vertices[0].x,P.vertices[0].y);for(var E=1;E<P.vertices.length;E++)!P.vertices[E-1].isInternal||y?g.lineTo(P.vertices[E].x,P.vertices[E].y):g.moveTo(P.vertices[E].x,P.vertices[E].y),P.vertices[E].isInternal&&!y&&g.moveTo(P.vertices[(E+1)%P.vertices.length].x,P.vertices[(E+1)%P.vertices.length].y);g.lineTo(P.vertices[0].x,P.vertices[0].y),g.closePath()}w.wireframes?(g.lineWidth=1,g.strokeStyle="#bbb",g.stroke()):(g.fillStyle=P.render.fillStyle,P.render.lineWidth&&(g.lineWidth=P.render.lineWidth,g.strokeStyle=P.render.strokeStyle,g.stroke()),g.fill())}g.globalAlpha=1}}},t.bodyWireframes=function(h,u,p){var g=p,w=h.options.showInternalEdges,y,C,P,I,B;for(g.beginPath(),P=0;P<u.length;P++)if(y=u[P],!!y.render.visible)for(B=y.parts.length>1?1:0;B<y.parts.length;B++){for(C=y.parts[B],g.moveTo(C.vertices[0].x,C.vertices[0].y),I=1;I<C.vertices.length;I++)!C.vertices[I-1].isInternal||w?g.lineTo(C.vertices[I].x,C.vertices[I].y):g.moveTo(C.vertices[I].x,C.vertices[I].y),C.vertices[I].isInternal&&!w&&g.moveTo(C.vertices[(I+1)%C.vertices.length].x,C.vertices[(I+1)%C.vertices.length].y);g.lineTo(C.vertices[0].x,C.vertices[0].y)}g.lineWidth=1,g.strokeStyle="#bbb",g.stroke()},t.bodyConvexHulls=function(h,u,p){var g=p,w,y,C;for(g.beginPath(),y=0;y<u.length;y++)if(w=u[y],!(!w.render.visible||w.parts.length===1)){for(g.moveTo(w.vertices[0].x,w.vertices[0].y),C=1;C<w.vertices.length;C++)g.lineTo(w.vertices[C].x,w.vertices[C].y);g.lineTo(w.vertices[0].x,w.vertices[0].y)}g.lineWidth=1,g.strokeStyle="rgba(255,255,255,0.2)",g.stroke()},t.vertexNumbers=function(h,u,p){var g=p,w,y,C;for(w=0;w<u.length;w++){var P=u[w].parts;for(C=P.length>1?1:0;C<P.length;C++){var I=P[C];for(y=0;y<I.vertices.length;y++)g.fillStyle="rgba(255,255,255,0.2)",g.fillText(w+"_"+y,I.position.x+(I.vertices[y].x-I.position.x)*.8,I.position.y+(I.vertices[y].y-I.position.y)*.8)}}},t.mousePosition=function(h,u,p){var g=p;g.fillStyle="rgba(255,255,255,0.8)",g.fillText(u.position.x+"  "+u.position.y,u.position.x+5,u.position.y-5)},t.bodyBounds=function(h,u,p){var g=p;h.engine;var w=h.options;g.beginPath();for(var y=0;y<u.length;y++){var C=u[y];if(C.render.visible)for(var P=u[y].parts,I=P.length>1?1:0;I<P.length;I++){var B=P[I];g.rect(B.bounds.min.x,B.bounds.min.y,B.bounds.max.x-B.bounds.min.x,B.bounds.max.y-B.bounds.min.y)}}w.wireframes?g.strokeStyle="rgba(255,255,255,0.08)":g.strokeStyle="rgba(0,0,0,0.1)",g.lineWidth=1,g.stroke()},t.bodyAxes=function(h,u,p){var g=p;h.engine;var w=h.options,y,C,P,I;for(g.beginPath(),C=0;C<u.length;C++){var B=u[C],k=B.parts;if(B.render.visible)if(w.showAxes)for(P=k.length>1?1:0;P<k.length;P++)for(y=k[P],I=0;I<y.axes.length;I++){var T=y.axes[I];g.moveTo(y.position.x,y.position.y),g.lineTo(y.position.x+T.x*20,y.position.y+T.y*20)}else for(P=k.length>1?1:0;P<k.length;P++)for(y=k[P],I=0;I<y.axes.length;I++)g.moveTo(y.position.x,y.position.y),g.lineTo((y.vertices[0].x+y.vertices[y.vertices.length-1].x)/2,(y.vertices[0].y+y.vertices[y.vertices.length-1].y)/2)}w.wireframes?(g.strokeStyle="indianred",g.lineWidth=1):(g.strokeStyle="rgba(255, 255, 255, 0.4)",g.globalCompositeOperation="overlay",g.lineWidth=2),g.stroke(),g.globalCompositeOperation="source-over"},t.bodyPositions=function(h,u,p){var g=p;h.engine;var w=h.options,y,C,P,I;for(g.beginPath(),P=0;P<u.length;P++)if(y=u[P],!!y.render.visible)for(I=0;I<y.parts.length;I++)C=y.parts[I],g.arc(C.position.x,C.position.y,3,0,2*Math.PI,!1),g.closePath();for(w.wireframes?g.fillStyle="indianred":g.fillStyle="rgba(0,0,0,0.5)",g.fill(),g.beginPath(),P=0;P<u.length;P++)y=u[P],y.render.visible&&(g.arc(y.positionPrev.x,y.positionPrev.y,2,0,2*Math.PI,!1),g.closePath());g.fillStyle="rgba(255,165,0,0.8)",g.fill()},t.bodyVelocity=function(h,u,p){var g=p;g.beginPath();for(var w=0;w<u.length;w++){var y=u[w];y.render.visible&&(g.moveTo(y.position.x,y.position.y),g.lineTo(y.position.x+(y.position.x-y.positionPrev.x)*2,y.position.y+(y.position.y-y.positionPrev.y)*2))}g.lineWidth=3,g.strokeStyle="cornflowerblue",g.stroke()},t.bodyIds=function(h,u,p){var g=p,w,y;for(w=0;w<u.length;w++)if(u[w].render.visible){var C=u[w].parts;for(y=C.length>1?1:0;y<C.length;y++){var P=C[y];g.font="12px Arial",g.fillStyle="rgba(255,255,255,0.5)",g.fillText(P.id,P.position.x+10,P.position.y-10)}}},t.collisions=function(h,u,p){var g=p,w=h.options,y,C,P,I;for(g.beginPath(),P=0;P<u.length;P++)if(y=u[P],!!y.isActive)for(C=y.collision,I=0;I<y.activeContacts.length;I++){var B=y.activeContacts[I],k=B.vertex;g.rect(k.x-1.5,k.y-1.5,3.5,3.5)}for(w.wireframes?g.fillStyle="rgba(255,255,255,0.7)":g.fillStyle="orange",g.fill(),g.beginPath(),P=0;P<u.length;P++)if(y=u[P],!!y.isActive&&(C=y.collision,y.activeContacts.length>0)){var T=y.activeContacts[0].vertex.x,E=y.activeContacts[0].vertex.y;y.activeContacts.length===2&&(T=(y.activeContacts[0].vertex.x+y.activeContacts[1].vertex.x)/2,E=(y.activeContacts[0].vertex.y+y.activeContacts[1].vertex.y)/2),C.bodyB===C.supports[0].body||C.bodyA.isStatic===!0?g.moveTo(T-C.normal.x*8,E-C.normal.y*8):g.moveTo(T+C.normal.x*8,E+C.normal.y*8),g.lineTo(T,E)}w.wireframes?g.strokeStyle="rgba(255,165,0,0.7)":g.strokeStyle="orange",g.lineWidth=1,g.stroke()},t.separations=function(h,u,p){var g=p,w=h.options,y,C,P,I,B;for(g.beginPath(),B=0;B<u.length;B++)if(y=u[B],!!y.isActive){C=y.collision,P=C.bodyA,I=C.bodyB;var k=1;!I.isStatic&&!P.isStatic&&(k=.5),I.isStatic&&(k=0),g.moveTo(I.position.x,I.position.y),g.lineTo(I.position.x-C.penetration.x*k,I.position.y-C.penetration.y*k),k=1,!I.isStatic&&!P.isStatic&&(k=.5),P.isStatic&&(k=0),g.moveTo(P.position.x,P.position.y),g.lineTo(P.position.x+C.penetration.x*k,P.position.y+C.penetration.y*k)}w.wireframes?g.strokeStyle="rgba(255,165,0,0.5)":g.strokeStyle="orange",g.stroke()},t.grid=function(h,u,p){var g=p,w=h.options;w.wireframes?g.strokeStyle="rgba(255,180,0,0.1)":g.strokeStyle="rgba(255,180,0,0.5)",g.beginPath();for(var y=f.keys(u.buckets),C=0;C<y.length;C++){var P=y[C];if(!(u.buckets[P].length<2)){var I=P.split(/C|R/);g.rect(.5+parseInt(I[1],10)*u.bucketWidth,.5+parseInt(I[2],10)*u.bucketHeight,u.bucketWidth,u.bucketHeight)}}g.lineWidth=1,g.stroke()},t.inspector=function(h,u){h.engine;var p=h.selected,g=h.render,w=g.options,y;if(w.hasBounds){var C=g.bounds.max.x-g.bounds.min.x,P=g.bounds.max.y-g.bounds.min.y,I=C/g.options.width,B=P/g.options.height;u.scale(1/I,1/B),u.translate(-g.bounds.min.x,-g.bounds.min.y)}for(var k=0;k<p.length;k++){var T=p[k].data;switch(u.translate(.5,.5),u.lineWidth=1,u.strokeStyle="rgba(255,165,0,0.9)",u.setLineDash([1,2]),T.type){case"body":y=T.bounds,u.beginPath(),u.rect(Math.floor(y.min.x-3),Math.floor(y.min.y-3),Math.floor(y.max.x-y.min.x+6),Math.floor(y.max.y-y.min.y+6)),u.closePath(),u.stroke();break;case"constraint":var E=T.pointA;T.bodyA&&(E=T.pointB),u.beginPath(),u.arc(E.x,E.y,10,0,2*Math.PI),u.closePath(),u.stroke();break}u.setLineDash([]),u.translate(-.5,-.5)}h.selectStart!==null&&(u.translate(.5,.5),u.lineWidth=1,u.strokeStyle="rgba(255,165,0,0.6)",u.fillStyle="rgba(255,165,0,0.1)",y=h.selectBounds,u.beginPath(),u.rect(Math.floor(y.min.x),Math.floor(y.min.y),Math.floor(y.max.x-y.min.x),Math.floor(y.max.y-y.min.y)),u.closePath(),u.stroke(),u.fill(),u.translate(-.5,-.5)),w.hasBounds&&u.setTransform(1,0,0,1,0,0)};var c=function(h,u){var p=document.createElement("canvas");return p.width=h,p.height=u,p.oncontextmenu=function(){return!1},p.onselectstart=function(){return!1},p},l=function(h){var u=h.getContext("2d"),p=window.devicePixelRatio||1,g=u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||u.oBackingStorePixelRatio||u.backingStorePixelRatio||1;return p/g},m=function(h,u){var p=h.textures[u];return p||(p=h.textures[u]=new Image,p.src=u,p)},x=function(h,u){var p=u;/(jpg|gif|png)$/.test(u)&&(p="url("+u+")"),h.canvas.style.background=p,h.canvas.style.backgroundSize="contain",h.currentBackground=u}})()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(d,M,A){var t={};M.exports=t;var f=d("../geometry/Bounds"),o=d("../body/Composite"),i=d("../core/Common"),v=d("../core/Events"),r=d("../geometry/Vector");(function(){var a,s;typeof window<"u"&&(a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(l){window.setTimeout(function(){l(i.now())},1e3/60)},s=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),t.create=function(l){i.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var m={controller:t,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},x=i.extend(m,l),h=!x.options.wireframes&&x.options.background==="transparent";return x.pixiOptions=x.pixiOptions||{view:x.canvas,transparent:h,antialias:!0,backgroundColor:l.background},x.mouse=l.mouse,x.engine=l.engine,x.renderer=x.renderer||new PIXI.WebGLRenderer(x.options.width,x.options.height,x.pixiOptions),x.container=x.container||new PIXI.Container,x.spriteContainer=x.spriteContainer||new PIXI.Container,x.canvas=x.canvas||x.renderer.view,x.bounds=x.bounds||{min:{x:0,y:0},max:{x:x.options.width,y:x.options.height}},v.on(x.engine,"beforeUpdate",function(){t.clear(x)}),x.textures={},x.sprites={},x.primitives={},x.container.addChild(x.spriteContainer),i.isElement(x.element)?x.element.appendChild(x.canvas):i.warn('No "render.element" passed, "render.canvas" was not inserted into document.'),x.canvas.oncontextmenu=function(){return!1},x.canvas.onselectstart=function(){return!1},x},t.run=function(l){(function m(x){l.frameRequestId=a(m),t.world(l)})()},t.stop=function(l){s(l.frameRequestId)},t.clear=function(l){for(var m=l.container,x=l.spriteContainer;m.children[0];)m.removeChild(m.children[0]);for(;x.children[0];)x.removeChild(x.children[0]);var h=l.sprites["bg-0"];l.textures={},l.sprites={},l.primitives={},l.sprites["bg-0"]=h,h&&m.addChildAt(h,0),l.container.addChild(l.spriteContainer),l.currentBackground=null,m.scale.set(1,1),m.position.set(0,0)},t.setBackground=function(l,m){if(l.currentBackground!==m){var x=m.indexOf&&m.indexOf("#")!==-1,h=l.sprites["bg-0"];if(x){var u=i.colorToNumber(m);l.renderer.backgroundColor=u,h&&l.container.removeChild(h)}else if(!h){var p=c(l,m);h=l.sprites["bg-0"]=new PIXI.Sprite(p),h.position.x=0,h.position.y=0,l.container.addChildAt(h,0)}l.currentBackground=m}},t.world=function(l){var m=l.engine,x=m.world,h=l.renderer,u=l.container,p=l.options,g=o.allBodies(x),w=o.allConstraints(x),y=[],C;p.wireframes?t.setBackground(l,p.wireframeBackground):t.setBackground(l,p.background);var P=l.bounds.max.x-l.bounds.min.x,I=l.bounds.max.y-l.bounds.min.y,B=P/l.options.width,k=I/l.options.height;if(p.hasBounds){for(C=0;C<g.length;C++){var T=g[C];T.render.sprite.visible=f.overlaps(T.bounds,l.bounds)}for(C=0;C<w.length;C++){var E=w[C],b=E.bodyA,R=E.bodyB,F=E.pointA,V=E.pointB;b&&(F=r.add(b.position,E.pointA)),R&&(V=r.add(R.position,E.pointB)),!(!F||!V)&&(f.contains(l.bounds,F)||f.contains(l.bounds,V))&&y.push(E)}u.scale.set(1/B,1/k),u.position.set(-l.bounds.min.x*(1/B),-l.bounds.min.y*(1/k))}else y=w;for(C=0;C<g.length;C++)t.body(l,g[C]);for(C=0;C<y.length;C++)t.constraint(l,y[C]);h.render(u)},t.constraint=function(l,m){l.engine;var x=m.bodyA,h=m.bodyB,u=m.pointA,p=m.pointB,g=l.container,w=m.render,y="c-"+m.id,C=l.primitives[y];if(C||(C=l.primitives[y]=new PIXI.Graphics),!w.visible||!m.pointA||!m.pointB){C.clear();return}i.indexOf(g.children,C)===-1&&g.addChild(C),C.clear(),C.beginFill(0,0),C.lineStyle(w.lineWidth,i.colorToNumber(w.strokeStyle),1),x?C.moveTo(x.position.x+u.x,x.position.y+u.y):C.moveTo(u.x,u.y),h?C.lineTo(h.position.x+p.x,h.position.y+p.y):C.lineTo(p.x,p.y),C.endFill()},t.body=function(l,m){l.engine;var x=m.render;if(x.visible)if(x.sprite&&x.sprite.texture){var h="b-"+m.id,u=l.sprites[h],p=l.spriteContainer;u||(u=l.sprites[h]=e(l,m)),i.indexOf(p.children,u)===-1&&p.addChild(u),u.position.x=m.position.x,u.position.y=m.position.y,u.rotation=m.angle,u.scale.x=x.sprite.xScale||1,u.scale.y=x.sprite.yScale||1}else{var g="b-"+m.id,w=l.primitives[g],y=l.container;w||(w=l.primitives[g]=n(l,m),w.initialAngle=m.angle),i.indexOf(y.children,w)===-1&&y.addChild(w),w.position.x=m.position.x,w.position.y=m.position.y,w.rotation=m.angle-w.initialAngle}};var e=function(l,m){var x=m.render,h=x.sprite.texture,u=c(l,h),p=new PIXI.Sprite(u);return p.anchor.x=m.render.sprite.xOffset,p.anchor.y=m.render.sprite.yOffset,p},n=function(l,m){var x=m.render,h=l.options,u=new PIXI.Graphics,p=i.colorToNumber(x.fillStyle),g=i.colorToNumber(x.strokeStyle),w=i.colorToNumber(x.strokeStyle),y=i.colorToNumber("#bbb"),C=i.colorToNumber("#CD5C5C"),P;u.clear();for(var I=m.parts.length>1?1:0;I<m.parts.length;I++){P=m.parts[I],h.wireframes?(u.beginFill(0,0),u.lineStyle(1,y,1)):(u.beginFill(p,1),u.lineStyle(x.lineWidth,g,1)),u.moveTo(P.vertices[0].x-m.position.x,P.vertices[0].y-m.position.y);for(var B=1;B<P.vertices.length;B++)u.lineTo(P.vertices[B].x-m.position.x,P.vertices[B].y-m.position.y);u.lineTo(P.vertices[0].x-m.position.x,P.vertices[0].y-m.position.y),u.endFill(),(h.showAngleIndicator||h.showAxes)&&(u.beginFill(0,0),h.wireframes?u.lineStyle(1,C,1):u.lineStyle(1,w),u.moveTo(P.position.x-m.position.x,P.position.y-m.position.y),u.lineTo((P.vertices[0].x+P.vertices[P.vertices.length-1].x)/2-m.position.x,(P.vertices[0].y+P.vertices[P.vertices.length-1].y)/2-m.position.y),u.endFill())}return u},c=function(l,m){var x=l.textures[m];return x||(x=l.textures[m]=PIXI.Texture.fromImage(m)),x}})()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)})})(j);var se=j.exports;const O=ne(se);class re{constructor(S,d){this.keys=new Map,this.mouseConstraint=S,this.eventsOn=d,document.addEventListener("keydown",this.handleKeyDown.bind(this)),document.addEventListener("keyup",this.handleKeyUp.bind(this))}addKey(S,d){this.keys.set(S,{isPressed:!1,callback:d})}removeKey(S){this.keys.delete(S)}handleKeyDown(S){const d=this.keys.get(S.key);d&&(d.isPressed=!0,d.callback&&d.callback(!0))}handleKeyUp(S){const d=this.keys.get(S.key);d&&(d.isPressed=!1,d.callback&&d.callback(!1))}pressedKeys(){const S=new Set;for(let[d,M]of this.keys)M.isPressed&&S.add(d);return S}}class oe{constructor(S){this.context=S,this.layers=[]}addLayer(S,d){this.layers.push([S,d])}clear(){this.layers=[]}draw(){for(let[S,d]of this.layers)for(let M of d.tiles)d.sprite.draw(this.context,M.pos.x,M.pos.y,M.anim)}drawLayer(S){for(let[d,M]of this.layers)if(!(S!==void 0&&S!==d))for(let A of M.tiles)M.sprite.draw(this.context,A.pos.x,A.pos.y,A.anim)}constructLayer(S,d,M,A,t){let f={sprite:S,tiles:[]};for(let o=0;o<d;o++)for(let i=0;i<M;i++)f.tiles.push({pos:{x:o*A,y:i*A},...t});return f}}const ae={default:1,player:2,platform:4,movingPlatform:8,enemy:16,coin:32,trigger:64};class J{constructor(S,d,M,A=d,t=M){this.tileW=d,this.tileH=M,this.width=A,this.height=t,this.animations=new Map,this.currentFrame=0,S instanceof Image?(this.image=S,this.loaded=!0):(this.loaded=!1,this.image=new Image,this.image.onload=()=>{console.log("Sprite loaded:",S),this.loaded=!0},this.image.onerror=f=>{console.error("Failed to load sprite:",S,f)},this.image.src=S)}define(S,d,M){const A=d*this.tileW,t=M*this.tileH;this.animations.set(S,{x:A,y:t})}drawTiles(S,d,M,A,t){if(!this.loaded)return;const f=Math.ceil(this.width/this.tileW),o=Math.ceil(this.height/this.tileH);for(let i=0;i<f;i++)for(let v=0;v<o;v++)S.drawImage(this.image,A,t,this.tileW,this.tileH,d-this.width/2+i*this.tileW,M-this.height/2+v*this.tileH,this.tileW,this.tileH)}drawStatic(S,d,M,A,t){this.drawTiles(S,d,M,A*this.tileW,t*this.tileH)}draw(S,d,M,A){if(!A){this.drawStatic(S,d,M,this.currentFrame,0);return}const t=this.animations.get(A);if(!t){console.warn(`Animation ${A} not found`);return}this.drawTiles(S,d,M,t.x+this.currentFrame*this.tileW,t.y)}}class le{constructor(S,d,M,A){this.x=S,this.y=d,this.width=M,this.height=A,this.visible=!0,this.isHovered=!1,this.isFocused=!1}update(S){}draw(S){}contains(S,d){return S>=this.x&&S<=this.x+this.width&&d>=this.y&&d<=this.y+this.height}onMouseMove(S,d){const M=this.isHovered;this.isHovered=this.contains(S,d),M!==this.isHovered&&(this.isHovered?this.onMouseEnter():this.onMouseLeave())}onMouseDown(S,d){var M;return this.contains(S,d)?((M=this.onClick)==null||M.call(this,S,d),!0):!1}onMouseEnter(){}onMouseLeave(){}onClick(){}onFocus(){this.isFocused=!0}onBlur(){this.isFocused=!1}destroy(){this.visible=!1,this.isHovered=!1,this.isFocused=!1}}class ce extends le{constructor(S){super(0,0,S.canvas.width,S.canvas.height),this.game=S,this.children=new Set}add(S){this.children.add(S)}remove(S){S.destroy&&S.destroy(),this.children.delete(S)}update(S){this.visible&&this.children.forEach(d=>d.update(S))}draw(S){this.visible&&this.children.forEach(d=>d.draw(S))}onMouseMove(S,d){this.visible&&(super.onMouseMove(S,d),this.children.forEach(M=>M.onMouseMove(S,d)))}onMouseDown(S,d){if(!this.visible||!this.contains(S,d))return!1;for(const M of this.children)if(M.onMouseDown(S,d))return!0;return super.onMouseDown(S,d)}clear(){this.children.forEach(S=>{S.destroy&&S.destroy()}),this.children.clear()}destroy(){this.clear()}resize(){this.width=this.game.canvas.width,this.height=this.game.canvas.height}}class K{constructor(S,d){this.game=S,this.config=d,this.sprites=new Map,this.spriteSheets=new Map,this.ui=new ce(S),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseDown=this._handleMouseDown.bind(this)}_handleMouseMove(S){const d=this.game.canvas.getBoundingClientRect(),M=(S.clientX-d.left)*(this.game.canvas.width/d.width),A=(S.clientY-d.top)*(this.game.canvas.height/d.height);this.ui.onMouseMove(M,A)}_handleMouseDown(S){const d=this.game.canvas.getBoundingClientRect(),M=(S.clientX-d.left)*(this.game.canvas.width/d.width),A=(S.clientY-d.top)*(this.game.canvas.height/d.height);this.ui.onMouseDown(M,A)}async loadAssets(){if(!this.config.sprites)return;const S=this.config.sprites.map(([d,M])=>new Promise((A,t)=>{const f=new Image;f.onload=()=>{this.sprites.set(d,f),A()},f.onerror=()=>t(new Error(`Failed to load sprite: ${d}`)),f.src=d}));try{await Promise.all(S),this.config.sprites.forEach(([d,M])=>{const A=this.sprites.get(d);A&&this.spriteSheets.set(d,new J(A,M,M))})}catch(d){throw console.error("Error loading assets:",d),d}}async load(){await this.loadAssets(),this.game.entities.clear(),O.Composite.clear(this.game.engine.world),this.game.layers.clear(),this.game.player=null,this.ui.clear(),this.game.canvas.addEventListener("mousemove",this._handleMouseMove),this.game.canvas.addEventListener("mousedown",this._handleMouseDown),this.config.type==="level"?(await this._loadLevelScene(),this.game.player&&this.game.camera.follow(this.game.player)):await this._loadNormalScene(),this.config.onEnter&&this.config.onEnter()}async _loadLevelScene(){let S;if(typeof this.config.levelData=="string"?S=await this.game.sceneManager.loadLevelData(this.config.levelData):typeof this.config.levelData=="object"&&(S=this.config.levelData),!S){console.error("Failed to load level data");return}if(this._setPhysics(S.gameType),this.config.sprites=S.sprites,await this.loadAssets(),S.background&&this._loadBackground(S.background),S.entities&&this._loadEntities(S.entities),S.player){const d=this.createEntity(S.player);d&&(this.game.player=d,O.Composite.add(this.game.engine.world,d.body))}}async _loadNormalScene(){this._setPhysics(this.config.gameType),this.config.background&&this._loadBackground(this.config.background),this.config.entities&&this._loadEntities(this.config.entities)}_setPhysics(S){this.game.engine.world.gravity.y=S==="topDown"?0:2}_loadBackground([S,d,M]){const[A,t]=this.config.sprites[S],f=this.spriteSheets.get(A);if(!f){console.error(`Sprite not found: ${A}`);return}f.define("default",d,M);const o=Math.ceil(this.game.width/t),i=Math.ceil(this.game.height/t),v=this.game.layers.constructLayer(f,o,i,t,{anim:"default"});this.game.layers.addLayer("background",v)}_loadEntities(S){for(const d of S){const M=this.createEntity(d);M&&(this.game.entities.add(M),O.Composite.add(this.game.engine.world,M.body))}}createEntity(S){const{type:d,position:[M,A],size:[t,f],sprite:o,animations:i=[],options:v={}}=S,r=this.game.actors.get(d);if(!r)return console.error(`Actor type "${d}" not registered`),null;const[a,s]=this.config.sprites[o],e=this.spriteSheets.get(a);if(!e)return console.error(`Sprite not found: ${a}`),null;const n=new J(e.image,s,s,t,f),c=this.game.collisionCategories[d]||this.game.collisionCategories.default;let l;switch(d){case"platform":case"movingPlatform":l=this.game.collisionCategories.player|this.game.collisionCategories.enemy;break;case"bee":l=this.game.collisionCategories.platform|this.game.collisionCategories.movingPlatform|this.game.collisionCategories.player;break;case"player":l=this.game.collisionCategories.platform|this.game.collisionCategories.movingPlatform|this.game.collisionCategories.enemy|this.game.collisionCategories.coin|this.game.collisionCategories.trigger;break;case"coin":case"trigger":l=this.game.collisionCategories.player;break;default:l=-1}const m={frictionAir:.01,friction:.1,restitution:.1,collisionFilter:{category:c,mask:l},...v},x=this.game.Bodies.rectangle(M,A,t,f,m),h=new r(this.game.context,x,n,this.game,v);x.entity=h,console.debug(`Created ${d} entity:`,x.entity);for(const[u,p,g,w]of i)h.sprite.define(u,p,g),w&&(h.currentAnim=u);return h}update(S){var d;if(this.config.type==="level"&&(O.Engine.update(this.game.engine,S*1e3),this.game.player&&this.game.player.body.position.y>this.game.options.worldHeight+50)){console.log("Game Over!"),this.game.gameOver();return}(d=this.game.player)!=null&&d.update&&this.game.player.update(S);for(let M of this.game.entities)M.update&&M.update(S);this.ui.update(S)}draw(S){this.game.renderer.drawWorld(d=>{d.fillStyle=this.config.backgroundColor||"#000",d.fillRect(this.game.camera.x,this.game.camera.y,this.game.camera.width,this.game.camera.height),this.game.layers.draw(S),this.game.player&&this.game.player.draw(S);for(let M of this.game.entities){const A=M.body.position,t=M.body.bounds,f=t.max.x-t.min.x,o=t.max.y-t.min.y;this.game.camera.isVisible(A.x-f/2,A.y-o/2,f,o)&&M.draw(S)}}),this.game.renderer.drawScreen(d=>{this.ui.draw(d)})}unload(){this.config.onExit&&this.config.onExit(),this.spriteSheets.clear(),this.ui.clear(),this.game.canvas.removeEventListener("mousemove",this._handleMouseMove),this.game.canvas.removeEventListener("mousedown",this._handleMouseDown)}}class fe{constructor(S){this.game=S,this.scenes=new Map,this.currentScene=null,this.levelNames=S.options.levelNames||[],this.levelsPath=S.options.levelsPath||"./levels/",this.currentLevelIndex=-1,this.levelNames.length>0&&(this.levelNames.forEach(d=>{this.registerScene({name:d,type:"level",levelData:d})}),S.options.currentLevel&&(this.currentLevelIndex=this.levelNames.indexOf(S.options.currentLevel)))}registerScene(S){const d=new K(this.game,S);this.scenes.set(S.name,d)}async switchTo(S){const d=this.getCurrentScene();d&&(d.unload(),this.currentScene=null);const M=this.scenes.get(S);if(M)this.currentScene=S,await M.load();else{if(!this.levelData.get(S)){console.error(`Scene "${S}" not found`);return}await this.loadLevel(S)}}async loadLevel(S){const d=await this.loadLevelData(S);if(d){const M=new K(this.game,{name:S,type:"level",levelData:d});this.scenes.set(S,M),this.currentScene=S,await M.load()}}getCurrentScene(){return this.scenes.get(this.currentScene)}async loadLevelData(S){try{return await(await fetch(this.levelsPath+S)).json()}catch(d){return console.error("Error loading level:",d),null}}async nextLevel(){if(this.currentLevelIndex<this.levelNames.length-1){this.currentLevelIndex++;const S=this.levelNames[this.currentLevelIndex];return await this.switchTo(S),!0}return!1}async previousLevel(){if(this.currentLevelIndex>0){this.currentLevelIndex--;const S=this.levelNames[this.currentLevelIndex];return await this.switchTo(S),!0}return!1}setLevelData(S,d){const M=new K(this.game,{name:S,type:"level",levelData:d});this.scenes.set(S,M)}}class ue{constructor(S,d={}){this.game=S,this.x=0,this.y=0,this.width=S.canvas.width,this.height=S.canvas.height,this.worldWidth=d.worldWidth||this.width,this.worldHeight=d.worldHeight||this.height,this.smoothing=d.smoothing||.1,this.target=null,this.deadzone=d.deadzone||{x:this.width*.4,y:this.height*.2,width:this.width*.4,height:this.height*.4}}follow(S){this.target=S}update(){if(!this.target)return;const S=this.target.body.position.x,d=this.target.body.position.y;let M=this.x,A=this.y;S<this.x+this.deadzone.x?M=S-this.deadzone.x:S>this.x+this.width-this.deadzone.x&&(M=S-this.width+this.deadzone.x),d<this.y+this.deadzone.y?A=d-this.deadzone.y:d>this.y+this.height-this.deadzone.y&&(A=d-this.height+this.deadzone.y),this.x+=(M-this.x)*this.smoothing,this.y+=(A-this.y)*this.smoothing,this.x=Math.max(0,Math.min(this.x,this.worldWidth-this.width)),this.y=Math.max(0,Math.min(this.y,this.worldHeight-this.height))}worldToScreen(S,d){return{x:S-this.x,y:d-this.y}}screenToWorld(S,d){return{x:S+this.x,y:d+this.y}}isVisible(S,d,M,A){return S+M>=this.x&&S<=this.x+this.width&&d+A>=this.y&&d<=this.y+this.height}begin(S){S.save(),S.translate(-Math.floor(this.x),-Math.floor(this.y))}end(S){S.restore()}}class he{constructor(S){this.game=S,this.ctx=S.context,this.camera=S.camera}drawWorld(S){this.ctx.save(),this.camera.begin(this.ctx),S(this.ctx),this.camera.end(this.ctx),this.ctx.restore()}drawScreen(S){this.ctx.save(),S(this.ctx),this.ctx.restore()}drawSprite(S,d,M,A,t){this.camera.isVisible(d,M,A,t)&&S.draw(this.ctx,d,M,A,t)}drawRect(S,d,M,A,t){this.camera.isVisible(S,d,M,A)&&(this.ctx.fillStyle=t,this.ctx.fillRect(S,d,M,A))}drawText(S,d,M,A={}){this.ctx.fillStyle=A.color||"#fff",this.ctx.font=A.font||"16px Arial",this.ctx.textAlign=A.align||"left",this.ctx.textBaseline=A.baseline||"top",this.ctx.fillText(S,d,M)}clear(S="#000"){this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.fillStyle=S,this.ctx.fillRect(0,0,this.game.canvas.width,this.game.canvas.height),this.ctx.restore()}worldToScreen(S,d){return this.camera.worldToScreen(S,d)}screenToWorld(S,d){return this.camera.screenToWorld(S,d)}}const _="m",q="r",me="x",de=" ",ge="ArrowLeft",pe="ArrowUp",xe="ArrowRight",ye="ArrowDown",ve={levelNames:[],currentLevel:null,levelsPath:"./levels/",initialScene:null,width:1280,height:720,worldWidth:1920,worldHeight:1080};class we{constructor(S,d={}){this.options={...ve,...d},this.canvas=S,this.context=S.getContext("2d"),this.canvas.width=this.options.width,this.canvas.height=this.options.height,this.camera=new ue(this,{worldWidth:this.options.worldWidth,worldHeight:this.options.worldHeight,smoothing:.1}),this.renderer=new he(this),this.engine=O.Engine.create(),this.collisionCategories=ae,this.Body=O.Body,this.Bodies=O.Bodies,this.entities=new Set,this.player=null,this.actors=new Map,this.isGameOver=!1,this.keys=new re,this.layers=new oe(this.context),this.sceneManager=new fe(this),this.keys.addKey(q),this.keys.addKey(_),this.update=this.update.bind(this),this.lastTime=0}resize(){const S=this.canvas.parentElement,d=S.clientWidth,M=S.clientHeight,A=Math.min(d/this.baseWidth,M/this.baseHeight);this.width=Math.floor(this.baseWidth*A),this.height=Math.floor(this.baseHeight*A),this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.width=`${this.width}px`,this.canvas.style.height=`${this.height}px`}registerActor(S,d){this.actors.set(S,d)}beforeUpdate(S){}afterUpdate(S){}gameOver(){this.isGameOver=!0}drawGameOver(){this.renderer.drawScreen(S=>{S.fillStyle="rgba(0, 0, 0, 0.7)",S.fillRect(0,0,this.canvas.width,this.canvas.height),S.fillStyle="#fff",S.font="bold 48px Arial",S.textAlign="center",S.textBaseline="middle",S.fillText("Game Over",this.canvas.width/2,this.canvas.height/2-40),S.font="24px Arial",S.fillText("Press R to restart",this.canvas.width/2,this.canvas.height/2+20),S.fillText("Press M for menu",this.canvas.width/2,this.canvas.height/2+60)})}update(S){if(!this.lastTime){this.lastTime=S,requestAnimationFrame(this.update);return}let d=(S-this.lastTime)/1e3;this.lastTime=S,this.renderer.clear("#000"),this.beforeUpdate(d);const M=this.sceneManager.getCurrentScene();this.isGameOver?(M&&M.draw(d),this.drawGameOver(),this.keys.pressedKeys().has(q)?(this.isGameOver=!1,this.reset(),M.load()):this.keys.pressedKeys().has(_)&&(this.isGameOver=!1,this.reset(),this.sceneManager.switchTo("mainMenu"))):M&&(this.camera.update(),M.update(d),M.draw(d)),this.afterUpdate(d),requestAnimationFrame(this.update)}start(){this.options.initialScene?this.sceneManager.switchTo(this.options.initialScene).then(()=>{this.update()}):this.options.currentLevel?this.sceneManager.switchTo(this.options.currentLevel).then(()=>{this.update()}):this.update(),this.setupCollisionHandlers()}reset(){O.Events.off(this.engine),O.World.clear(this.engine.world),O.Engine.clear(this.engine),O.Composite.clear(this.engine.world),this.engine.world=O.World.create(),this.engine=null,this.engine=O.Engine.create(),this.entities.clear(),this.layers.clear(),this.player=null,this.lastTime=0,this.camera.x=0,this.camera.y=0,this.camera.target=null,this.setupCollisionHandlers()}setupCollisionHandlers(){O.Events.on(this.engine,"collisionStart",S=>{S.pairs.forEach(d=>{const{bodyA:M,bodyB:A}=d;M.entity&&M.entity.onCollisionStart(A),A.entity&&A.entity.onCollisionStart(M)})}),O.Events.on(this.engine,"collisionEnd",S=>{S.pairs.forEach(d=>{const{bodyA:M,bodyB:A}=d;M.entity&&M.entity.onCollisionEnd(A),A.entity&&A.entity.onCollisionEnd(M)})})}getMousePosition(S){const d=this.canvas.getBoundingClientRect(),M=S.clientX-d.left,A=S.clientY-d.top,t=this.canvas.width/d.width,f=this.canvas.height/d.height;return this.camera.screenToWorld(M*t,A*f)}}export{ae as C,ge as K,O as M,K as S,le as U,xe as a,pe as b,ye as c,de as d,me as e,we as f};
