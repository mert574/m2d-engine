(function(){const A=document.createElement("link").relList;if(A&&A.supports&&A.supports("modulepreload"))return;for(const B of document.querySelectorAll('link[rel="modulepreload"]'))M(B);new MutationObserver(B=>{for(const t of B)if(t.type==="childList")for(const f of t.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&M(f)}).observe(document,{childList:!0,subtree:!0});function x(B){const t={};return B.integrity&&(t.integrity=B.integrity),B.referrerPolicy&&(t.referrerPolicy=B.referrerPolicy),B.crossOrigin==="use-credentials"?t.credentials="include":B.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function M(B){if(B.ep)return;B.ep=!0;const t=x(B);fetch(B.href,t)}})();var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ee(F){return F&&F.__esModule&&Object.prototype.hasOwnProperty.call(F,"default")?F.default:F}function X(F){throw new Error('Could not dynamically require "'+F+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var J={exports:{}};(function(F,A){(function(x){F.exports=x()})(function(){return function(){function x(M,B,t){function f(h,o){if(!B[h]){if(!M[h]){var a=typeof X=="function"&&X;if(!o&&a)return a(h,!0);if(s)return s(h,!0);var r=new Error("Cannot find module '"+h+"'");throw r.code="MODULE_NOT_FOUND",r}var e=B[h]={exports:{}};M[h][0].call(e.exports,function(n){var c=M[h][1][n];return f(c||n)},e,e.exports,x,M,B,t)}return B[h].exports}for(var s=typeof X=="function"&&X,i=0;i<t.length;i++)f(t[i]);return f}return x}()({1:[function(x,M,B){var t={};M.exports=t;var f=x("../geometry/Vertices"),s=x("../geometry/Vector"),i=x("../core/Sleeping");x("../render/Render");var h=x("../core/Common"),o=x("../geometry/Bounds"),a=x("../geometry/Axes");(function(){t._inertiaScale=4,t._nextCollidingGroupId=1,t._nextNonCollidingGroupId=-1,t._nextCategory=1,t.create=function(e){var n={id:h.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:f.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},c=h.extend(n,e);return r(c,e),c},t.nextGroup=function(e){return e?t._nextNonCollidingGroupId--:t._nextCollidingGroupId++},t.nextCategory=function(){return t._nextCategory=t._nextCategory<<1,t._nextCategory};var r=function(e,n){n=n||{},t.set(e,{bounds:e.bounds||o.create(e.vertices),positionPrev:e.positionPrev||s.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),f.rotate(e.vertices,e.angle,e.position),a.rotate(e.axes,e.angle),o.update(e.bounds,e.vertices,e.velocity),t.set(e,{axes:n.axes||e.axes,area:n.area||e.area,mass:n.mass||e.mass,inertia:n.inertia||e.inertia});var c=e.isStatic?"#2e2b44":h.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]),l="#000";e.render.fillStyle=e.render.fillStyle||c,e.render.strokeStyle=e.render.strokeStyle||l,e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};t.set=function(e,n,c){var l;typeof n=="string"&&(l=n,n={},n[l]=c);for(l in n)if(c=n[l],!!n.hasOwnProperty(l))switch(l){case"isStatic":t.setStatic(e,c);break;case"isSleeping":i.set(e,c);break;case"mass":t.setMass(e,c);break;case"density":t.setDensity(e,c);break;case"inertia":t.setInertia(e,c);break;case"vertices":t.setVertices(e,c);break;case"position":t.setPosition(e,c);break;case"angle":t.setAngle(e,c);break;case"velocity":t.setVelocity(e,c);break;case"angularVelocity":t.setAngularVelocity(e,c);break;case"parts":t.setParts(e,c);break;default:e[l]=c}},t.setStatic=function(e,n){for(var c=0;c<e.parts.length;c++){var l=e.parts[c];l.isStatic=n,n?(l._original={restitution:l.restitution,friction:l.friction,mass:l.mass,inertia:l.inertia,density:l.density,inverseMass:l.inverseMass,inverseInertia:l.inverseInertia},l.restitution=0,l.friction=1,l.mass=l.inertia=l.density=1/0,l.inverseMass=l.inverseInertia=0,l.positionPrev.x=l.position.x,l.positionPrev.y=l.position.y,l.anglePrev=l.angle,l.angularVelocity=0,l.speed=0,l.angularSpeed=0,l.motion=0):l._original&&(l.restitution=l._original.restitution,l.friction=l._original.friction,l.mass=l._original.mass,l.inertia=l._original.inertia,l.density=l._original.density,l.inverseMass=l._original.inverseMass,l.inverseInertia=l._original.inverseInertia,delete l._original)}},t.setMass=function(e,n){var c=e.inertia/(e.mass/6);e.inertia=c*(n/6),e.inverseInertia=1/e.inertia,e.mass=n,e.inverseMass=1/e.mass,e.density=e.mass/e.area},t.setDensity=function(e,n){t.setMass(e,n*e.area),e.density=n},t.setInertia=function(e,n){e.inertia=n,e.inverseInertia=1/e.inertia},t.setVertices=function(e,n){n[0].body===e?e.vertices=n:e.vertices=f.create(n,e),e.axes=a.fromVertices(e.vertices),e.area=f.area(e.vertices),t.setMass(e,e.density*e.area);var c=f.centre(e.vertices);f.translate(e.vertices,c,-1),t.setInertia(e,t._inertiaScale*f.inertia(e.vertices,e.mass)),f.translate(e.vertices,e.position),o.update(e.bounds,e.vertices,e.velocity)},t.setParts=function(e,n,c){var l;for(n=n.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,l=0;l<n.length;l++){var m=n[l];m!==e&&(m.parent=e,e.parts.push(m))}if(e.parts.length!==1){if(c=typeof c<"u"?c:!0,c){var d=[];for(l=0;l<n.length;l++)d=d.concat(n[l].vertices);f.clockwiseSort(d);var v=f.hull(d),u=f.centre(v);t.setVertices(e,v),f.translate(e.vertices,u)}var p=t._totalProperties(e);e.area=p.area,e.parent=e,e.position.x=p.centre.x,e.position.y=p.centre.y,e.positionPrev.x=p.centre.x,e.positionPrev.y=p.centre.y,t.setMass(e,p.mass),t.setInertia(e,p.inertia),t.setPosition(e,p.centre)}},t.setPosition=function(e,n){var c=s.sub(n,e.position);e.positionPrev.x+=c.x,e.positionPrev.y+=c.y;for(var l=0;l<e.parts.length;l++){var m=e.parts[l];m.position.x+=c.x,m.position.y+=c.y,f.translate(m.vertices,c),o.update(m.bounds,m.vertices,e.velocity)}},t.setAngle=function(e,n){var c=n-e.angle;e.anglePrev+=c;for(var l=0;l<e.parts.length;l++){var m=e.parts[l];m.angle+=c,f.rotate(m.vertices,c,e.position),a.rotate(m.axes,c),o.update(m.bounds,m.vertices,e.velocity),l>0&&s.rotateAbout(m.position,c,e.position,m.position)}},t.setVelocity=function(e,n){e.positionPrev.x=e.position.x-n.x,e.positionPrev.y=e.position.y-n.y,e.velocity.x=n.x,e.velocity.y=n.y,e.speed=s.magnitude(e.velocity)},t.setAngularVelocity=function(e,n){e.anglePrev=e.angle-n,e.angularVelocity=n,e.angularSpeed=Math.abs(e.angularVelocity)},t.translate=function(e,n){t.setPosition(e,s.add(e.position,n))},t.rotate=function(e,n,c){if(!c)t.setAngle(e,e.angle+n);else{var l=Math.cos(n),m=Math.sin(n),d=e.position.x-c.x,v=e.position.y-c.y;t.setPosition(e,{x:c.x+(d*l-v*m),y:c.y+(d*m+v*l)}),t.setAngle(e,e.angle+n)}},t.scale=function(e,n,c,l){var m=0,d=0;l=l||e.position;for(var v=0;v<e.parts.length;v++){var u=e.parts[v];f.scale(u.vertices,n,c,l),u.axes=a.fromVertices(u.vertices),u.area=f.area(u.vertices),t.setMass(u,e.density*u.area),f.translate(u.vertices,{x:-u.position.x,y:-u.position.y}),t.setInertia(u,t._inertiaScale*f.inertia(u.vertices,u.mass)),f.translate(u.vertices,{x:u.position.x,y:u.position.y}),v>0&&(m+=u.area,d+=u.inertia),u.position.x=l.x+(u.position.x-l.x)*n,u.position.y=l.y+(u.position.y-l.y)*c,o.update(u.bounds,u.vertices,e.velocity)}e.parts.length>1&&(e.area=m,e.isStatic||(t.setMass(e,e.density*m),t.setInertia(e,d))),e.circleRadius&&(n===c?e.circleRadius*=n:e.circleRadius=null)},t.update=function(e,n,c,l){var m=Math.pow(n*c*e.timeScale,2),d=1-e.frictionAir*c*e.timeScale,v=e.position.x-e.positionPrev.x,u=e.position.y-e.positionPrev.y;e.velocity.x=v*d*l+e.force.x/e.mass*m,e.velocity.y=u*d*l+e.force.y/e.mass*m,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.angularVelocity=(e.angle-e.anglePrev)*d*l+e.torque/e.inertia*m,e.anglePrev=e.angle,e.angle+=e.angularVelocity,e.speed=s.magnitude(e.velocity),e.angularSpeed=Math.abs(e.angularVelocity);for(var p=0;p<e.parts.length;p++){var g=e.parts[p];f.translate(g.vertices,e.velocity),p>0&&(g.position.x+=e.velocity.x,g.position.y+=e.velocity.y),e.angularVelocity!==0&&(f.rotate(g.vertices,e.angularVelocity,e.position),a.rotate(g.axes,e.angularVelocity),p>0&&s.rotateAbout(g.position,e.angularVelocity,e.position,g.position)),o.update(g.bounds,g.vertices,e.velocity)}},t.applyForce=function(e,n,c){e.force.x+=c.x,e.force.y+=c.y;var l={x:n.x-e.position.x,y:n.y-e.position.y};e.torque+=l.x*c.y-l.y*c.x},t._totalProperties=function(e){for(var n={mass:0,area:0,inertia:0,centre:{x:0,y:0}},c=e.parts.length===1?0:1;c<e.parts.length;c++){var l=e.parts[c],m=l.mass!==1/0?l.mass:1;n.mass+=m,n.area+=l.area,n.inertia+=l.inertia,n.centre=s.add(n.centre,s.mult(l.position,m))}return n.centre=s.div(n.centre,n.mass),n}})()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(x,M,B){var t={};M.exports=t;var f=x("../core/Events"),s=x("../core/Common"),i=x("../geometry/Bounds"),h=x("./Body");(function(){t.create=function(o){return s.extend({id:s.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},o)},t.setModified=function(o,a,r,e){if(o.isModified=a,r&&o.parent&&t.setModified(o.parent,a,r,e),e)for(var n=0;n<o.composites.length;n++){var c=o.composites[n];t.setModified(c,a,r,e)}},t.add=function(o,a){var r=[].concat(a);f.trigger(o,"beforeAdd",{object:a});for(var e=0;e<r.length;e++){var n=r[e];switch(n.type){case"body":if(n.parent!==n){s.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}t.addBody(o,n);break;case"constraint":t.addConstraint(o,n);break;case"composite":t.addComposite(o,n);break;case"mouseConstraint":t.addConstraint(o,n.constraint);break}}return f.trigger(o,"afterAdd",{object:a}),o},t.remove=function(o,a,r){var e=[].concat(a);f.trigger(o,"beforeRemove",{object:a});for(var n=0;n<e.length;n++){var c=e[n];switch(c.type){case"body":t.removeBody(o,c,r);break;case"constraint":t.removeConstraint(o,c,r);break;case"composite":t.removeComposite(o,c,r);break;case"mouseConstraint":t.removeConstraint(o,c.constraint);break}}return f.trigger(o,"afterRemove",{object:a}),o},t.addComposite=function(o,a){return o.composites.push(a),a.parent=o,t.setModified(o,!0,!0,!1),o},t.removeComposite=function(o,a,r){var e=s.indexOf(o.composites,a);if(e!==-1&&(t.removeCompositeAt(o,e),t.setModified(o,!0,!0,!1)),r)for(var n=0;n<o.composites.length;n++)t.removeComposite(o.composites[n],a,!0);return o},t.removeCompositeAt=function(o,a){return o.composites.splice(a,1),t.setModified(o,!0,!0,!1),o},t.addBody=function(o,a){return o.bodies.push(a),t.setModified(o,!0,!0,!1),o},t.removeBody=function(o,a,r){var e=s.indexOf(o.bodies,a);if(e!==-1&&(t.removeBodyAt(o,e),t.setModified(o,!0,!0,!1)),r)for(var n=0;n<o.composites.length;n++)t.removeBody(o.composites[n],a,!0);return o},t.removeBodyAt=function(o,a){return o.bodies.splice(a,1),t.setModified(o,!0,!0,!1),o},t.addConstraint=function(o,a){return o.constraints.push(a),t.setModified(o,!0,!0,!1),o},t.removeConstraint=function(o,a,r){var e=s.indexOf(o.constraints,a);if(e!==-1&&t.removeConstraintAt(o,e),r)for(var n=0;n<o.composites.length;n++)t.removeConstraint(o.composites[n],a,!0);return o},t.removeConstraintAt=function(o,a){return o.constraints.splice(a,1),t.setModified(o,!0,!0,!1),o},t.clear=function(o,a,r){if(r)for(var e=0;e<o.composites.length;e++)t.clear(o.composites[e],a,!0);return a?o.bodies=o.bodies.filter(function(n){return n.isStatic}):o.bodies.length=0,o.constraints.length=0,o.composites.length=0,t.setModified(o,!0,!0,!1),o},t.allBodies=function(o){for(var a=[].concat(o.bodies),r=0;r<o.composites.length;r++)a=a.concat(t.allBodies(o.composites[r]));return a},t.allConstraints=function(o){for(var a=[].concat(o.constraints),r=0;r<o.composites.length;r++)a=a.concat(t.allConstraints(o.composites[r]));return a},t.allComposites=function(o){for(var a=[].concat(o.composites),r=0;r<o.composites.length;r++)a=a.concat(t.allComposites(o.composites[r]));return a},t.get=function(o,a,r){var e,n;switch(r){case"body":e=t.allBodies(o);break;case"constraint":e=t.allConstraints(o);break;case"composite":e=t.allComposites(o).concat(o);break}return e?(n=e.filter(function(c){return c.id.toString()===a.toString()}),n.length===0?null:n[0]):null},t.move=function(o,a,r){return t.remove(o,a),t.add(r,a),o},t.rebase=function(o){for(var a=t.allBodies(o).concat(t.allConstraints(o)).concat(t.allComposites(o)),r=0;r<a.length;r++)a[r].id=s.nextId();return t.setModified(o,!0,!0,!1),o},t.translate=function(o,a,r){for(var e=r?t.allBodies(o):o.bodies,n=0;n<e.length;n++)h.translate(e[n],a);return t.setModified(o,!0,!0,!1),o},t.rotate=function(o,a,r,e){for(var n=Math.cos(a),c=Math.sin(a),l=e?t.allBodies(o):o.bodies,m=0;m<l.length;m++){var d=l[m],v=d.position.x-r.x,u=d.position.y-r.y;h.setPosition(d,{x:r.x+(v*n-u*c),y:r.y+(v*c+u*n)}),h.rotate(d,a)}return t.setModified(o,!0,!0,!1),o},t.scale=function(o,a,r,e,n){for(var c=n?t.allBodies(o):o.bodies,l=0;l<c.length;l++){var m=c[l],d=m.position.x-e.x,v=m.position.y-e.y;h.setPosition(m,{x:e.x+d*a,y:e.y+v*r}),h.scale(m,a,r)}return t.setModified(o,!0,!0,!1),o},t.bounds=function(o){for(var a=t.allBodies(o),r=[],e=0;e<a.length;e+=1){var n=a[e];r.push(n.bounds.min,n.bounds.max)}return i.create(r)}})()},{"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"./Body":1}],3:[function(x,M,B){var t={};M.exports=t;var f=x("./Composite");x("../constraint/Constraint");var s=x("../core/Common");(function(){t.create=function(i){var h=f.create(),o={label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-1/0,y:-1/0},max:{x:1/0,y:1/0}}};return s.extend(h,o,i)}})()},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(x,M,B){var t={};M.exports=t,function(){t.create=function(f){return{id:t.id(f),vertex:f,normalImpulse:0,tangentImpulse:0}},t.id=function(f){return f.body.id+"_"+f.index}}()},{}],5:[function(x,M,B){var t={};M.exports=t;var f=x("./SAT"),s=x("./Pair"),i=x("../geometry/Bounds");(function(){t.collisions=function(h,o){for(var a=[],r=o.pairs.table,e=0;e<h.length;e++){var n=h[e][0],c=h[e][1];if(!((n.isStatic||n.isSleeping)&&(c.isStatic||c.isSleeping))&&t.canCollide(n.collisionFilter,c.collisionFilter)&&i.overlaps(n.bounds,c.bounds))for(var l=n.parts.length>1?1:0;l<n.parts.length;l++)for(var m=n.parts[l],d=c.parts.length>1?1:0;d<c.parts.length;d++){var v=c.parts[d];if(m===n&&v===c||i.overlaps(m.bounds,v.bounds)){var u=s.id(m,v),p=r[u],g;p&&p.isActive?g=p.collision:g=null;var w=f.collides(m,v,g);w.collided&&a.push(w)}}}return a},t.canCollide=function(h,o){return h.group===o.group&&h.group!==0?h.group>0:(h.mask&o.category)!==0&&(o.mask&h.category)!==0}})()},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(x,M,B){var t={};M.exports=t;var f=x("./Pair"),s=x("./Detector"),i=x("../core/Common");(function(){t.create=function(h){var o={controller:t,detector:s.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return i.extend(o,h)},t.update=function(h,o,a,r){var e,n,c,l=a.world,m=h.buckets,d,v,u=!1;for(e=0;e<o.length;e++){var p=o[e];if(!(p.isSleeping&&!r)&&!(p.bounds.max.x<l.bounds.min.x||p.bounds.min.x>l.bounds.max.x||p.bounds.max.y<l.bounds.min.y||p.bounds.min.y>l.bounds.max.y)){var g=t._getRegion(h,p);if(!p.region||g.id!==p.region.id||r){(!p.region||r)&&(p.region=g);var w=t._regionUnion(g,p.region);for(n=w.startCol;n<=w.endCol;n++)for(c=w.startRow;c<=w.endRow;c++){v=t._getBucketId(n,c),d=m[v];var y=n>=g.startCol&&n<=g.endCol&&c>=g.startRow&&c<=g.endRow,S=n>=p.region.startCol&&n<=p.region.endCol&&c>=p.region.startRow&&c<=p.region.endRow;!y&&S&&S&&d&&t._bucketRemoveBody(h,d,p),(p.region===g||y&&!S||r)&&(d||(d=t._createBucket(m,v)),t._bucketAddBody(h,d,p))}p.region=g,u=!0}}}u&&(h.pairsList=t._createActivePairsList(h))},t.clear=function(h){h.buckets={},h.pairs={},h.pairsList=[]},t._regionUnion=function(h,o){var a=Math.min(h.startCol,o.startCol),r=Math.max(h.endCol,o.endCol),e=Math.min(h.startRow,o.startRow),n=Math.max(h.endRow,o.endRow);return t._createRegion(a,r,e,n)},t._getRegion=function(h,o){var a=o.bounds,r=Math.floor(a.min.x/h.bucketWidth),e=Math.floor(a.max.x/h.bucketWidth),n=Math.floor(a.min.y/h.bucketHeight),c=Math.floor(a.max.y/h.bucketHeight);return t._createRegion(r,e,n,c)},t._createRegion=function(h,o,a,r){return{id:h+","+o+","+a+","+r,startCol:h,endCol:o,startRow:a,endRow:r}},t._getBucketId=function(h,o){return"C"+h+"R"+o},t._createBucket=function(h,o){var a=h[o]=[];return a},t._bucketAddBody=function(h,o,a){for(var r=0;r<o.length;r++){var e=o[r];if(!(a.id===e.id||a.isStatic&&e.isStatic)){var n=f.id(a,e),c=h.pairs[n];c?c[2]+=1:h.pairs[n]=[a,e,1]}}o.push(a)},t._bucketRemoveBody=function(h,o,a){o.splice(i.indexOf(o,a),1);for(var r=0;r<o.length;r++){var e=o[r],n=f.id(a,e),c=h.pairs[n];c&&(c[2]-=1)}},t._createActivePairsList=function(h){var o,a,r=[];o=i.keys(h.pairs);for(var e=0;e<o.length;e++)a=h.pairs[o[e]],a[2]>0?r.push(a):delete h.pairs[o[e]];return r}})()},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(x,M,B){var t={};M.exports=t;var f=x("./Contact");(function(){t.create=function(s,i){var h=s.bodyA,o=s.bodyB,a=s.parentA,r=s.parentB,e={id:t.id(h,o),bodyA:h,bodyB:o,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:h.isSensor||o.isSensor,timeCreated:i,timeUpdated:i,inverseMass:a.inverseMass+r.inverseMass,friction:Math.min(a.friction,r.friction),frictionStatic:Math.max(a.frictionStatic,r.frictionStatic),restitution:Math.max(a.restitution,r.restitution),slop:Math.max(a.slop,r.slop)};return t.update(e,s,i),e},t.update=function(s,i,h){var o=s.contacts,a=i.supports,r=s.activeContacts,e=i.parentA,n=i.parentB;if(s.collision=i,s.inverseMass=e.inverseMass+n.inverseMass,s.friction=Math.min(e.friction,n.friction),s.frictionStatic=Math.max(e.frictionStatic,n.frictionStatic),s.restitution=Math.max(e.restitution,n.restitution),s.slop=Math.max(e.slop,n.slop),r.length=0,i.collided){for(var c=0;c<a.length;c++){var l=a[c],m=f.id(l),d=o[m];d?r.push(d):r.push(o[m]=f.create(l))}s.separation=i.depth,t.setActive(s,!0,h)}else s.isActive===!0&&t.setActive(s,!1,h)},t.setActive=function(s,i,h){i?(s.isActive=!0,s.timeUpdated=h):(s.isActive=!1,s.activeContacts.length=0)},t.id=function(s,i){return s.id<i.id?"A"+s.id+"B"+i.id:"A"+i.id+"B"+s.id}})()},{"./Contact":4}],8:[function(x,M,B){var t={};M.exports=t;var f=x("./Pair"),s=x("../core/Common");(function(){t._pairMaxIdleLife=1e3,t.create=function(i){return s.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},i)},t.update=function(i,h,o){var a=i.list,r=i.table,e=i.collisionStart,n=i.collisionEnd,c=i.collisionActive,l=[],m,d,v,u;for(e.length=0,n.length=0,c.length=0,u=0;u<h.length;u++)m=h[u],m.collided&&(d=f.id(m.bodyA,m.bodyB),l.push(d),v=r[d],v?(v.isActive?c.push(v):e.push(v),f.update(v,m,o)):(v=f.create(m,o),r[d]=v,e.push(v),a.push(v)));for(u=0;u<a.length;u++)v=a[u],v.isActive&&s.indexOf(l,v.id)===-1&&(f.setActive(v,!1,o),n.push(v))},t.removeOld=function(i,h){var o=i.list,a=i.table,r=[],e,n,c,l;for(l=0;l<o.length;l++){if(e=o[l],n=e.collision,n.bodyA.isSleeping||n.bodyB.isSleeping){e.timeUpdated=h;continue}h-e.timeUpdated>t._pairMaxIdleLife&&r.push(l)}for(l=0;l<r.length;l++)c=r[l]-l,e=o[c],delete a[e.id],o.splice(c,1)},t.clear=function(i){return i.table={},i.list.length=0,i.collisionStart.length=0,i.collisionActive.length=0,i.collisionEnd.length=0,i}})()},{"../core/Common":14,"./Pair":7}],9:[function(x,M,B){var t={};M.exports=t;var f=x("../geometry/Vector"),s=x("./SAT"),i=x("../geometry/Bounds"),h=x("../factory/Bodies"),o=x("../geometry/Vertices");(function(){t.collides=function(a,r){for(var e=[],n=0;n<r.length;n++){var c=r[n];if(i.overlaps(c.bounds,a.bounds))for(var l=c.parts.length===1?0:1;l<c.parts.length;l++){var m=c.parts[l];if(i.overlaps(m.bounds,a.bounds)){var d=s.collides(m,a);if(d.collided){e.push(d);break}}}}return e},t.ray=function(a,r,e,n){n=n||1e-100;for(var c=f.angle(r,e),l=f.magnitude(f.sub(r,e)),m=(e.x+r.x)*.5,d=(e.y+r.y)*.5,v=h.rectangle(m,d,l,n,{angle:c}),u=t.collides(v,a),p=0;p<u.length;p+=1){var g=u[p];g.body=g.bodyB=g.bodyA}return u},t.region=function(a,r,e){for(var n=[],c=0;c<a.length;c++){var l=a[c],m=i.overlaps(l.bounds,r);(m&&!e||!m&&e)&&n.push(l)}return n},t.point=function(a,r){for(var e=[],n=0;n<a.length;n++){var c=a[n];if(i.contains(c.bounds,r))for(var l=c.parts.length===1?0:1;l<c.parts.length;l++){var m=c.parts[l];if(i.contains(m.bounds,r)&&o.contains(m.vertices,r)){e.push(c);break}}}return e}})()},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(x,M,B){var t={};M.exports=t;var f=x("../geometry/Vertices"),s=x("../geometry/Vector"),i=x("../core/Common"),h=x("../geometry/Bounds");(function(){t._restingThresh=4,t._restingThreshTangent=6,t._positionDampen=.9,t._positionWarming=.8,t._frictionNormalMultiplier=5,t.preSolvePosition=function(o){var a,r,e;for(a=0;a<o.length;a++)r=o[a],r.isActive&&(e=r.activeContacts.length,r.collision.parentA.totalContacts+=e,r.collision.parentB.totalContacts+=e)},t.solvePosition=function(o,a){var r,e,n,c,l,m,d,v,u,p=s._temp[0],g=s._temp[1],w=s._temp[2],y=s._temp[3];for(r=0;r<o.length;r++)e=o[r],!(!e.isActive||e.isSensor)&&(n=e.collision,c=n.parentA,l=n.parentB,m=n.normal,d=s.sub(s.add(l.positionImpulse,l.position,p),s.add(c.positionImpulse,s.sub(l.position,n.penetration,g),w),y),e.separation=s.dot(m,d));for(r=0;r<o.length;r++)e=o[r],!(!e.isActive||e.isSensor)&&(n=e.collision,c=n.parentA,l=n.parentB,m=n.normal,u=(e.separation-e.slop)*a,(c.isStatic||l.isStatic)&&(u*=2),c.isStatic||c.isSleeping||(v=t._positionDampen/c.totalContacts,c.positionImpulse.x+=m.x*u*v,c.positionImpulse.y+=m.y*u*v),l.isStatic||l.isSleeping||(v=t._positionDampen/l.totalContacts,l.positionImpulse.x-=m.x*u*v,l.positionImpulse.y-=m.y*u*v))},t.postSolvePosition=function(o){for(var a=0;a<o.length;a++){var r=o[a];if(r.totalContacts=0,r.positionImpulse.x!==0||r.positionImpulse.y!==0){for(var e=0;e<r.parts.length;e++){var n=r.parts[e];f.translate(n.vertices,r.positionImpulse),h.update(n.bounds,n.vertices,r.velocity),n.position.x+=r.positionImpulse.x,n.position.y+=r.positionImpulse.y}r.positionPrev.x+=r.positionImpulse.x,r.positionPrev.y+=r.positionImpulse.y,s.dot(r.positionImpulse,r.velocity)<0?(r.positionImpulse.x=0,r.positionImpulse.y=0):(r.positionImpulse.x*=t._positionWarming,r.positionImpulse.y*=t._positionWarming)}}},t.preSolveVelocity=function(o){var a,r,e,n,c,l,m,d,v,u,p,g,w,y,S=s._temp[0],C=s._temp[1];for(a=0;a<o.length;a++)if(e=o[a],!(!e.isActive||e.isSensor))for(n=e.activeContacts,c=e.collision,l=c.parentA,m=c.parentB,d=c.normal,v=c.tangent,r=0;r<n.length;r++)u=n[r],p=u.vertex,g=u.normalImpulse,w=u.tangentImpulse,(g!==0||w!==0)&&(S.x=d.x*g+v.x*w,S.y=d.y*g+v.y*w,l.isStatic||l.isSleeping||(y=s.sub(p,l.position,C),l.positionPrev.x+=S.x*l.inverseMass,l.positionPrev.y+=S.y*l.inverseMass,l.anglePrev+=s.cross(y,S)*l.inverseInertia),m.isStatic||m.isSleeping||(y=s.sub(p,m.position,C),m.positionPrev.x-=S.x*m.inverseMass,m.positionPrev.y-=S.y*m.inverseMass,m.anglePrev-=s.cross(y,S)*m.inverseInertia))},t.solveVelocity=function(o,a){for(var r=a*a,e=s._temp[0],n=s._temp[1],c=s._temp[2],l=s._temp[3],m=s._temp[4],d=s._temp[5],v=0;v<o.length;v++){var u=o[v];if(!(!u.isActive||u.isSensor)){var p=u.collision,g=p.parentA,w=p.parentB,y=p.normal,S=p.tangent,C=u.activeContacts,P=1/C.length;g.velocity.x=g.position.x-g.positionPrev.x,g.velocity.y=g.position.y-g.positionPrev.y,w.velocity.x=w.position.x-w.positionPrev.x,w.velocity.y=w.position.y-w.positionPrev.y,g.angularVelocity=g.angle-g.anglePrev,w.angularVelocity=w.angle-w.anglePrev;for(var k=0;k<C.length;k++){var I=C[k],T=I.vertex,R=s.sub(T,g.position,n),E=s.sub(T,w.position,c),L=s.add(g.velocity,s.mult(s.perp(R),g.angularVelocity),l),b=s.add(w.velocity,s.mult(s.perp(E),w.angularVelocity),m),V=s.sub(L,b,d),O=s.dot(y,V),W=s.dot(S,V),z=Math.abs(W),G=i.sign(W),U=(1+u.restitution)*O,_=i.clamp(u.separation+O,0,1)*t._frictionNormalMultiplier,N=W,H=1/0;z>u.friction*u.frictionStatic*_*r&&(H=z,N=i.clamp(u.friction*G*r,-H,H));var Q=s.cross(R,y),Y=s.cross(E,y),$=P/(g.inverseMass+w.inverseMass+g.inverseInertia*Q*Q+w.inverseInertia*Y*Y);if(U*=$,N*=$,O<0&&O*O>t._restingThresh*r)I.normalImpulse=0;else{var q=I.normalImpulse;I.normalImpulse=Math.min(I.normalImpulse+U,0),U=I.normalImpulse-q}if(W*W>t._restingThreshTangent*r)I.tangentImpulse=0;else{var j=I.tangentImpulse;I.tangentImpulse=i.clamp(I.tangentImpulse+N,-H,H),N=I.tangentImpulse-j}e.x=y.x*U+S.x*N,e.y=y.y*U+S.y*N,g.isStatic||g.isSleeping||(g.positionPrev.x+=e.x*g.inverseMass,g.positionPrev.y+=e.y*g.inverseMass,g.anglePrev+=s.cross(R,e)*g.inverseInertia),w.isStatic||w.isSleeping||(w.positionPrev.x-=e.x*w.inverseMass,w.positionPrev.y-=e.y*w.inverseMass,w.anglePrev-=s.cross(E,e)*w.inverseInertia)}}}}})()},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(x,M,B){var t={};M.exports=t;var f=x("../geometry/Vertices"),s=x("../geometry/Vector");(function(){t.collides=function(i,h,o){var a,r,e,n,c=!1;if(o){var l=i.parent,m=h.parent,d=l.speed*l.speed+l.angularSpeed*l.angularSpeed+m.speed*m.speed+m.angularSpeed*m.angularSpeed;c=o&&o.collided&&d<.2,n=o}else n={collided:!1,bodyA:i,bodyB:h};if(o&&c){var v=n.axisBody,u=v===i?h:i,p=[v.axes[o.axisNumber]];if(e=t._overlapAxes(v.vertices,u.vertices,p),n.reused=!0,e.overlap<=0)return n.collided=!1,n}else{if(a=t._overlapAxes(i.vertices,h.vertices,i.axes),a.overlap<=0||(r=t._overlapAxes(h.vertices,i.vertices,h.axes),r.overlap<=0))return n.collided=!1,n;a.overlap<r.overlap?(e=a,n.axisBody=i):(e=r,n.axisBody=h),n.axisNumber=e.axisNumber}n.bodyA=i.id<h.id?i:h,n.bodyB=i.id<h.id?h:i,n.collided=!0,n.depth=e.overlap,n.parentA=n.bodyA.parent,n.parentB=n.bodyB.parent,i=n.bodyA,h=n.bodyB,s.dot(e.axis,s.sub(h.position,i.position))<0?n.normal={x:e.axis.x,y:e.axis.y}:n.normal={x:-e.axis.x,y:-e.axis.y},n.tangent=s.perp(n.normal),n.penetration=n.penetration||{},n.penetration.x=n.normal.x*n.depth,n.penetration.y=n.normal.y*n.depth;var g=t._findSupports(i,h,n.normal),w=[];if(f.contains(i.vertices,g[0])&&w.push(g[0]),f.contains(i.vertices,g[1])&&w.push(g[1]),w.length<2){var y=t._findSupports(h,i,s.neg(n.normal));f.contains(h.vertices,y[0])&&w.push(y[0]),w.length<2&&f.contains(h.vertices,y[1])&&w.push(y[1])}return w.length<1&&(w=[g[0]]),n.supports=w,n},t._overlapAxes=function(i,h,o){for(var a=s._temp[0],r=s._temp[1],e={overlap:Number.MAX_VALUE},n,c,l=0;l<o.length;l++){if(c=o[l],t._projectToAxis(a,i,c),t._projectToAxis(r,h,c),n=Math.min(a.max-r.min,r.max-a.min),n<=0)return e.overlap=n,e;n<e.overlap&&(e.overlap=n,e.axis=c,e.axisNumber=l)}return e},t._projectToAxis=function(i,h,o){for(var a=s.dot(h[0],o),r=a,e=1;e<h.length;e+=1){var n=s.dot(h[e],o);n>r?r=n:n<a&&(a=n)}i.min=a,i.max=r},t._findSupports=function(i,h,o){for(var a=Number.MAX_VALUE,r=s._temp[0],e=h.vertices,n=i.position,c,l,m,d,v=0;v<e.length;v++)l=e[v],r.x=l.x-n.x,r.y=l.y-n.y,c=-s.dot(o,r),c<a&&(a=c,m=l);var u=m.index-1>=0?m.index-1:e.length-1;l=e[u],r.x=l.x-n.x,r.y=l.y-n.y,a=-s.dot(o,r),d=l;var p=(m.index+1)%e.length;return l=e[p],r.x=l.x-n.x,r.y=l.y-n.y,c=-s.dot(o,r),c<a&&(d=l),[m,d]}})()},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(x,M,B){var t={};M.exports=t;var f=x("../geometry/Vertices"),s=x("../geometry/Vector"),i=x("../core/Sleeping"),h=x("../geometry/Bounds"),o=x("../geometry/Axes"),a=x("../core/Common");(function(){t._warming=.4,t._torqueDampen=1,t._minLength=1e-6,t.create=function(r){var e=r;e.bodyA&&!e.pointA&&(e.pointA={x:0,y:0}),e.bodyB&&!e.pointB&&(e.pointB={x:0,y:0});var n=e.bodyA?s.add(e.bodyA.position,e.pointA):e.pointA,c=e.bodyB?s.add(e.bodyB.position,e.pointB):e.pointB,l=s.magnitude(s.sub(n,c));e.length=typeof e.length<"u"?e.length:l,e.id=e.id||a.nextId(),e.label=e.label||"Constraint",e.type="constraint",e.stiffness=e.stiffness||(e.length>0?1:.7),e.damping=e.damping||0,e.angularStiffness=e.angularStiffness||0,e.angleA=e.bodyA?e.bodyA.angle:e.angleA,e.angleB=e.bodyB?e.bodyB.angle:e.angleB,e.plugin={};var m={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return e.length===0&&e.stiffness>.1?(m.type="pin",m.anchors=!1):e.stiffness<.9&&(m.type="spring"),e.render=a.extend(m,e.render),e},t.preSolveAll=function(r){for(var e=0;e<r.length;e+=1){var n=r[e],c=n.constraintImpulse;n.isStatic||c.x===0&&c.y===0&&c.angle===0||(n.position.x+=c.x,n.position.y+=c.y,n.angle+=c.angle)}},t.solveAll=function(r,e){for(var n=0;n<r.length;n+=1){var c=r[n],l=!c.bodyA||c.bodyA&&c.bodyA.isStatic,m=!c.bodyB||c.bodyB&&c.bodyB.isStatic;(l||m)&&t.solve(r[n],e)}for(n=0;n<r.length;n+=1)c=r[n],l=!c.bodyA||c.bodyA&&c.bodyA.isStatic,m=!c.bodyB||c.bodyB&&c.bodyB.isStatic,!l&&!m&&t.solve(r[n],e)},t.solve=function(r,e){var n=r.bodyA,c=r.bodyB,l=r.pointA,m=r.pointB;if(!(!n&&!c)){n&&!n.isStatic&&(s.rotate(l,n.angle-r.angleA,l),r.angleA=n.angle),c&&!c.isStatic&&(s.rotate(m,c.angle-r.angleB,m),r.angleB=c.angle);var d=l,v=m;if(n&&(d=s.add(n.position,l)),c&&(v=s.add(c.position,m)),!(!d||!v)){var u=s.sub(d,v),p=s.magnitude(u);p<t._minLength&&(p=t._minLength);var g=(p-r.length)/p,w=r.stiffness<1?r.stiffness*e:r.stiffness,y=s.mult(u,g*w),S=(n?n.inverseMass:0)+(c?c.inverseMass:0),C=(n?n.inverseInertia:0)+(c?c.inverseInertia:0),P=S+C,k,I,T,R,E;if(r.damping){var L=s.create();T=s.div(u,p),E=s.sub(c&&s.sub(c.position,c.positionPrev)||L,n&&s.sub(n.position,n.positionPrev)||L),R=s.dot(T,E)}n&&!n.isStatic&&(I=n.inverseMass/S,n.constraintImpulse.x-=y.x*I,n.constraintImpulse.y-=y.y*I,n.position.x-=y.x*I,n.position.y-=y.y*I,r.damping&&(n.positionPrev.x-=r.damping*T.x*R*I,n.positionPrev.y-=r.damping*T.y*R*I),k=s.cross(l,y)/P*t._torqueDampen*n.inverseInertia*(1-r.angularStiffness),n.constraintImpulse.angle-=k,n.angle-=k),c&&!c.isStatic&&(I=c.inverseMass/S,c.constraintImpulse.x+=y.x*I,c.constraintImpulse.y+=y.y*I,c.position.x+=y.x*I,c.position.y+=y.y*I,r.damping&&(c.positionPrev.x+=r.damping*T.x*R*I,c.positionPrev.y+=r.damping*T.y*R*I),k=s.cross(m,y)/P*t._torqueDampen*c.inverseInertia*(1-r.angularStiffness),c.constraintImpulse.angle+=k,c.angle+=k)}}},t.postSolveAll=function(r){for(var e=0;e<r.length;e++){var n=r[e],c=n.constraintImpulse;if(!(n.isStatic||c.x===0&&c.y===0&&c.angle===0)){i.set(n,!1);for(var l=0;l<n.parts.length;l++){var m=n.parts[l];f.translate(m.vertices,c),l>0&&(m.position.x+=c.x,m.position.y+=c.y),c.angle!==0&&(f.rotate(m.vertices,c.angle,n.position),o.rotate(m.axes,c.angle),l>0&&s.rotateAbout(m.position,c.angle,n.position,m.position)),h.update(m.bounds,m.vertices,n.velocity)}c.angle*=t._warming,c.x*=t._warming,c.y*=t._warming}}}})()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(x,M,B){var t={};M.exports=t;var f=x("../geometry/Vertices"),s=x("../core/Sleeping"),i=x("../core/Mouse"),h=x("../core/Events"),o=x("../collision/Detector"),a=x("./Constraint"),r=x("../body/Composite"),e=x("../core/Common"),n=x("../geometry/Bounds");(function(){t.create=function(c,l){var m=(c?c.mouse:null)||(l?l.mouse:null);m||(c&&c.render&&c.render.canvas?m=i.create(c.render.canvas):l&&l.element?m=i.create(l.element):(m=i.create(),e.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var d=a.create({label:"Mouse Constraint",pointA:m.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),v={type:"mouseConstraint",mouse:m,element:null,body:null,constraint:d,collisionFilter:{category:1,mask:4294967295,group:0}},u=e.extend(v,l);return h.on(c,"beforeUpdate",function(){var p=r.allBodies(c.world);t.update(u,p),t._triggerEvents(u)}),u},t.update=function(c,l){var m=c.mouse,d=c.constraint,v=c.body;if(m.button===0){if(d.bodyB)s.set(d.bodyB,!1),d.pointA=m.position;else for(var u=0;u<l.length;u++)if(v=l[u],n.contains(v.bounds,m.position)&&o.canCollide(v.collisionFilter,c.collisionFilter))for(var p=v.parts.length>1?1:0;p<v.parts.length;p++){var g=v.parts[p];if(f.contains(g.vertices,m.position)){d.pointA=m.position,d.bodyB=c.body=v,d.pointB={x:m.position.x-v.position.x,y:m.position.y-v.position.y},d.angleB=v.angle,s.set(v,!1),h.trigger(c,"startdrag",{mouse:m,body:v});break}}}else d.bodyB=c.body=null,d.pointB=null,v&&h.trigger(c,"enddrag",{mouse:m,body:v})},t._triggerEvents=function(c){var l=c.mouse,m=l.sourceEvents;m.mousemove&&h.trigger(c,"mousemove",{mouse:l}),m.mousedown&&h.trigger(c,"mousedown",{mouse:l}),m.mouseup&&h.trigger(c,"mouseup",{mouse:l}),i.clearSourceEvents(l)}})()},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(x,M,B){(function(t){var f={};M.exports=f,function(){f._nextId=0,f._seed=0,f._nowStartTime=+new Date,f.extend=function(i,h){var o,a;typeof h=="boolean"?(o=2,a=h):(o=1,a=!0);for(var r=o;r<arguments.length;r++){var e=arguments[r];if(e)for(var n in e)a&&e[n]&&e[n].constructor===Object&&(!i[n]||i[n].constructor===Object)?(i[n]=i[n]||{},f.extend(i[n],a,e[n])):i[n]=e[n]}return i},f.clone=function(i,h){return f.extend({},h,i)},f.keys=function(i){if(Object.keys)return Object.keys(i);var h=[];for(var o in i)h.push(o);return h},f.values=function(i){var h=[];if(Object.keys){for(var o=Object.keys(i),a=0;a<o.length;a++)h.push(i[o[a]]);return h}for(var r in i)h.push(i[r]);return h},f.get=function(i,h,o,a){h=h.split(".").slice(o,a);for(var r=0;r<h.length;r+=1)i=i[h[r]];return i},f.set=function(i,h,o,a,r){var e=h.split(".").slice(a,r);return f.get(i,h,0,-1)[e[e.length-1]]=o,o},f.shuffle=function(i){for(var h=i.length-1;h>0;h--){var o=Math.floor(f.random()*(h+1)),a=i[h];i[h]=i[o],i[o]=a}return i},f.choose=function(i){return i[Math.floor(f.random()*i.length)]},f.isElement=function(i){return typeof HTMLElement<"u"?i instanceof HTMLElement:!!(i&&i.nodeType&&i.nodeName)},f.isArray=function(i){return Object.prototype.toString.call(i)==="[object Array]"},f.isFunction=function(i){return typeof i=="function"},f.isPlainObject=function(i){return typeof i=="object"&&i.constructor===Object},f.isString=function(i){return toString.call(i)==="[object String]"},f.clamp=function(i,h,o){return i<h?h:i>o?o:i},f.sign=function(i){return i<0?-1:1},f.now=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-f._nowStartTime},f.random=function(i,h){return i=typeof i<"u"?i:0,h=typeof h<"u"?h:1,i+s()*(h-i)};var s=function(){return f._seed=(f._seed*9301+49297)%233280,f._seed/233280};f.colorToNumber=function(i){return i=i.replace("#",""),i.length==3&&(i=i.charAt(0)+i.charAt(0)+i.charAt(1)+i.charAt(1)+i.charAt(2)+i.charAt(2)),parseInt(i,16)},f.logLevel=1,f.log=function(){console&&f.logLevel>0&&f.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},f.info=function(){console&&f.logLevel>0&&f.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},f.warn=function(){console&&f.logLevel>0&&f.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},f.nextId=function(){return f._nextId++},f.indexOf=function(i,h){if(i.indexOf)return i.indexOf(h);for(var o=0;o<i.length;o++)if(i[o]===h)return o;return-1},f.map=function(i,h){if(i.map)return i.map(h);for(var o=[],a=0;a<i.length;a+=1)o.push(h(i[a]));return o},f.topologicalSort=function(i){var h=[],o=[],a=[];for(var r in i)!o[r]&&!a[r]&&f._topologicalSort(r,o,a,i,h);return h},f._topologicalSort=function(i,h,o,a,r){var e=a[i]||[];o[i]=!0;for(var n=0;n<e.length;n+=1){var c=e[n];o[c]||h[c]||f._topologicalSort(c,h,o,a,r)}o[i]=!1,h[i]=!0,r.push(i)},f.chain=function(){for(var i=[],h=0;h<arguments.length;h+=1){var o=arguments[h];o._chained?i.push.apply(i,o._chained):i.push(o)}var a=function(){for(var r,e=new Array(arguments.length),n=0,c=arguments.length;n<c;n++)e[n]=arguments[n];for(n=0;n<i.length;n+=1){var l=i[n].apply(r,e);typeof l<"u"&&(r=l)}return r};return a._chained=i,a},f.chainPathBefore=function(i,h,o){return f.set(i,h,f.chain(o,f.get(i,h)))},f.chainPathAfter=function(i,h,o){return f.set(i,h,f.chain(f.get(i,h),o))},f._requireGlobal=function(i,h){var o=typeof window<"u"?window[i]:typeof t<"u"?t[i]:null;return o||x(h)}}()}).call(this,typeof Z<"u"?Z:typeof self<"u"?self:typeof window<"u"?window:{})},{}],15:[function(x,M,B){var t={};M.exports=t;var f=x("../body/World"),s=x("./Sleeping"),i=x("../collision/Resolver"),h=x("../render/Render"),o=x("../collision/Pairs");x("./Metrics");var a=x("../collision/Grid"),r=x("./Events"),e=x("../body/Composite"),n=x("../constraint/Constraint"),c=x("./Common"),l=x("../body/Body");(function(){t.create=function(m,d){d=c.isElement(m)?d:m,m=c.isElement(m)?m:null,d=d||{},(m||d.render)&&c.warn("Engine.create: engine.render is deprecated (see docs)");var v={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:a}},u=c.extend(v,d);if(m||u.render){var p={element:m,controller:h};u.render=c.extend(p,u.render)}return u.render&&u.render.controller&&(u.render=u.render.controller.create(u.render)),u.render&&(u.render.engine=u),u.world=d.world||f.create(u.world),u.pairs=o.create(),u.broadphase=u.broadphase.controller.create(u.broadphase),u.metrics=u.metrics||{extended:!1},u},t.update=function(m,d,v){d=d||1e3/60,v=v||1;var u=m.world,p=m.timing,g=m.broadphase,w=[],y;p.timestamp+=d*p.timeScale;var S={timestamp:p.timestamp};r.trigger(m,"beforeUpdate",S);var C=e.allBodies(u),P=e.allConstraints(u);for(m.enableSleeping&&s.update(C,p.timeScale),t._bodiesApplyGravity(C,u.gravity),t._bodiesUpdate(C,d,p.timeScale,v,u.bounds),n.preSolveAll(C),y=0;y<m.constraintIterations;y++)n.solveAll(P,p.timeScale);n.postSolveAll(C),g.controller?(u.isModified&&g.controller.clear(g),g.controller.update(g,C,m,u.isModified),w=g.pairsList):w=C,u.isModified&&e.setModified(u,!1,!1,!0);var k=g.detector(w,m),I=m.pairs,T=p.timestamp;for(o.update(I,k,T),o.removeOld(I,T),m.enableSleeping&&s.afterCollisions(I.list,p.timeScale),I.collisionStart.length>0&&r.trigger(m,"collisionStart",{pairs:I.collisionStart}),i.preSolvePosition(I.list),y=0;y<m.positionIterations;y++)i.solvePosition(I.list,p.timeScale);for(i.postSolvePosition(C),n.preSolveAll(C),y=0;y<m.constraintIterations;y++)n.solveAll(P,p.timeScale);for(n.postSolveAll(C),i.preSolveVelocity(I.list),y=0;y<m.velocityIterations;y++)i.solveVelocity(I.list,p.timeScale);return I.collisionActive.length>0&&r.trigger(m,"collisionActive",{pairs:I.collisionActive}),I.collisionEnd.length>0&&r.trigger(m,"collisionEnd",{pairs:I.collisionEnd}),t._bodiesClearForces(C),r.trigger(m,"afterUpdate",S),m},t.merge=function(m,d){if(c.extend(m,d),d.world){m.world=d.world,t.clear(m);for(var v=e.allBodies(m.world),u=0;u<v.length;u++){var p=v[u];s.set(p,!1),p.id=c.nextId()}}},t.clear=function(m){var d=m.world;o.clear(m.pairs);var v=m.broadphase;if(v.controller){var u=e.allBodies(d);v.controller.clear(v),v.controller.update(v,u,m,!0)}},t._bodiesClearForces=function(m){for(var d=0;d<m.length;d++){var v=m[d];v.force.x=0,v.force.y=0,v.torque=0}},t._bodiesApplyGravity=function(m,d){var v=typeof d.scale<"u"?d.scale:.001;if(!(d.x===0&&d.y===0||v===0))for(var u=0;u<m.length;u++){var p=m[u];p.isStatic||p.isSleeping||(p.force.y+=p.mass*d.y*v,p.force.x+=p.mass*d.x*v)}},t._bodiesUpdate=function(m,d,v,u,p){for(var g=0;g<m.length;g++){var w=m[g];w.isStatic||w.isSleeping||l.update(w,d,v,u)}}})()},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(x,M,B){var t={};M.exports=t;var f=x("./Common");(function(){t.on=function(s,i,h){for(var o=i.split(" "),a,r=0;r<o.length;r++)a=o[r],s.events=s.events||{},s.events[a]=s.events[a]||[],s.events[a].push(h);return h},t.off=function(s,i,h){if(!i){s.events={};return}typeof i=="function"&&(h=i,i=f.keys(s.events).join(" "));for(var o=i.split(" "),a=0;a<o.length;a++){var r=s.events[o[a]],e=[];if(h&&r)for(var n=0;n<r.length;n++)r[n]!==h&&e.push(r[n]);s.events[o[a]]=e}},t.trigger=function(s,i,h){var o,a,r,e;if(s.events){h||(h={}),o=i.split(" ");for(var n=0;n<o.length;n++)if(a=o[n],r=s.events[a],r){e=f.clone(h,!1),e.name=a,e.source=s;for(var c=0;c<r.length;c++)r[c].apply(s,[e])}}}})()},{"./Common":14}],17:[function(x,M,B){var t={};M.exports=t;var f=x("./Plugin"),s=x("./Common");(function(){t.name="matter-js",t.version="0.14.2",t.uses=[],t.used=[],t.use=function(){f.use(t,Array.prototype.slice.call(arguments))},t.before=function(i,h){return i=i.replace(/^Matter./,""),s.chainPathBefore(t,i,h)},t.after=function(i,h){return i=i.replace(/^Matter./,""),s.chainPathAfter(t,i,h)}})()},{"./Common":14,"./Plugin":20}],18:[function(x,M,B){},{"../body/Composite":2,"./Common":14}],19:[function(x,M,B){var t={};M.exports=t;var f=x("../core/Common");(function(){t.create=function(s){var i={};return s||f.log("Mouse.create: element was undefined, defaulting to document.body","warn"),i.element=s||document.body,i.absolute={x:0,y:0},i.position={x:0,y:0},i.mousedownPosition={x:0,y:0},i.mouseupPosition={x:0,y:0},i.offset={x:0,y:0},i.scale={x:1,y:1},i.wheelDelta=0,i.button=-1,i.pixelRatio=i.element.getAttribute("data-pixel-ratio")||1,i.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},i.mousemove=function(h){var o=t._getRelativeMousePosition(h,i.element,i.pixelRatio),a=h.changedTouches;a&&(i.button=0,h.preventDefault()),i.absolute.x=o.x,i.absolute.y=o.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y,i.sourceEvents.mousemove=h},i.mousedown=function(h){var o=t._getRelativeMousePosition(h,i.element,i.pixelRatio),a=h.changedTouches;a?(i.button=0,h.preventDefault()):i.button=h.button,i.absolute.x=o.x,i.absolute.y=o.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y,i.mousedownPosition.x=i.position.x,i.mousedownPosition.y=i.position.y,i.sourceEvents.mousedown=h},i.mouseup=function(h){var o=t._getRelativeMousePosition(h,i.element,i.pixelRatio),a=h.changedTouches;a&&h.preventDefault(),i.button=-1,i.absolute.x=o.x,i.absolute.y=o.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y,i.mouseupPosition.x=i.position.x,i.mouseupPosition.y=i.position.y,i.sourceEvents.mouseup=h},i.mousewheel=function(h){i.wheelDelta=Math.max(-1,Math.min(1,h.wheelDelta||-h.detail)),h.preventDefault()},t.setElement(i,i.element),i},t.setElement=function(s,i){s.element=i,i.addEventListener("mousemove",s.mousemove),i.addEventListener("mousedown",s.mousedown),i.addEventListener("mouseup",s.mouseup),i.addEventListener("mousewheel",s.mousewheel),i.addEventListener("DOMMouseScroll",s.mousewheel),i.addEventListener("touchmove",s.mousemove),i.addEventListener("touchstart",s.mousedown),i.addEventListener("touchend",s.mouseup)},t.clearSourceEvents=function(s){s.sourceEvents.mousemove=null,s.sourceEvents.mousedown=null,s.sourceEvents.mouseup=null,s.sourceEvents.mousewheel=null,s.wheelDelta=0},t.setOffset=function(s,i){s.offset.x=i.x,s.offset.y=i.y,s.position.x=s.absolute.x*s.scale.x+s.offset.x,s.position.y=s.absolute.y*s.scale.y+s.offset.y},t.setScale=function(s,i){s.scale.x=i.x,s.scale.y=i.y,s.position.x=s.absolute.x*s.scale.x+s.offset.x,s.position.y=s.absolute.y*s.scale.y+s.offset.y},t._getRelativeMousePosition=function(s,i,h){var o=i.getBoundingClientRect(),a=document.documentElement||document.body.parentNode||document.body,r=window.pageXOffset!==void 0?window.pageXOffset:a.scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:a.scrollTop,n=s.changedTouches,c,l;return n?(c=n[0].pageX-o.left-r,l=n[0].pageY-o.top-e):(c=s.pageX-o.left-r,l=s.pageY-o.top-e),{x:c/(i.clientWidth/(i.width||i.clientWidth)*h),y:l/(i.clientHeight/(i.height||i.clientHeight)*h)}}})()},{"../core/Common":14}],20:[function(x,M,B){var t={};M.exports=t;var f=x("./Common");(function(){t._registry={},t.register=function(s){if(t.isPlugin(s)||f.warn("Plugin.register:",t.toString(s),"does not implement all required fields."),s.name in t._registry){var i=t._registry[s.name],h=t.versionParse(s.version).number,o=t.versionParse(i.version).number;h>o?(f.warn("Plugin.register:",t.toString(i),"was upgraded to",t.toString(s)),t._registry[s.name]=s):h<o?f.warn("Plugin.register:",t.toString(i),"can not be downgraded to",t.toString(s)):s!==i&&f.warn("Plugin.register:",t.toString(s),"is already registered to different plugin object")}else t._registry[s.name]=s;return s},t.resolve=function(s){return t._registry[t.dependencyParse(s).name]},t.toString=function(s){return typeof s=="string"?s:(s.name||"anonymous")+"@"+(s.version||s.range||"0.0.0")},t.isPlugin=function(s){return s&&s.name&&s.version&&s.install},t.isUsed=function(s,i){return s.used.indexOf(i)>-1},t.isFor=function(s,i){var h=s.for&&t.dependencyParse(s.for);return!s.for||i.name===h.name&&t.versionSatisfies(i.version,h.range)},t.use=function(s,i){if(s.uses=(s.uses||[]).concat(i||[]),s.uses.length===0){f.warn("Plugin.use:",t.toString(s),"does not specify any dependencies to install.");return}for(var h=t.dependencies(s),o=f.topologicalSort(h),a=[],r=0;r<o.length;r+=1)if(o[r]!==s.name){var e=t.resolve(o[r]);if(!e){a.push("❌ "+o[r]);continue}t.isUsed(s,e.name)||(t.isFor(e,s)||(f.warn("Plugin.use:",t.toString(e),"is for",e.for,"but installed on",t.toString(s)+"."),e._warned=!0),e.install?e.install(s):(f.warn("Plugin.use:",t.toString(e),"does not specify an install function."),e._warned=!0),e._warned?(a.push("🔶 "+t.toString(e)),delete e._warned):a.push("✅ "+t.toString(e)),s.used.push(e.name))}a.length>0&&f.info(a.join("  "))},t.dependencies=function(s,i){var h=t.dependencyParse(s),o=h.name;if(i=i||{},!(o in i)){s=t.resolve(s)||s,i[o]=f.map(s.uses||[],function(r){t.isPlugin(r)&&t.register(r);var e=t.dependencyParse(r),n=t.resolve(r);return n&&!t.versionSatisfies(n.version,e.range)?(f.warn("Plugin.dependencies:",t.toString(n),"does not satisfy",t.toString(e),"used by",t.toString(h)+"."),n._warned=!0,s._warned=!0):n||(f.warn("Plugin.dependencies:",t.toString(r),"used by",t.toString(h),"could not be resolved."),s._warned=!0),e.name});for(var a=0;a<i[o].length;a+=1)t.dependencies(i[o][a],i);return i}},t.dependencyParse=function(s){if(f.isString(s)){var i=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/;return i.test(s)||f.warn("Plugin.dependencyParse:",s,"is not a valid dependency string."),{name:s.split("@")[0],range:s.split("@")[1]||"*"}}return{name:s.name,range:s.range||s.version}},t.versionParse=function(s){var i=/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/;i.test(s)||f.warn("Plugin.versionParse:",s,"is not a valid version or range.");var h=s.split("-");s=h[0];var o=isNaN(Number(s[0])),a=o?s.substr(1):s,r=f.map(a.split("."),function(e){return Number(e)});return{isRange:o,version:a,range:s,operator:o?s[0]:"",parts:r,prerelease:h[1],number:r[0]*1e8+r[1]*1e4+r[2]}},t.versionSatisfies=function(s,i){i=i||"*";var h=t.versionParse(i),o=h.parts,a=t.versionParse(s),r=a.parts;if(h.isRange){if(h.operator==="*"||s==="*")return!0;if(h.operator==="~")return r[0]===o[0]&&r[1]===o[1]&&r[2]>=o[2];if(h.operator==="^")return o[0]>0?r[0]===o[0]&&a.number>=h.number:o[1]>0?r[1]===o[1]&&r[2]>=o[2]:r[2]===o[2]}return s===i||s==="*"}})()},{"./Common":14}],21:[function(x,M,B){var t={};M.exports=t;var f=x("./Events"),s=x("./Engine"),i=x("./Common");(function(){var h,o;if(typeof window<"u"&&(h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,o=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!h){var a;h=function(r){a=setTimeout(function(){r(i.now())},1e3/60)},o=function(){clearTimeout(a)}}t.create=function(r){var e={fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},n=i.extend(e,r);return n.delta=n.delta||1e3/n.fps,n.deltaMin=n.deltaMin||1e3/n.fps,n.deltaMax=n.deltaMax||1e3/(n.fps*.5),n.fps=1e3/n.delta,n},t.run=function(r,e){return typeof r.positionIterations<"u"&&(e=r,r=t.create()),function n(c){r.frameRequestId=h(n),c&&r.enabled&&t.tick(r,e,c)}(),r},t.tick=function(r,e,n){var c=e.timing,l=1,m,d={timestamp:c.timestamp};f.trigger(r,"beforeTick",d),f.trigger(e,"beforeTick",d),r.isFixed?m=r.delta:(m=n-r.timePrev||r.delta,r.timePrev=n,r.deltaHistory.push(m),r.deltaHistory=r.deltaHistory.slice(-r.deltaSampleSize),m=Math.min.apply(null,r.deltaHistory),m=m<r.deltaMin?r.deltaMin:m,m=m>r.deltaMax?r.deltaMax:m,l=m/r.delta,r.delta=m),r.timeScalePrev!==0&&(l*=c.timeScale/r.timeScalePrev),c.timeScale===0&&(l=0),r.timeScalePrev=c.timeScale,r.correction=l,r.frameCounter+=1,n-r.counterTimestamp>=1e3&&(r.fps=r.frameCounter*((n-r.counterTimestamp)/1e3),r.counterTimestamp=n,r.frameCounter=0),f.trigger(r,"tick",d),f.trigger(e,"tick",d),e.world.isModified&&e.render&&e.render.controller&&e.render.controller.clear&&e.render.controller.clear(e.render),f.trigger(r,"beforeUpdate",d),s.update(e,m,l),f.trigger(r,"afterUpdate",d),e.render&&e.render.controller&&(f.trigger(r,"beforeRender",d),f.trigger(e,"beforeRender",d),e.render.controller.world(e.render),f.trigger(r,"afterRender",d),f.trigger(e,"afterRender",d)),f.trigger(r,"afterTick",d),f.trigger(e,"afterTick",d)},t.stop=function(r){o(r.frameRequestId)},t.start=function(r,e){t.run(r,e)}})()},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(x,M,B){var t={};M.exports=t;var f=x("./Events");(function(){t._motionWakeThreshold=.18,t._motionSleepThreshold=.08,t._minBias=.9,t.update=function(s,i){for(var h=i*i*i,o=0;o<s.length;o++){var a=s[o],r=a.speed*a.speed+a.angularSpeed*a.angularSpeed;if(a.force.x!==0||a.force.y!==0){t.set(a,!1);continue}var e=Math.min(a.motion,r),n=Math.max(a.motion,r);a.motion=t._minBias*e+(1-t._minBias)*n,a.sleepThreshold>0&&a.motion<t._motionSleepThreshold*h?(a.sleepCounter+=1,a.sleepCounter>=a.sleepThreshold&&t.set(a,!0)):a.sleepCounter>0&&(a.sleepCounter-=1)}},t.afterCollisions=function(s,i){for(var h=i*i*i,o=0;o<s.length;o++){var a=s[o];if(a.isActive){var r=a.collision,e=r.bodyA.parent,n=r.bodyB.parent;if(!(e.isSleeping&&n.isSleeping||e.isStatic||n.isStatic)&&(e.isSleeping||n.isSleeping)){var c=e.isSleeping&&!e.isStatic?e:n,l=c===e?n:e;!c.isStatic&&l.motion>t._motionWakeThreshold*h&&t.set(c,!1)}}}},t.set=function(s,i){var h=s.isSleeping;i?(s.isSleeping=!0,s.sleepCounter=s.sleepThreshold,s.positionImpulse.x=0,s.positionImpulse.y=0,s.positionPrev.x=s.position.x,s.positionPrev.y=s.position.y,s.anglePrev=s.angle,s.speed=0,s.angularSpeed=0,s.motion=0,h||f.trigger(s,"sleepStart")):(s.isSleeping=!1,s.sleepCounter=0,h&&f.trigger(s,"sleepEnd"))}})()},{"./Events":16}],23:[function(x,M,B){var t={};M.exports=t;var f=x("../geometry/Vertices"),s=x("../core/Common"),i=x("../body/Body"),h=x("../geometry/Bounds"),o=x("../geometry/Vector"),a;(function(){t.rectangle=function(r,e,n,c,l){l=l||{};var m={label:"Rectangle Body",position:{x:r,y:e},vertices:f.fromPath("L 0 0 L "+n+" 0 L "+n+" "+c+" L 0 "+c)};if(l.chamfer){var d=l.chamfer;m.vertices=f.chamfer(m.vertices,d.radius,d.quality,d.qualityMin,d.qualityMax),delete l.chamfer}return i.create(s.extend({},m,l))},t.trapezoid=function(r,e,n,c,l,m){m=m||{},l*=.5;var d=(1-l*2)*n,v=n*l,u=v+d,p=u+v,g;l<.5?g="L 0 0 L "+v+" "+-c+" L "+u+" "+-c+" L "+p+" 0":g="L 0 0 L "+u+" "+-c+" L "+p+" 0";var w={label:"Trapezoid Body",position:{x:r,y:e},vertices:f.fromPath(g)};if(m.chamfer){var y=m.chamfer;w.vertices=f.chamfer(w.vertices,y.radius,y.quality,y.qualityMin,y.qualityMax),delete m.chamfer}return i.create(s.extend({},w,m))},t.circle=function(r,e,n,c,l){c=c||{};var m={label:"Circle Body",circleRadius:n};l=l||25;var d=Math.ceil(Math.max(10,Math.min(l,n)));return d%2===1&&(d+=1),t.polygon(r,e,d,n,s.extend({},m,c))},t.polygon=function(r,e,n,c,l){if(l=l||{},n<3)return t.circle(r,e,c,l);for(var m=2*Math.PI/n,d="",v=m*.5,u=0;u<n;u+=1){var p=v+u*m,g=Math.cos(p)*c,w=Math.sin(p)*c;d+="L "+g.toFixed(3)+" "+w.toFixed(3)+" "}var y={label:"Polygon Body",position:{x:r,y:e},vertices:f.fromPath(d)};if(l.chamfer){var S=l.chamfer;y.vertices=f.chamfer(y.vertices,S.radius,S.quality,S.qualityMin,S.qualityMax),delete l.chamfer}return i.create(s.extend({},y,l))},t.fromVertices=function(r,e,n,c,l,m,d){a||(a=s._requireGlobal("decomp","poly-decomp"));var v,u,p,g,w,y,S,C,P;for(c=c||{},u=[],l=typeof l<"u"?l:!1,m=typeof m<"u"?m:.01,d=typeof d<"u"?d:10,a||s.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),s.isArray(n[0])||(n=[n]),C=0;C<n.length;C+=1)if(g=n[C],p=f.isConvex(g),p||!a)p?g=f.clockwiseSort(g):g=f.hull(g),u.push({position:{x:r,y:e},vertices:g});else{var k=g.map(function(G){return[G.x,G.y]});a.makeCCW(k),m!==!1&&a.removeCollinearPoints(k,m);var I=a.quickDecomp(k);for(w=0;w<I.length;w++){var T=I[w],R=T.map(function(G){return{x:G[0],y:G[1]}});d>0&&f.area(R)<d||u.push({position:f.centre(R),vertices:R})}}for(w=0;w<u.length;w++)u[w]=i.create(s.extend(u[w],c));if(l){var E=5;for(w=0;w<u.length;w++){var L=u[w];for(y=w+1;y<u.length;y++){var b=u[y];if(h.overlaps(L.bounds,b.bounds)){var V=L.vertices,O=b.vertices;for(S=0;S<L.vertices.length;S++)for(P=0;P<b.vertices.length;P++){var W=o.magnitudeSquared(o.sub(V[(S+1)%V.length],O[P])),z=o.magnitudeSquared(o.sub(V[S],O[(P+1)%O.length]));W<E&&z<E&&(V[S].isInternal=!0,O[P].isInternal=!0)}}}}}return u.length>1?(v=i.create(s.extend({parts:u.slice(0)},c)),i.setPosition(v,{x:r,y:e}),v):u[0]}})()},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(x,M,B){var t={};M.exports=t;var f=x("../body/Composite"),s=x("../constraint/Constraint"),i=x("../core/Common"),h=x("../body/Body"),o=x("./Bodies");(function(){t.stack=function(a,r,e,n,c,l,m){for(var d=f.create({label:"Stack"}),v=a,u=r,p,g=0,w=0;w<n;w++){for(var y=0,S=0;S<e;S++){var C=m(v,u,S,w,p,g);if(C){var P=C.bounds.max.y-C.bounds.min.y,k=C.bounds.max.x-C.bounds.min.x;P>y&&(y=P),h.translate(C,{x:k*.5,y:P*.5}),v=C.bounds.max.x+c,f.addBody(d,C),p=C,g+=1}else v+=c}u+=y+l,v=a}return d},t.chain=function(a,r,e,n,c,l){for(var m=a.bodies,d=1;d<m.length;d++){var v=m[d-1],u=m[d],p=v.bounds.max.y-v.bounds.min.y,g=v.bounds.max.x-v.bounds.min.x,w=u.bounds.max.y-u.bounds.min.y,y=u.bounds.max.x-u.bounds.min.x,S={bodyA:v,pointA:{x:g*r,y:p*e},bodyB:u,pointB:{x:y*n,y:w*c}},C=i.extend(S,l);f.addConstraint(a,s.create(C))}return a.label+=" Chain",a},t.mesh=function(a,r,e,n,c){var l=a.bodies,m,d,v,u,p;for(m=0;m<e;m++){for(d=1;d<r;d++)v=l[d-1+m*r],u=l[d+m*r],f.addConstraint(a,s.create(i.extend({bodyA:v,bodyB:u},c)));if(m>0)for(d=0;d<r;d++)v=l[d+(m-1)*r],u=l[d+m*r],f.addConstraint(a,s.create(i.extend({bodyA:v,bodyB:u},c))),n&&d>0&&(p=l[d-1+(m-1)*r],f.addConstraint(a,s.create(i.extend({bodyA:p,bodyB:u},c)))),n&&d<r-1&&(p=l[d+1+(m-1)*r],f.addConstraint(a,s.create(i.extend({bodyA:p,bodyB:u},c))))}return a.label+=" Mesh",a},t.pyramid=function(a,r,e,n,c,l,m){return t.stack(a,r,e,n,c,l,function(d,v,u,p,g,w){var y=Math.min(n,Math.ceil(e/2)),S=g?g.bounds.max.x-g.bounds.min.x:0;if(!(p>y)){p=y-p;var C=p,P=e-1-p;if(!(u<C||u>P)){w===1&&h.translate(g,{x:(u+(e%2===1?1:-1))*S,y:0});var k=g?u*S:0;return m(a+k+u*c,v,u,p,g,w)}}})},t.newtonsCradle=function(a,r,e,n,c){for(var l=f.create({label:"Newtons Cradle"}),m=0;m<e;m++){var d=1.9,v=o.circle(a+m*(n*d),r+c,n,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),u=s.create({pointA:{x:a+m*(n*d),y:r},bodyB:v});f.addBody(l,v),f.addConstraint(l,u)}return l},t.car=function(a,r,e,n,c){var l=h.nextGroup(!0),m=20,d=-e*.5+m,v=e*.5-m,u=0,p=f.create({label:"Car"}),g=o.rectangle(a,r,e,n,{collisionFilter:{group:l},chamfer:{radius:n*.5},density:2e-4}),w=o.circle(a+d,r+u,c,{collisionFilter:{group:l},friction:.8}),y=o.circle(a+v,r+u,c,{collisionFilter:{group:l},friction:.8}),S=s.create({bodyB:g,pointB:{x:d,y:u},bodyA:w,stiffness:1,length:0}),C=s.create({bodyB:g,pointB:{x:v,y:u},bodyA:y,stiffness:1,length:0});return f.addBody(p,g),f.addBody(p,w),f.addBody(p,y),f.addConstraint(p,S),f.addConstraint(p,C),p},t.softBody=function(a,r,e,n,c,l,m,d,v,u){v=i.extend({inertia:1/0},v),u=i.extend({stiffness:.2,render:{type:"line",anchors:!1}},u);var p=t.stack(a,r,e,n,c,l,function(g,w){return o.circle(g,w,d,v)});return t.mesh(p,e,n,m,u),p.label="Soft Body",p}})()},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(x,M,B){var t={};M.exports=t;var f=x("../geometry/Vector"),s=x("../core/Common");(function(){t.fromVertices=function(i){for(var h={},o=0;o<i.length;o++){var a=(o+1)%i.length,r=f.normalise({x:i[a].y-i[o].y,y:i[o].x-i[a].x}),e=r.y===0?1/0:r.x/r.y;e=e.toFixed(3).toString(),h[e]=r}return s.values(h)},t.rotate=function(i,h){if(h!==0)for(var o=Math.cos(h),a=Math.sin(h),r=0;r<i.length;r++){var e=i[r],n;n=e.x*o-e.y*a,e.y=e.x*a+e.y*o,e.x=n}}})()},{"../core/Common":14,"../geometry/Vector":28}],26:[function(x,M,B){var t={};M.exports=t,function(){t.create=function(f){var s={min:{x:0,y:0},max:{x:0,y:0}};return f&&t.update(s,f),s},t.update=function(f,s,i){f.min.x=1/0,f.max.x=-1/0,f.min.y=1/0,f.max.y=-1/0;for(var h=0;h<s.length;h++){var o=s[h];o.x>f.max.x&&(f.max.x=o.x),o.x<f.min.x&&(f.min.x=o.x),o.y>f.max.y&&(f.max.y=o.y),o.y<f.min.y&&(f.min.y=o.y)}i&&(i.x>0?f.max.x+=i.x:f.min.x+=i.x,i.y>0?f.max.y+=i.y:f.min.y+=i.y)},t.contains=function(f,s){return s.x>=f.min.x&&s.x<=f.max.x&&s.y>=f.min.y&&s.y<=f.max.y},t.overlaps=function(f,s){return f.min.x<=s.max.x&&f.max.x>=s.min.x&&f.max.y>=s.min.y&&f.min.y<=s.max.y},t.translate=function(f,s){f.min.x+=s.x,f.max.x+=s.x,f.min.y+=s.y,f.max.y+=s.y},t.shift=function(f,s){var i=f.max.x-f.min.x,h=f.max.y-f.min.y;f.min.x=s.x,f.max.x=s.x+i,f.min.y=s.y,f.max.y=s.y+h}}()},{}],27:[function(x,M,B){var t={};M.exports=t,x("../geometry/Bounds");var f=x("../core/Common");(function(){t.pathToVertices=function(s,i){typeof window<"u"&&!("SVGPathSeg"in window)&&f.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var h,o,a,r,e,n,c,l,m,d,v=[],u,p,g=0,w=0,y=0;i=i||15;var S=function(P,k,I){var T=I%2===1&&I>1;if(!m||P!=m.x||k!=m.y){m&&T?(u=m.x,p=m.y):(u=0,p=0);var R={x:u+P,y:p+k};(T||!m)&&(m=R),v.push(R),w=u+P,y=p+k}},C=function(P){var k=P.pathSegTypeAsLetter.toUpperCase();if(k!=="Z"){switch(k){case"M":case"L":case"T":case"C":case"S":case"Q":w=P.x,y=P.y;break;case"H":w=P.x;break;case"V":y=P.y;break}S(w,y,P.pathSegType)}};for(t._svgPathToAbsolute(s),a=s.getTotalLength(),n=[],h=0;h<s.pathSegList.numberOfItems;h+=1)n.push(s.pathSegList.getItem(h));for(c=n.concat();g<a;){if(d=s.getPathSegAtLength(g),e=n[d],e!=l){for(;c.length&&c[0]!=e;)C(c.shift());l=e}switch(e.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":r=s.getPointAtLength(g),S(r.x,r.y,0);break}g+=i}for(h=0,o=c.length;h<o;++h)C(c[h]);return v},t._svgPathToAbsolute=function(s){for(var i,h,o,a,r,e,n=s.pathSegList,c=0,l=0,m=n.numberOfItems,d=0;d<m;++d){var v=n.getItem(d),u=v.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(u))"x"in v&&(c=v.x),"y"in v&&(l=v.y);else switch("x1"in v&&(o=c+v.x1),"x2"in v&&(r=c+v.x2),"y1"in v&&(a=l+v.y1),"y2"in v&&(e=l+v.y2),"x"in v&&(c+=v.x),"y"in v&&(l+=v.y),u){case"m":n.replaceItem(s.createSVGPathSegMovetoAbs(c,l),d);break;case"l":n.replaceItem(s.createSVGPathSegLinetoAbs(c,l),d);break;case"h":n.replaceItem(s.createSVGPathSegLinetoHorizontalAbs(c),d);break;case"v":n.replaceItem(s.createSVGPathSegLinetoVerticalAbs(l),d);break;case"c":n.replaceItem(s.createSVGPathSegCurvetoCubicAbs(c,l,o,a,r,e),d);break;case"s":n.replaceItem(s.createSVGPathSegCurvetoCubicSmoothAbs(c,l,r,e),d);break;case"q":n.replaceItem(s.createSVGPathSegCurvetoQuadraticAbs(c,l,o,a),d);break;case"t":n.replaceItem(s.createSVGPathSegCurvetoQuadraticSmoothAbs(c,l),d);break;case"a":n.replaceItem(s.createSVGPathSegArcAbs(c,l,v.r1,v.r2,v.angle,v.largeArcFlag,v.sweepFlag),d);break;case"z":case"Z":c=i,l=h;break}(u=="M"||u=="m")&&(i=c,h=l)}}})()},{"../core/Common":14,"../geometry/Bounds":26}],28:[function(x,M,B){var t={};M.exports=t,function(){t.create=function(f,s){return{x:f||0,y:s||0}},t.clone=function(f){return{x:f.x,y:f.y}},t.magnitude=function(f){return Math.sqrt(f.x*f.x+f.y*f.y)},t.magnitudeSquared=function(f){return f.x*f.x+f.y*f.y},t.rotate=function(f,s,i){var h=Math.cos(s),o=Math.sin(s);i||(i={});var a=f.x*h-f.y*o;return i.y=f.x*o+f.y*h,i.x=a,i},t.rotateAbout=function(f,s,i,h){var o=Math.cos(s),a=Math.sin(s);h||(h={});var r=i.x+((f.x-i.x)*o-(f.y-i.y)*a);return h.y=i.y+((f.x-i.x)*a+(f.y-i.y)*o),h.x=r,h},t.normalise=function(f){var s=t.magnitude(f);return s===0?{x:0,y:0}:{x:f.x/s,y:f.y/s}},t.dot=function(f,s){return f.x*s.x+f.y*s.y},t.cross=function(f,s){return f.x*s.y-f.y*s.x},t.cross3=function(f,s,i){return(s.x-f.x)*(i.y-f.y)-(s.y-f.y)*(i.x-f.x)},t.add=function(f,s,i){return i||(i={}),i.x=f.x+s.x,i.y=f.y+s.y,i},t.sub=function(f,s,i){return i||(i={}),i.x=f.x-s.x,i.y=f.y-s.y,i},t.mult=function(f,s){return{x:f.x*s,y:f.y*s}},t.div=function(f,s){return{x:f.x/s,y:f.y/s}},t.perp=function(f,s){return s=s===!0?-1:1,{x:s*-f.y,y:s*f.x}},t.neg=function(f){return{x:-f.x,y:-f.y}},t.angle=function(f,s){return Math.atan2(s.y-f.y,s.x-f.x)},t._temp=[t.create(),t.create(),t.create(),t.create(),t.create(),t.create()]}()},{}],29:[function(x,M,B){var t={};M.exports=t;var f=x("../geometry/Vector"),s=x("../core/Common");(function(){t.create=function(i,h){for(var o=[],a=0;a<i.length;a++){var r=i[a],e={x:r.x,y:r.y,index:a,body:h,isInternal:!1};o.push(e)}return o},t.fromPath=function(i,h){var o=/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/ig,a=[];return i.replace(o,function(r,e,n){a.push({x:parseFloat(e),y:parseFloat(n)})}),t.create(a,h)},t.centre=function(i){for(var h=t.area(i,!0),o={x:0,y:0},a,r,e,n=0;n<i.length;n++)e=(n+1)%i.length,a=f.cross(i[n],i[e]),r=f.mult(f.add(i[n],i[e]),a),o=f.add(o,r);return f.div(o,6*h)},t.mean=function(i){for(var h={x:0,y:0},o=0;o<i.length;o++)h.x+=i[o].x,h.y+=i[o].y;return f.div(h,i.length)},t.area=function(i,h){for(var o=0,a=i.length-1,r=0;r<i.length;r++)o+=(i[a].x-i[r].x)*(i[a].y+i[r].y),a=r;return h?o/2:Math.abs(o)/2},t.inertia=function(i,h){for(var o=0,a=0,r=i,e,n,c=0;c<r.length;c++)n=(c+1)%r.length,e=Math.abs(f.cross(r[n],r[c])),o+=e*(f.dot(r[n],r[n])+f.dot(r[n],r[c])+f.dot(r[c],r[c])),a+=e;return h/6*(o/a)},t.translate=function(i,h,o){var a;if(o)for(a=0;a<i.length;a++)i[a].x+=h.x*o,i[a].y+=h.y*o;else for(a=0;a<i.length;a++)i[a].x+=h.x,i[a].y+=h.y;return i},t.rotate=function(i,h,o){if(h!==0){for(var a=Math.cos(h),r=Math.sin(h),e=0;e<i.length;e++){var n=i[e],c=n.x-o.x,l=n.y-o.y;n.x=o.x+(c*a-l*r),n.y=o.y+(c*r+l*a)}return i}},t.contains=function(i,h){for(var o=0;o<i.length;o++){var a=i[o],r=i[(o+1)%i.length];if((h.x-a.x)*(r.y-a.y)+(h.y-a.y)*(a.x-r.x)>0)return!1}return!0},t.scale=function(i,h,o,a){if(h===1&&o===1)return i;a=a||t.centre(i);for(var r,e,n=0;n<i.length;n++)r=i[n],e=f.sub(r,a),i[n].x=a.x+e.x*h,i[n].y=a.y+e.y*o;return i},t.chamfer=function(i,h,o,a,r){typeof h=="number"?h=[h]:h=h||[8],o=typeof o<"u"?o:-1,a=a||2,r=r||14;for(var e=[],n=0;n<i.length;n++){var c=i[n-1>=0?n-1:i.length-1],l=i[n],m=i[(n+1)%i.length],d=h[n<h.length?n:h.length-1];if(d===0){e.push(l);continue}var v=f.normalise({x:l.y-c.y,y:c.x-l.x}),u=f.normalise({x:m.y-l.y,y:l.x-m.x}),p=Math.sqrt(2*Math.pow(d,2)),g=f.mult(s.clone(v),d),w=f.normalise(f.mult(f.add(v,u),.5)),y=f.sub(l,f.mult(w,p)),S=o;o===-1&&(S=Math.pow(d,.32)*1.75),S=s.clamp(S,a,r),S%2===1&&(S+=1);for(var C=Math.acos(f.dot(v,u)),P=C/S,k=0;k<S;k++)e.push(f.add(f.rotate(g,P*k),y))}return e},t.clockwiseSort=function(i){var h=t.mean(i);return i.sort(function(o,a){return f.angle(h,o)-f.angle(h,a)}),i},t.isConvex=function(i){var h=0,o=i.length,a,r,e,n;if(o<3)return null;for(a=0;a<o;a++)if(r=(a+1)%o,e=(a+2)%o,n=(i[r].x-i[a].x)*(i[e].y-i[r].y),n-=(i[r].y-i[a].y)*(i[e].x-i[r].x),n<0?h|=1:n>0&&(h|=2),h===3)return!1;return h!==0?!0:null},t.hull=function(i){var h=[],o=[],a,r;for(i=i.slice(0),i.sort(function(e,n){var c=e.x-n.x;return c!==0?c:e.y-n.y}),r=0;r<i.length;r+=1){for(a=i[r];o.length>=2&&f.cross3(o[o.length-2],o[o.length-1],a)<=0;)o.pop();o.push(a)}for(r=i.length-1;r>=0;r-=1){for(a=i[r];h.length>=2&&f.cross3(h[h.length-2],h[h.length-1],a)<=0;)h.pop();h.push(a)}return h.pop(),o.pop(),h.concat(o)}})()},{"../core/Common":14,"../geometry/Vector":28}],30:[function(x,M,B){var t=M.exports=x("../core/Matter");t.Body=x("../body/Body"),t.Composite=x("../body/Composite"),t.World=x("../body/World"),t.Contact=x("../collision/Contact"),t.Detector=x("../collision/Detector"),t.Grid=x("../collision/Grid"),t.Pairs=x("../collision/Pairs"),t.Pair=x("../collision/Pair"),t.Query=x("../collision/Query"),t.Resolver=x("../collision/Resolver"),t.SAT=x("../collision/SAT"),t.Constraint=x("../constraint/Constraint"),t.MouseConstraint=x("../constraint/MouseConstraint"),t.Common=x("../core/Common"),t.Engine=x("../core/Engine"),t.Events=x("../core/Events"),t.Mouse=x("../core/Mouse"),t.Runner=x("../core/Runner"),t.Sleeping=x("../core/Sleeping"),t.Plugin=x("../core/Plugin"),t.Bodies=x("../factory/Bodies"),t.Composites=x("../factory/Composites"),t.Axes=x("../geometry/Axes"),t.Bounds=x("../geometry/Bounds"),t.Svg=x("../geometry/Svg"),t.Vector=x("../geometry/Vector"),t.Vertices=x("../geometry/Vertices"),t.Render=x("../render/Render"),t.RenderPixi=x("../render/RenderPixi"),t.World.add=t.Composite.add,t.World.remove=t.Composite.remove,t.World.addComposite=t.Composite.addComposite,t.World.addBody=t.Composite.addBody,t.World.addConstraint=t.Composite.addConstraint,t.World.clear=t.Composite.clear,t.Engine.run=t.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(x,M,B){var t={};M.exports=t;var f=x("../core/Common"),s=x("../body/Composite"),i=x("../geometry/Bounds"),h=x("../core/Events"),o=x("../collision/Grid"),a=x("../geometry/Vector"),r=x("../core/Mouse");(function(){var e,n;typeof window<"u"&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(v){window.setTimeout(function(){v(f.now())},1e3/60)},n=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),t.create=function(v){var u={controller:t,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!v.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},p=f.extend(u,v);return p.canvas&&(p.canvas.width=p.options.width||p.canvas.width,p.canvas.height=p.options.height||p.canvas.height),p.mouse=v.mouse,p.engine=v.engine,p.canvas=p.canvas||c(p.options.width,p.options.height),p.context=p.canvas.getContext("2d"),p.textures={},p.bounds=p.bounds||{min:{x:0,y:0},max:{x:p.canvas.width,y:p.canvas.height}},p.options.pixelRatio!==1&&t.setPixelRatio(p,p.options.pixelRatio),f.isElement(p.element)?p.element.appendChild(p.canvas):p.canvas.parentNode||f.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),p},t.run=function(v){(function u(p){v.frameRequestId=e(u),t.world(v)})()},t.stop=function(v){n(v.frameRequestId)},t.setPixelRatio=function(v,u){var p=v.options,g=v.canvas;u==="auto"&&(u=l(g)),p.pixelRatio=u,g.setAttribute("data-pixel-ratio",u),g.width=p.width*u,g.height=p.height*u,g.style.width=p.width+"px",g.style.height=p.height+"px",v.context.scale(u,u)},t.lookAt=function(v,u,p,g){g=typeof g<"u"?g:!0,u=f.isArray(u)?u:[u],p=p||{x:0,y:0};for(var w={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},y=0;y<u.length;y+=1){var S=u[y],C=S.bounds?S.bounds.min:S.min||S.position||S,P=S.bounds?S.bounds.max:S.max||S.position||S;C&&P&&(C.x<w.min.x&&(w.min.x=C.x),P.x>w.max.x&&(w.max.x=P.x),C.y<w.min.y&&(w.min.y=C.y),P.y>w.max.y&&(w.max.y=P.y))}var k=w.max.x-w.min.x+2*p.x,I=w.max.y-w.min.y+2*p.y,T=v.canvas.height,R=v.canvas.width,E=R/T,L=k/I,b=1,V=1;L>E?V=L/E:b=E/L,v.options.hasBounds=!0,v.bounds.min.x=w.min.x,v.bounds.max.x=w.min.x+k*b,v.bounds.min.y=w.min.y,v.bounds.max.y=w.min.y+I*V,g&&(v.bounds.min.x+=k*.5-k*b*.5,v.bounds.max.x+=k*.5-k*b*.5,v.bounds.min.y+=I*.5-I*V*.5,v.bounds.max.y+=I*.5-I*V*.5),v.bounds.min.x-=p.x,v.bounds.max.x-=p.x,v.bounds.min.y-=p.y,v.bounds.max.y-=p.y,v.mouse&&(r.setScale(v.mouse,{x:(v.bounds.max.x-v.bounds.min.x)/v.canvas.width,y:(v.bounds.max.y-v.bounds.min.y)/v.canvas.height}),r.setOffset(v.mouse,v.bounds.min))},t.startViewTransform=function(v){var u=v.bounds.max.x-v.bounds.min.x,p=v.bounds.max.y-v.bounds.min.y,g=u/v.options.width,w=p/v.options.height;v.context.scale(1/g,1/w),v.context.translate(-v.bounds.min.x,-v.bounds.min.y)},t.endViewTransform=function(v){v.context.setTransform(v.options.pixelRatio,0,0,v.options.pixelRatio,0,0)},t.world=function(v){var u=v.engine,p=u.world,g=v.canvas,w=v.context,y=v.options,S=s.allBodies(p),C=s.allConstraints(p),P=y.wireframes?y.wireframeBackground:y.background,k=[],I=[],T,R={timestamp:u.timing.timestamp};if(h.trigger(v,"beforeRender",R),v.currentBackground!==P&&d(v,P),w.globalCompositeOperation="source-in",w.fillStyle="transparent",w.fillRect(0,0,g.width,g.height),w.globalCompositeOperation="source-over",y.hasBounds){for(T=0;T<S.length;T++){var E=S[T];i.overlaps(E.bounds,v.bounds)&&k.push(E)}for(T=0;T<C.length;T++){var L=C[T],b=L.bodyA,V=L.bodyB,O=L.pointA,W=L.pointB;b&&(O=a.add(b.position,L.pointA)),V&&(W=a.add(V.position,L.pointB)),!(!O||!W)&&(i.contains(v.bounds,O)||i.contains(v.bounds,W))&&I.push(L)}t.startViewTransform(v),v.mouse&&(r.setScale(v.mouse,{x:(v.bounds.max.x-v.bounds.min.x)/v.canvas.width,y:(v.bounds.max.y-v.bounds.min.y)/v.canvas.height}),r.setOffset(v.mouse,v.bounds.min))}else I=C,k=S;!y.wireframes||u.enableSleeping&&y.showSleeping?t.bodies(v,k,w):(y.showConvexHulls&&t.bodyConvexHulls(v,k,w),t.bodyWireframes(v,k,w)),y.showBounds&&t.bodyBounds(v,k,w),(y.showAxes||y.showAngleIndicator)&&t.bodyAxes(v,k,w),y.showPositions&&t.bodyPositions(v,k,w),y.showVelocity&&t.bodyVelocity(v,k,w),y.showIds&&t.bodyIds(v,k,w),y.showSeparations&&t.separations(v,u.pairs.list,w),y.showCollisions&&t.collisions(v,u.pairs.list,w),y.showVertexNumbers&&t.vertexNumbers(v,k,w),y.showMousePosition&&t.mousePosition(v,v.mouse,w),t.constraints(I,w),y.showBroadphase&&u.broadphase.controller===o&&t.grid(v,u.broadphase,w),y.showDebug&&t.debug(v,w),y.hasBounds&&t.endViewTransform(v),h.trigger(v,"afterRender",R)},t.debug=function(v,u){var p=u,g=v.engine,w=g.world,y=g.metrics,S=v.options;s.allBodies(w);var C="    ";if(g.timing.timestamp-(v.debugTimestamp||0)>=500){var P="";y.timing&&(P+="fps: "+Math.round(y.timing.fps)+C),v.debugString=P,v.debugTimestamp=g.timing.timestamp}if(v.debugString){p.font="12px Arial",S.wireframes?p.fillStyle="rgba(255,255,255,0.5)":p.fillStyle="rgba(0,0,0,0.5)";for(var k=v.debugString.split(`
`),I=0;I<k.length;I++)p.fillText(k[I],50,50+I*18)}},t.constraints=function(v,u){for(var p=u,g=0;g<v.length;g++){var w=v[g];if(!(!w.render.visible||!w.pointA||!w.pointB)){var y=w.bodyA,S=w.bodyB,C,P;if(y?C=a.add(y.position,w.pointA):C=w.pointA,w.render.type==="pin")p.beginPath(),p.arc(C.x,C.y,3,0,2*Math.PI),p.closePath();else{if(S?P=a.add(S.position,w.pointB):P=w.pointB,p.beginPath(),p.moveTo(C.x,C.y),w.render.type==="spring")for(var k=a.sub(P,C),I=a.perp(a.normalise(k)),T=Math.ceil(f.clamp(w.length/5,12,20)),R,E=1;E<T;E+=1)R=E%2===0?1:-1,p.lineTo(C.x+k.x*(E/T)+I.x*R*4,C.y+k.y*(E/T)+I.y*R*4);p.lineTo(P.x,P.y)}w.render.lineWidth&&(p.lineWidth=w.render.lineWidth,p.strokeStyle=w.render.strokeStyle,p.stroke()),w.render.anchors&&(p.fillStyle=w.render.strokeStyle,p.beginPath(),p.arc(C.x,C.y,3,0,2*Math.PI),p.arc(P.x,P.y,3,0,2*Math.PI),p.closePath(),p.fill())}}},t.bodyShadows=function(v,u,p){var g=p;v.engine;for(var w=0;w<u.length;w++){var y=u[w];if(y.render.visible){if(y.circleRadius)g.beginPath(),g.arc(y.position.x,y.position.y,y.circleRadius,0,2*Math.PI),g.closePath();else{g.beginPath(),g.moveTo(y.vertices[0].x,y.vertices[0].y);for(var S=1;S<y.vertices.length;S++)g.lineTo(y.vertices[S].x,y.vertices[S].y);g.closePath()}var C=y.position.x-v.options.width*.5,P=y.position.y-v.options.height*.2,k=Math.abs(C)+Math.abs(P);g.shadowColor="rgba(0,0,0,0.15)",g.shadowOffsetX=.05*C,g.shadowOffsetY=.05*P,g.shadowBlur=1+12*Math.min(1,k/1e3),g.fill(),g.shadowColor=null,g.shadowOffsetX=null,g.shadowOffsetY=null,g.shadowBlur=null}}},t.bodies=function(v,u,p){var g=p;v.engine;var w=v.options,y=w.showInternalEdges||!w.wireframes,S,C,P,k;for(P=0;P<u.length;P++)if(S=u[P],!!S.render.visible){for(k=S.parts.length>1?1:0;k<S.parts.length;k++)if(C=S.parts[k],!!C.render.visible){if(w.showSleeping&&S.isSleeping?g.globalAlpha=.5*C.render.opacity:C.render.opacity!==1&&(g.globalAlpha=C.render.opacity),C.render.sprite&&C.render.sprite.texture&&!w.wireframes){var I=C.render.sprite,T=m(v,I.texture);g.translate(C.position.x,C.position.y),g.rotate(C.angle),g.drawImage(T,T.width*-I.xOffset*I.xScale,T.height*-I.yOffset*I.yScale,T.width*I.xScale,T.height*I.yScale),g.rotate(-C.angle),g.translate(-C.position.x,-C.position.y)}else{if(C.circleRadius)g.beginPath(),g.arc(C.position.x,C.position.y,C.circleRadius,0,2*Math.PI);else{g.beginPath(),g.moveTo(C.vertices[0].x,C.vertices[0].y);for(var R=1;R<C.vertices.length;R++)!C.vertices[R-1].isInternal||y?g.lineTo(C.vertices[R].x,C.vertices[R].y):g.moveTo(C.vertices[R].x,C.vertices[R].y),C.vertices[R].isInternal&&!y&&g.moveTo(C.vertices[(R+1)%C.vertices.length].x,C.vertices[(R+1)%C.vertices.length].y);g.lineTo(C.vertices[0].x,C.vertices[0].y),g.closePath()}w.wireframes?(g.lineWidth=1,g.strokeStyle="#bbb",g.stroke()):(g.fillStyle=C.render.fillStyle,C.render.lineWidth&&(g.lineWidth=C.render.lineWidth,g.strokeStyle=C.render.strokeStyle,g.stroke()),g.fill())}g.globalAlpha=1}}},t.bodyWireframes=function(v,u,p){var g=p,w=v.options.showInternalEdges,y,S,C,P,k;for(g.beginPath(),C=0;C<u.length;C++)if(y=u[C],!!y.render.visible)for(k=y.parts.length>1?1:0;k<y.parts.length;k++){for(S=y.parts[k],g.moveTo(S.vertices[0].x,S.vertices[0].y),P=1;P<S.vertices.length;P++)!S.vertices[P-1].isInternal||w?g.lineTo(S.vertices[P].x,S.vertices[P].y):g.moveTo(S.vertices[P].x,S.vertices[P].y),S.vertices[P].isInternal&&!w&&g.moveTo(S.vertices[(P+1)%S.vertices.length].x,S.vertices[(P+1)%S.vertices.length].y);g.lineTo(S.vertices[0].x,S.vertices[0].y)}g.lineWidth=1,g.strokeStyle="#bbb",g.stroke()},t.bodyConvexHulls=function(v,u,p){var g=p,w,y,S;for(g.beginPath(),y=0;y<u.length;y++)if(w=u[y],!(!w.render.visible||w.parts.length===1)){for(g.moveTo(w.vertices[0].x,w.vertices[0].y),S=1;S<w.vertices.length;S++)g.lineTo(w.vertices[S].x,w.vertices[S].y);g.lineTo(w.vertices[0].x,w.vertices[0].y)}g.lineWidth=1,g.strokeStyle="rgba(255,255,255,0.2)",g.stroke()},t.vertexNumbers=function(v,u,p){var g=p,w,y,S;for(w=0;w<u.length;w++){var C=u[w].parts;for(S=C.length>1?1:0;S<C.length;S++){var P=C[S];for(y=0;y<P.vertices.length;y++)g.fillStyle="rgba(255,255,255,0.2)",g.fillText(w+"_"+y,P.position.x+(P.vertices[y].x-P.position.x)*.8,P.position.y+(P.vertices[y].y-P.position.y)*.8)}}},t.mousePosition=function(v,u,p){var g=p;g.fillStyle="rgba(255,255,255,0.8)",g.fillText(u.position.x+"  "+u.position.y,u.position.x+5,u.position.y-5)},t.bodyBounds=function(v,u,p){var g=p;v.engine;var w=v.options;g.beginPath();for(var y=0;y<u.length;y++){var S=u[y];if(S.render.visible)for(var C=u[y].parts,P=C.length>1?1:0;P<C.length;P++){var k=C[P];g.rect(k.bounds.min.x,k.bounds.min.y,k.bounds.max.x-k.bounds.min.x,k.bounds.max.y-k.bounds.min.y)}}w.wireframes?g.strokeStyle="rgba(255,255,255,0.08)":g.strokeStyle="rgba(0,0,0,0.1)",g.lineWidth=1,g.stroke()},t.bodyAxes=function(v,u,p){var g=p;v.engine;var w=v.options,y,S,C,P;for(g.beginPath(),S=0;S<u.length;S++){var k=u[S],I=k.parts;if(k.render.visible)if(w.showAxes)for(C=I.length>1?1:0;C<I.length;C++)for(y=I[C],P=0;P<y.axes.length;P++){var T=y.axes[P];g.moveTo(y.position.x,y.position.y),g.lineTo(y.position.x+T.x*20,y.position.y+T.y*20)}else for(C=I.length>1?1:0;C<I.length;C++)for(y=I[C],P=0;P<y.axes.length;P++)g.moveTo(y.position.x,y.position.y),g.lineTo((y.vertices[0].x+y.vertices[y.vertices.length-1].x)/2,(y.vertices[0].y+y.vertices[y.vertices.length-1].y)/2)}w.wireframes?(g.strokeStyle="indianred",g.lineWidth=1):(g.strokeStyle="rgba(255, 255, 255, 0.4)",g.globalCompositeOperation="overlay",g.lineWidth=2),g.stroke(),g.globalCompositeOperation="source-over"},t.bodyPositions=function(v,u,p){var g=p;v.engine;var w=v.options,y,S,C,P;for(g.beginPath(),C=0;C<u.length;C++)if(y=u[C],!!y.render.visible)for(P=0;P<y.parts.length;P++)S=y.parts[P],g.arc(S.position.x,S.position.y,3,0,2*Math.PI,!1),g.closePath();for(w.wireframes?g.fillStyle="indianred":g.fillStyle="rgba(0,0,0,0.5)",g.fill(),g.beginPath(),C=0;C<u.length;C++)y=u[C],y.render.visible&&(g.arc(y.positionPrev.x,y.positionPrev.y,2,0,2*Math.PI,!1),g.closePath());g.fillStyle="rgba(255,165,0,0.8)",g.fill()},t.bodyVelocity=function(v,u,p){var g=p;g.beginPath();for(var w=0;w<u.length;w++){var y=u[w];y.render.visible&&(g.moveTo(y.position.x,y.position.y),g.lineTo(y.position.x+(y.position.x-y.positionPrev.x)*2,y.position.y+(y.position.y-y.positionPrev.y)*2))}g.lineWidth=3,g.strokeStyle="cornflowerblue",g.stroke()},t.bodyIds=function(v,u,p){var g=p,w,y;for(w=0;w<u.length;w++)if(u[w].render.visible){var S=u[w].parts;for(y=S.length>1?1:0;y<S.length;y++){var C=S[y];g.font="12px Arial",g.fillStyle="rgba(255,255,255,0.5)",g.fillText(C.id,C.position.x+10,C.position.y-10)}}},t.collisions=function(v,u,p){var g=p,w=v.options,y,S,C,P;for(g.beginPath(),C=0;C<u.length;C++)if(y=u[C],!!y.isActive)for(S=y.collision,P=0;P<y.activeContacts.length;P++){var k=y.activeContacts[P],I=k.vertex;g.rect(I.x-1.5,I.y-1.5,3.5,3.5)}for(w.wireframes?g.fillStyle="rgba(255,255,255,0.7)":g.fillStyle="orange",g.fill(),g.beginPath(),C=0;C<u.length;C++)if(y=u[C],!!y.isActive&&(S=y.collision,y.activeContacts.length>0)){var T=y.activeContacts[0].vertex.x,R=y.activeContacts[0].vertex.y;y.activeContacts.length===2&&(T=(y.activeContacts[0].vertex.x+y.activeContacts[1].vertex.x)/2,R=(y.activeContacts[0].vertex.y+y.activeContacts[1].vertex.y)/2),S.bodyB===S.supports[0].body||S.bodyA.isStatic===!0?g.moveTo(T-S.normal.x*8,R-S.normal.y*8):g.moveTo(T+S.normal.x*8,R+S.normal.y*8),g.lineTo(T,R)}w.wireframes?g.strokeStyle="rgba(255,165,0,0.7)":g.strokeStyle="orange",g.lineWidth=1,g.stroke()},t.separations=function(v,u,p){var g=p,w=v.options,y,S,C,P,k;for(g.beginPath(),k=0;k<u.length;k++)if(y=u[k],!!y.isActive){S=y.collision,C=S.bodyA,P=S.bodyB;var I=1;!P.isStatic&&!C.isStatic&&(I=.5),P.isStatic&&(I=0),g.moveTo(P.position.x,P.position.y),g.lineTo(P.position.x-S.penetration.x*I,P.position.y-S.penetration.y*I),I=1,!P.isStatic&&!C.isStatic&&(I=.5),C.isStatic&&(I=0),g.moveTo(C.position.x,C.position.y),g.lineTo(C.position.x+S.penetration.x*I,C.position.y+S.penetration.y*I)}w.wireframes?g.strokeStyle="rgba(255,165,0,0.5)":g.strokeStyle="orange",g.stroke()},t.grid=function(v,u,p){var g=p,w=v.options;w.wireframes?g.strokeStyle="rgba(255,180,0,0.1)":g.strokeStyle="rgba(255,180,0,0.5)",g.beginPath();for(var y=f.keys(u.buckets),S=0;S<y.length;S++){var C=y[S];if(!(u.buckets[C].length<2)){var P=C.split(/C|R/);g.rect(.5+parseInt(P[1],10)*u.bucketWidth,.5+parseInt(P[2],10)*u.bucketHeight,u.bucketWidth,u.bucketHeight)}}g.lineWidth=1,g.stroke()},t.inspector=function(v,u){v.engine;var p=v.selected,g=v.render,w=g.options,y;if(w.hasBounds){var S=g.bounds.max.x-g.bounds.min.x,C=g.bounds.max.y-g.bounds.min.y,P=S/g.options.width,k=C/g.options.height;u.scale(1/P,1/k),u.translate(-g.bounds.min.x,-g.bounds.min.y)}for(var I=0;I<p.length;I++){var T=p[I].data;switch(u.translate(.5,.5),u.lineWidth=1,u.strokeStyle="rgba(255,165,0,0.9)",u.setLineDash([1,2]),T.type){case"body":y=T.bounds,u.beginPath(),u.rect(Math.floor(y.min.x-3),Math.floor(y.min.y-3),Math.floor(y.max.x-y.min.x+6),Math.floor(y.max.y-y.min.y+6)),u.closePath(),u.stroke();break;case"constraint":var R=T.pointA;T.bodyA&&(R=T.pointB),u.beginPath(),u.arc(R.x,R.y,10,0,2*Math.PI),u.closePath(),u.stroke();break}u.setLineDash([]),u.translate(-.5,-.5)}v.selectStart!==null&&(u.translate(.5,.5),u.lineWidth=1,u.strokeStyle="rgba(255,165,0,0.6)",u.fillStyle="rgba(255,165,0,0.1)",y=v.selectBounds,u.beginPath(),u.rect(Math.floor(y.min.x),Math.floor(y.min.y),Math.floor(y.max.x-y.min.x),Math.floor(y.max.y-y.min.y)),u.closePath(),u.stroke(),u.fill(),u.translate(-.5,-.5)),w.hasBounds&&u.setTransform(1,0,0,1,0,0)};var c=function(v,u){var p=document.createElement("canvas");return p.width=v,p.height=u,p.oncontextmenu=function(){return!1},p.onselectstart=function(){return!1},p},l=function(v){var u=v.getContext("2d"),p=window.devicePixelRatio||1,g=u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||u.oBackingStorePixelRatio||u.backingStorePixelRatio||1;return p/g},m=function(v,u){var p=v.textures[u];return p||(p=v.textures[u]=new Image,p.src=u,p)},d=function(v,u){var p=u;/(jpg|gif|png)$/.test(u)&&(p="url("+u+")"),v.canvas.style.background=p,v.canvas.style.backgroundSize="contain",v.currentBackground=u}})()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(x,M,B){var t={};M.exports=t;var f=x("../geometry/Bounds"),s=x("../body/Composite"),i=x("../core/Common"),h=x("../core/Events"),o=x("../geometry/Vector");(function(){var a,r;typeof window<"u"&&(a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(l){window.setTimeout(function(){l(i.now())},1e3/60)},r=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),t.create=function(l){i.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var m={controller:t,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},d=i.extend(m,l),v=!d.options.wireframes&&d.options.background==="transparent";return d.pixiOptions=d.pixiOptions||{view:d.canvas,transparent:v,antialias:!0,backgroundColor:l.background},d.mouse=l.mouse,d.engine=l.engine,d.renderer=d.renderer||new PIXI.WebGLRenderer(d.options.width,d.options.height,d.pixiOptions),d.container=d.container||new PIXI.Container,d.spriteContainer=d.spriteContainer||new PIXI.Container,d.canvas=d.canvas||d.renderer.view,d.bounds=d.bounds||{min:{x:0,y:0},max:{x:d.options.width,y:d.options.height}},h.on(d.engine,"beforeUpdate",function(){t.clear(d)}),d.textures={},d.sprites={},d.primitives={},d.container.addChild(d.spriteContainer),i.isElement(d.element)?d.element.appendChild(d.canvas):i.warn('No "render.element" passed, "render.canvas" was not inserted into document.'),d.canvas.oncontextmenu=function(){return!1},d.canvas.onselectstart=function(){return!1},d},t.run=function(l){(function m(d){l.frameRequestId=a(m),t.world(l)})()},t.stop=function(l){r(l.frameRequestId)},t.clear=function(l){for(var m=l.container,d=l.spriteContainer;m.children[0];)m.removeChild(m.children[0]);for(;d.children[0];)d.removeChild(d.children[0]);var v=l.sprites["bg-0"];l.textures={},l.sprites={},l.primitives={},l.sprites["bg-0"]=v,v&&m.addChildAt(v,0),l.container.addChild(l.spriteContainer),l.currentBackground=null,m.scale.set(1,1),m.position.set(0,0)},t.setBackground=function(l,m){if(l.currentBackground!==m){var d=m.indexOf&&m.indexOf("#")!==-1,v=l.sprites["bg-0"];if(d){var u=i.colorToNumber(m);l.renderer.backgroundColor=u,v&&l.container.removeChild(v)}else if(!v){var p=c(l,m);v=l.sprites["bg-0"]=new PIXI.Sprite(p),v.position.x=0,v.position.y=0,l.container.addChildAt(v,0)}l.currentBackground=m}},t.world=function(l){var m=l.engine,d=m.world,v=l.renderer,u=l.container,p=l.options,g=s.allBodies(d),w=s.allConstraints(d),y=[],S;p.wireframes?t.setBackground(l,p.wireframeBackground):t.setBackground(l,p.background);var C=l.bounds.max.x-l.bounds.min.x,P=l.bounds.max.y-l.bounds.min.y,k=C/l.options.width,I=P/l.options.height;if(p.hasBounds){for(S=0;S<g.length;S++){var T=g[S];T.render.sprite.visible=f.overlaps(T.bounds,l.bounds)}for(S=0;S<w.length;S++){var R=w[S],E=R.bodyA,L=R.bodyB,b=R.pointA,V=R.pointB;E&&(b=o.add(E.position,R.pointA)),L&&(V=o.add(L.position,R.pointB)),!(!b||!V)&&(f.contains(l.bounds,b)||f.contains(l.bounds,V))&&y.push(R)}u.scale.set(1/k,1/I),u.position.set(-l.bounds.min.x*(1/k),-l.bounds.min.y*(1/I))}else y=w;for(S=0;S<g.length;S++)t.body(l,g[S]);for(S=0;S<y.length;S++)t.constraint(l,y[S]);v.render(u)},t.constraint=function(l,m){l.engine;var d=m.bodyA,v=m.bodyB,u=m.pointA,p=m.pointB,g=l.container,w=m.render,y="c-"+m.id,S=l.primitives[y];if(S||(S=l.primitives[y]=new PIXI.Graphics),!w.visible||!m.pointA||!m.pointB){S.clear();return}i.indexOf(g.children,S)===-1&&g.addChild(S),S.clear(),S.beginFill(0,0),S.lineStyle(w.lineWidth,i.colorToNumber(w.strokeStyle),1),d?S.moveTo(d.position.x+u.x,d.position.y+u.y):S.moveTo(u.x,u.y),v?S.lineTo(v.position.x+p.x,v.position.y+p.y):S.lineTo(p.x,p.y),S.endFill()},t.body=function(l,m){l.engine;var d=m.render;if(d.visible)if(d.sprite&&d.sprite.texture){var v="b-"+m.id,u=l.sprites[v],p=l.spriteContainer;u||(u=l.sprites[v]=e(l,m)),i.indexOf(p.children,u)===-1&&p.addChild(u),u.position.x=m.position.x,u.position.y=m.position.y,u.rotation=m.angle,u.scale.x=d.sprite.xScale||1,u.scale.y=d.sprite.yScale||1}else{var g="b-"+m.id,w=l.primitives[g],y=l.container;w||(w=l.primitives[g]=n(l,m),w.initialAngle=m.angle),i.indexOf(y.children,w)===-1&&y.addChild(w),w.position.x=m.position.x,w.position.y=m.position.y,w.rotation=m.angle-w.initialAngle}};var e=function(l,m){var d=m.render,v=d.sprite.texture,u=c(l,v),p=new PIXI.Sprite(u);return p.anchor.x=m.render.sprite.xOffset,p.anchor.y=m.render.sprite.yOffset,p},n=function(l,m){var d=m.render,v=l.options,u=new PIXI.Graphics,p=i.colorToNumber(d.fillStyle),g=i.colorToNumber(d.strokeStyle),w=i.colorToNumber(d.strokeStyle),y=i.colorToNumber("#bbb"),S=i.colorToNumber("#CD5C5C"),C;u.clear();for(var P=m.parts.length>1?1:0;P<m.parts.length;P++){C=m.parts[P],v.wireframes?(u.beginFill(0,0),u.lineStyle(1,y,1)):(u.beginFill(p,1),u.lineStyle(d.lineWidth,g,1)),u.moveTo(C.vertices[0].x-m.position.x,C.vertices[0].y-m.position.y);for(var k=1;k<C.vertices.length;k++)u.lineTo(C.vertices[k].x-m.position.x,C.vertices[k].y-m.position.y);u.lineTo(C.vertices[0].x-m.position.x,C.vertices[0].y-m.position.y),u.endFill(),(v.showAngleIndicator||v.showAxes)&&(u.beginFill(0,0),v.wireframes?u.lineStyle(1,S,1):u.lineStyle(1,w),u.moveTo(C.position.x-m.position.x,C.position.y-m.position.y),u.lineTo((C.vertices[0].x+C.vertices[C.vertices.length-1].x)/2-m.position.x,(C.vertices[0].y+C.vertices[C.vertices.length-1].y)/2-m.position.y),u.endFill())}return u},c=function(l,m){var d=l.textures[m];return d||(d=l.textures[m]=PIXI.Texture.fromImage(m)),d}})()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)})})(J);var te=J.exports;const D=ee(te);class ie{constructor(A,x){this.keys=new Map,this.mouseConstraint=A,this.eventsOn=x,document.addEventListener("keydown",this.handleKeyDown.bind(this)),document.addEventListener("keyup",this.handleKeyUp.bind(this))}addKey(A,x){this.keys.set(A,{isPressed:!1,callback:x})}handleKeyDown(A){const x=this.keys.get(A.keyCode);x&&(x.isPressed=!0,x.callback&&x.callback(!0))}handleKeyUp(A){const x=this.keys.get(A.keyCode);x&&(x.isPressed=!1,x.callback&&x.callback(!1))}pressedKeys(){const A=new Set;for(let[x,M]of this.keys)M.isPressed&&A.add(x);return A}}class ne{constructor(A){this.context=A,this.layers=[]}addLayer(A,x){this.layers.push([A,x])}clear(){this.layers=[]}draw(){for(let[A,x]of this.layers)for(let M of x.tiles)x.sprite.draw(M.anim,this.context,M.pos)}drawLayer(A){for(let[x,M]of this.layers)if(!(A!==void 0&&A!==x))for(let B of M.tiles)M.sprite.draw(B.anim,this.context,B.pos)}constructLayer(A,x,M,B,t){let f={sprite:A,tiles:[]};for(let s=0;s<=x;s++)for(let i=0;i<=M;i++)f.tiles.push({pos:{x:s*B,y:i*B},...t});return f}}class K{constructor(A,x,M,B=x,t=M){this.tileW=x,this.tileH=M,this.width=B,this.height=t,this.animations=new Map,this.currentFrame=0,this.loaded=!1,this.image=new Image,this.image.onload=()=>{console.log("Sprite loaded:",A),this.loaded=!0},this.image.onerror=f=>{console.error("Failed to load sprite:",A,f)},this.image.src=A}define(A,x,M){const B=x*this.tileW,t=M*this.tileH;this.animations.set(A,{x:B,y:t})}drawStatic(A,x,M,B,t){this.loaded&&A.drawImage(this.image,B*this.tileW,t*this.tileH,this.tileW,this.tileH,x-this.width/2,M-this.height/2,this.width,this.height)}draw(A,x,M,B){if(!this.loaded)return;if(!B){this.drawStatic(A,x,M,this.currentFrame,0);return}const t=this.animations.get(B);if(!t){console.warn(`Animation ${B} not found`);return}const f=t.x+this.currentFrame*this.tileW;A.drawImage(this.image,f,t.y,this.tileW,this.tileH,x-this.width/2,M-this.height/2,this.width,this.height)}}const re={default:1,player:2,platform:4,enemy:8};class oe{constructor(A,x){this.game=A,this.config=x}async load(){this.game.entities.clear(),D.Composite.clear(this.game.engine.world),this.game.layers.clear(),this.game.player=null,this.config.type==="level"?await this._loadLevelScene():await this._loadNormalScene(),this.config.onEnter&&this.config.onEnter()}async _loadLevelScene(){let A;if(typeof this.config.levelData=="string"?A=await this.game.sceneManager.loadLevelData(this.config.levelData):typeof this.config.levelData=="object"&&(A=this.config.levelData),!A){console.error("Failed to load level data");return}if(A.gameType==="topDown"?this.game.engine.world.gravity.y=0:this.game.engine.world.gravity.y=1,A.background){const[x,M,B]=A.background,[t,f]=A.sprites[x],s=Math.ceil(this.game.width/f),i=Math.ceil(this.game.height/f),h=new K(t,f,f);h.define("default",M,B);const o=this.game.layers.constructLayer(h,s,i,f,{anim:"default"});this.game.layers.addLayer("background",o)}if(A.entities)for(const x of A.entities){const M=this.game.createActor(x);M&&(this.game.entities.add(M),D.Composite.add(this.game.engine.world,M.body))}if(A.player){const x=this.game.createActor(A.player);x&&(this.game.player=x,D.Composite.add(this.game.engine.world,x.body))}}async _loadNormalScene(){if(this.config.gameType==="topDown"?this.game.engine.world.gravity.y=0:this.game.engine.world.gravity.y=1,this.config.background){const[A,x,M]=this.config.background,[B,t]=this.config.sprites[A],f=Math.ceil(this.game.width/t),s=Math.ceil(this.game.height/t),i=new K(B,t,t);i.define("default",x,M);const h=this.game.layers.constructLayer(i,f,s,t,{anim:"default"});this.game.layers.addLayer("background",h)}if(this.config.entities)for(const A of this.config.entities){const x=this.game.createActor(A);x&&(this.game.entities.add(x),D.Composite.add(this.game.engine.world,x.body))}if(this.config.player){const A=this.game.createActor(this.config.player);A&&(this.game.player=A,D.Composite.add(this.game.engine.world,A.body))}}unload(){this.config.onExit&&this.config.onExit()}}class se{constructor(A){this.game=A,this.scenes=new Map,this.currentScene=null,this.levelNames=A.options.levelNames||[],this.levelsPath=A.options.levelsPath||"./levels/",this.currentLevelIndex=-1,this.levelNames.length>0&&(this.levelNames.forEach(x=>{this.registerScene({name:x,type:"level",levelData:x})}),A.options.currentLevel&&(this.currentLevelIndex=this.levelNames.indexOf(A.options.currentLevel)))}registerScene(A){const x=new oe(this.game,A);this.scenes.set(A.name,x)}async switchTo(A){this.currentScene&&this.currentScene.unload();const x=this.scenes.get(A);if(!x){console.error(`Scene ${A} not found`);return}if(await x.load(),this.currentScene=x,x.config.type==="level"){const M=typeof x.config.levelData=="string"?x.config.levelData:null;M&&(this.currentLevelIndex=this.levelNames.indexOf(M))}}getCurrentScene(){return this.currentScene}async loadLevelData(A){try{return await(await fetch(this.levelsPath+A)).json()}catch(x){return console.error("Error loading level:",x),null}}async nextLevel(){if(this.currentLevelIndex<this.levelNames.length-1){this.currentLevelIndex++;const A=this.levelNames[this.currentLevelIndex];return await this.switchTo(A),!0}return!1}async previousLevel(){if(this.currentLevelIndex>0){this.currentLevelIndex--;const A=this.levelNames[this.currentLevelIndex];return await this.switchTo(A),!0}return!1}setLevelData(A,x){this.registerScene({name:A,type:"level",levelData:x})}}const ae={levelNames:[],currentLevel:null,levelsPath:"./levels/",initialScene:null},le={frictionAir:.01,friction:.1,restitution:.1};class ce{constructor(A,x={}){this.options={...ae,...x},this.canvas=A,this.context=A.getContext("2d"),this.width=A.width,this.height=A.height,this.engine=D.Engine.create({positionIterations:4,velocityIterations:4,constraintIterations:2,enableSleeping:!0}),this.collisionCategories=re,this.Body=D.Body,this.Bodies=D.Bodies,D.Events.on(this.engine,"collisionStart",M=>{M.pairs.forEach(B=>{const{bodyA:t,bodyB:f}=B;t.entity&&t.entity.onCollisionStart(f),f.entity&&f.entity.onCollisionStart(t)})}),D.Events.on(this.engine,"collisionEnd",M=>{M.pairs.forEach(B=>{const{bodyA:t,bodyB:f}=B;t.entity&&t.entity.onCollisionEnd(f),f.entity&&f.entity.onCollisionEnd(t)})}),this.entities=new Set,this.player=null,this.actors=new Map,this.isGameOver=!1,this.keys=new ie,this.layers=new ne(this.context),this.sceneManager=new se(this),this.keys.addKey(82),this.update=this.update.bind(this),this.lastTime=0}registerActor(A,x){this.actors.set(A,x)}createActor(A){const{type:x,position:[M,B],size:[t,f],sprite:s,animations:i=[],options:h={}}=A,o=this.actors.get(x);if(!o)return console.error(`Actor type "${x}" not registered`),null;const a=this.sceneManager.getCurrentScene();if(!a)return console.error("No active scene"),null;const r=a.config.sprites[s],[e,n]=r,c=this.collisionCategories[x]||this.collisionCategories.default;let l;switch(x){case"platform":l=this.collisionCategories.player|this.collisionCategories.enemy;break;case"bee":l=this.collisionCategories.platform|this.collisionCategories.player;break;case"player":l=this.collisionCategories.platform|this.collisionCategories.enemy;break;default:l=-1}const m={...le,...h,collisionFilter:{category:c,mask:l}},d=this.Bodies.rectangle(M,B,t,f,m),v=new K(e,n,n,t,f),u=new o(this.context,d,v,this);for(const[p,g,w,y]of i)u.sprite.define(p,g,w),y&&(u.currentAnim=p);return d.entity=u,u}beforeUpdate(A){}afterUpdate(A){}gameOver(){this.isGameOver=!0}drawGameOver(){this.context.save(),this.context.fillStyle="rgba(0, 0, 0, 0.5)",this.context.fillRect(0,0,this.width,this.height),this.context.fillStyle="#fff",this.context.font="48px Arial",this.context.textAlign="center",this.context.textBaseline="middle",this.context.fillText("Game Over",this.width/2,this.height/2),this.context.font="24px Arial",this.context.fillText("Press R to restart",this.width/2,this.height/2+50),this.context.restore()}update(A){var M;if(!this.lastTime){this.lastTime=A,requestAnimationFrame(this.update);return}let x=(A-this.lastTime)/1e3;if(this.lastTime=A,x=Math.max(1/120,Math.min(x,1/30)),this.context.fillStyle="#000",this.context.fillRect(0,0,this.width,this.height),this.beforeUpdate(x),this.isGameOver){if(this.keys.pressedKeys().has(82)){this.isGameOver=!1,this.reset();return}}else{(M=this.player)!=null&&M.update&&this.player.update(x);for(let B of this.entities)B.update&&B.update(x);D.Engine.update(this.engine,x*1e3),this.layers.draw(x),this.player&&this.player.draw(x);for(let B of this.entities)B.draw(x)}this.isGameOver&&this.drawGameOver(),this.afterUpdate(x),requestAnimationFrame(this.update)}start(){this.options.initialScene?this.sceneManager.switchTo(this.options.initialScene).then(()=>{this.update()}):this.options.currentLevel?this.sceneManager.switchTo(this.options.currentLevel).then(()=>{this.update()}):this.update()}reset(){D.Composite.clear(this.engine.world),D.Engine.clear(this.engine),this.entities.clear(),this.layers.clear(),this.lastTime=0;const A=this.sceneManager.getCurrentScene();A?A.load():this.start()}}export{re as C,D as M,ce as a};
